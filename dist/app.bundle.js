/*! For license information please see app.bundle.js.LICENSE.txt */
(()=>{"use strict";var t={255:(t,e,r)=>{r.d(e,{A:()=>n});const n={BASE_URL:"https://story-api.dicoding.dev/v1",DEFAULT_LANGUAGE:"id-ID",CACHE_EXPIRATION:3e5,DEBUG_MODE:!0}},549:(t,e,r)=>{r.d(e,{O$:()=>w,o7:()=>E,f$:()=>m,MU:()=>M,cY:()=>x,XL:()=>O,gL:()=>d,Gc:()=>b,x3:()=>v,Q2:()=>g,zF:()=>S,Ts:()=>y,Ce:()=>p,Ds:()=>_,tx:()=>k});var n=r(255);function o(){o=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function l(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function f(e,r,n,o){var i=r&&r.prototype instanceof d?r:d,a=Object.create(i.prototype);return l(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=x(s,n);if(u){if(u===p)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===p)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new O(o||[])),!0),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var p={};function d(){}function v(){}function y(){}var m={};l(m,s,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(A([])));b&&b!==r&&n.call(b,s)&&(m=b);var w=y.prototype=d.prototype=Object.create(m);function k(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,a,s,u){var c=h(t[o],t,a);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==i(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,s,u)}),(function(t){r("throw",t,s,u)})):e.resolve(f).then((function(t){l.value=t,s(l)}),(function(t){return r("throw",t,s,u)}))}u(c.arg)}var o;l(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var i=h(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,p;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,p):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function _(t){this.tryEntries.push(t)}function S(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function O(t){this.tryEntries=[[-1]],t.forEach(_,this),this.reset(!0)}function A(e){if(null!=e){var r=e[s];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(i(e)+" is not iterable")}return v.prototype=y,l(w,"constructor",y),l(y,"constructor",v),v.displayName=l(y,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,l(t,c,"GeneratorFunction")),t.prototype=Object.create(w),t},e.awrap=function(t){return{__await:t}},k(E.prototype),l(E.prototype,u,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(f(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},k(w),l(w,c,"Generator"),l(w,s,(function(){return this})),l(w,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=A,O.prototype={constructor:O,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(S),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],p):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),S(r),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;S(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:A(e),r,n},"next"===this.method&&(this.arg=t),p}},e}function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function a(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function s(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function s(t){a(i,n,o,s,u,"next",t)}function u(t){a(i,n,o,s,u,"throw",t)}s(void 0)}))}}function u(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,s=[],u=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);u=!0);}catch(t){c=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return s}}(t,e)||function(t,e){if(t){if("string"==typeof t)return c(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function l(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function f(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?l(Object(r),!0).forEach((function(e){h(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function h(t,e,r){return(e=function(t){var e=function(t){if("object"!=i(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==i(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function p(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.A.DEFAULT_LANGUAGE,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Date(t).toLocaleDateString(e,f({year:"numeric",month:"long",day:"numeric"},r))}function d(){try{var t=JSON.parse(localStorage.getItem("userData")||"null");return t&&t.expiry&&t.expiry<Date.now()?(m(),null):t}catch(t){return x("Error parsing user data from localStorage:",t),null}}function v(){var t=d();return null!==t&&void 0!==t.token}function y(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{if(e){var r=new Date;r.setDate(r.getDate()+30);var n=f(f({},t),{},{expiry:r.getTime()});localStorage.setItem("userData",JSON.stringify(n))}else localStorage.setItem("userData",JSON.stringify(t))}catch(t){x("Error saving user data to localStorage:",t)}}function m(){try{localStorage.removeItem("userData"),window.location.hash="#/login"}catch(t){x("Error clearing user data from localStorage:",t)}}function g(){return new Promise((function(t,e){if(!window.L)return navigator.onLine?void fetch("https://unpkg.com/leaflet@1.9.4/dist/leaflet.css",{method:"HEAD",mode:"no-cors",cache:"no-cache"}).then((function(){var e=document.createElement("link");e.rel="stylesheet",e.href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css",document.head.appendChild(e);var r=document.createElement("script");r.src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js",r.onload=function(){x("Leaflet script loaded successfully"),t(window.L)},r.onerror=function(e){x("Failed to load Leaflet script:",e),t(null)},document.head.appendChild(r)})).catch((function(e){x("Failed to fetch Leaflet CSS:",e),t(null)})):(x("Offline mode: Map unavailable"),void t(null));t(window.L)}))}function b(t){return new Promise((function(e,r){navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({video:{width:{ideal:1280,max:1920},height:{ideal:720,max:1080},facingMode:"environment"}}).then((function(n){t.srcObject=n,t.onloadedmetadata=function(){t.play().then((function(){e(n)})).catch((function(t){x("Error playing video:",t),r(new Error("Gagal memulai kamera: "+t.message))}))},t.onerror=function(t){x("Video element error:",t),r(new Error("Terjadi kesalahan pada elemen video: "+t.message))}})).catch((function(t){x("getUserMedia error:",t);var e="Gagal mengakses kamera: ";switch(t.name){case"NotAllowedError":e+="Izin kamera ditolak. Harap berikan izin kamera di pengaturan browser Anda.";break;case"NotFoundError":e+="Tidak ada kamera yang ditemukan pada perangkat Anda.";break;case"NotReadableError":e+="Kamera sedang digunakan oleh aplikasi lain.";break;case"OverconstrainedError":e+="Kamera tidak mendukung kualitas yang diminta.";break;case"AbortError":e+="Akses kamera dibatalkan.";break;default:e+=t.message||"Error tidak diketahui."}r(new Error(e))})):r(new Error("Browser Anda tidak mendukung penggunaan kamera. Coba gunakan browser modern seperti Chrome, Firefox, atau Edge terbaru."))}))}function w(t,e){var r=e,n=r.getContext("2d");try{return r.width=t.videoWidth,r.height=t.videoHeight,n.drawImage(t,0,0,r.width,r.height),new Promise((function(t,e){r.toBlob((function(r){r?t(r):e(new Error("Gagal mengambil gambar. Silakan coba lagi."))}),"image/jpeg",.8)}))}catch(t){return x("Error capturing image:",t),Promise.reject(new Error("Gagal mengambil gambar: "+t.message))}}function k(t){if(t)try{t.getTracks().forEach((function(t){t.stop()})),x("Camera stopped successfully")}catch(t){x("Error stopping camera:",t)}}function E(){var t={camera:!(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia),geolocation:!!navigator.geolocation,localStorage:!!window.localStorage,viewTransition:!!document.startViewTransition},e=Object.entries(t).filter((function(t){var e=u(t,2);return e[0],!e[1]})).map((function(t){return u(t,1)[0]}));return{fullSupport:0===e.length,support:t,unsupported:e}}function x(){if(n.A.DEBUG_MODE){for(var t,e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];(t=console).log.apply(t,["[DEBUG]"].concat(r))}}function _(t,e){alert("".concat(t,": ").concat(e))}function S(t){return new Promise((function(e,r){if(t&&t.type.match("image.*")){var n=new FileReader;n.onload=function(n){var o=new Image;o.onload=function(){var n=document.createElement("canvas"),i=o.width,a=o.height,s=1600;(i>s||a>s)&&(i>a?(a=Math.round(a*(s/i)),i=s):(i=Math.round(i*(s/a)),a=s)),n.width=i,n.height=a,n.getContext("2d").drawImage(o,0,0,i,a),n.toBlob((function(n){n?(n.name=t.name||"photo.jpg",e(n)):r(new Error("Gagal memproses gambar"))}),"image/jpeg",.85)},o.onerror=function(){r(new Error("Gagal memuat gambar"))},o.src=n.target.result},n.onerror=function(){r(new Error("Gagal membaca file gambar"))},n.readAsDataURL(t)}else r(new Error("File harus berupa gambar (jpg, png, gif, dll)"))}))}function O(){try{var t=d();if(!t||!t.token)throw new Error("Token tidak tersedia");return{Authorization:"Bearer ".concat(t.token)}}catch(t){throw x("Error mendapatkan header otorisasi:",t),t}}function A(t){for(var e=(t+"=".repeat((4-t.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),r=window.atob(e),n=new Uint8Array(r.length),o=0;o<r.length;++o)n[o]=r.charCodeAt(o);return n}function j(){return P.apply(this,arguments)}function P(){return(P=s(o().mark((function t(){var e;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("Notification"in window){t.next=2;break}throw new Error("Browser tidak mendukung notifikasi");case 2:if("granted"!==Notification.permission){t.next=4;break}return t.abrupt("return",!0);case 4:if("denied"===Notification.permission){t.next=9;break}return t.next=7,Notification.requestPermission();case 7:return e=t.sent,t.abrupt("return","granted"===e);case 9:return t.abrupt("return",!1);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function T(t){return B.apply(this,arguments)}function B(){return(B=s(o().mark((function t(e){var r,n;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r={userVisibleOnly:!0,applicationServerKey:A("BCCs2eonMI-6H2ctvFaWg-UYdDv387Vno_bzUzALpB442r2lCnsHmtrx8biyPi_E-1fSGABK_Qs_GlvPoJJqxbk")},t.next=3,e.pushManager.subscribe(r);case 3:return n=t.sent,t.abrupt("return",n);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function I(){return L.apply(this,arguments)}function L(){return(L=s(o().mark((function t(){var e,r;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("serviceWorker"in navigator&&"PushManager"in window){t.next=2;break}return t.abrupt("return",!1);case 2:return t.prev=2,t.next=5,navigator.serviceWorker.ready;case 5:return e=t.sent,t.next=8,e.pushManager.getSubscription();case 8:return r=t.sent,t.abrupt("return",!!r);case 12:return t.prev=12,t.t0=t.catch(2),console.error("Error checking subscription status:",t.t0),t.abrupt("return",!1);case 16:case"end":return t.stop()}}),t,null,[[2,12]])})))).apply(this,arguments)}function M(){var t=document.getElementById("notification-toggle-btn");t&&t.remove();var e=document.createElement("button");e.id="notification-toggle-btn",e.className="notification-toggle-btn",e.setAttribute("aria-label","Toggle Push Notifications"),e.innerHTML='<i class="fas fa-bell"></i><span>Aktifkan Notifikasi</span>',N(e),e.addEventListener("click",F);var r=document.querySelector("header .main-header");return r&&r.appendChild(e),e}function N(t){return G.apply(this,arguments)}function G(){return(G=s(o().mark((function t(e){var r,n;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,I();case 3:if(r=t.sent,(n=d())&&n.token){t.next=8;break}return e.style.display="none",t.abrupt("return");case 8:e.style.display="flex",r?(e.innerHTML='<i class="fas fa-bell-slash"></i><span>Matikan Notifikasi</span>',e.className="notification-toggle-btn subscribed",e.title="Klik untuk mematikan notifikasi"):(e.innerHTML='<i class="fas fa-bell"></i><span>Aktifkan Notifikasi</span>',e.className="notification-toggle-btn unsubscribed",e.title="Klik untuk mengaktifkan notifikasi"),t.next=18;break;case 12:t.prev=12,t.t0=t.catch(0),console.error("Error updating button state:",t.t0),e.innerHTML='<i class="fas fa-bell"></i><span>Aktifkan Notifikasi</span>',e.className="notification-toggle-btn unsubscribed",e.style.display="flex";case 18:case"end":return t.stop()}}),t,null,[[0,12]])})))).apply(this,arguments)}function F(t){return C.apply(this,arguments)}function C(){return(C=s(o().mark((function t(e){var r,n,i;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.preventDefault(),r=e.target.closest("button"),navigator.onLine){t.next=5;break}return _("Offline","Notifikasi memerlukan koneksi internet"),t.abrupt("return");case 5:return t.prev=5,r.disabled=!0,r.innerHTML='<i class="fas fa-spinner fa-spin"></i><span>Loading...</span>',t.next=10,I();case 10:if(n=t.sent,(i=d())&&i.token){t.next=15;break}return _("Error","Harap login terlebih dahulu"),t.abrupt("return");case 15:if(!n){t.next=21;break}return t.next=18,H();case 18:_("Berhasil","Notifikasi berhasil dimatikan"),t.next=24;break;case 21:return t.next=23,Y();case 23:_("Berhasil","Notifikasi berhasil diaktifkan");case 24:return t.next=26,N(r);case 26:t.next=34;break;case 28:return t.prev=28,t.t0=t.catch(5),console.error("Error toggling notification:",t.t0),_("Error",t.t0.message||"Terjadi kesalahan"),t.next=34,N(r);case 34:return t.prev=34,r.disabled=!1,t.finish(34);case 37:case"end":return t.stop()}}),t,null,[[5,28,34,37]])})))).apply(this,arguments)}function Y(){return D.apply(this,arguments)}function D(){return(D=s(o().mark((function t(){var e,n,i,a,s,u;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,j();case 2:if(t.sent){t.next=5;break}throw new Error("Izin notifikasi ditolak. Harap aktifkan di pengaturan browser.");case 5:return t.next=7,navigator.serviceWorker.ready;case 7:return e=t.sent,t.next=10,T(e);case 10:return n=t.sent,i={endpoint:n.endpoint,keys:{p256dh:btoa(String.fromCharCode.apply(null,new Uint8Array(n.getKey("p256dh")))),auth:btoa(String.fromCharCode.apply(null,new Uint8Array(n.getKey("auth"))))}},t.next=14,Promise.resolve().then(r.bind(r,778));case 14:return a=t.sent,s=a.subscribeNotification,t.next=18,s(i);case 18:if(!(u=t.sent).error){t.next=21;break}throw new Error(u.message||"Gagal berlangganan notifikasi");case 21:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function H(){return R.apply(this,arguments)}function R(){return(R=s(o().mark((function t(){var e,n,i,a,s;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,navigator.serviceWorker.ready;case 2:return e=t.sent,t.next=5,e.pushManager.getSubscription();case 5:if(!(n=t.sent)){t.next=18;break}return t.next=9,Promise.resolve().then(r.bind(r,778));case 9:return i=t.sent,a=i.unsubscribeNotification,t.next=13,a(n.endpoint);case 13:if(!(s=t.sent).error){t.next=16;break}throw new Error(s.message||"Gagal berhenti berlangganan notifikasi");case 16:return t.next=18,n.unsubscribe();case 18:case"end":return t.stop()}}),t)})))).apply(this,arguments)}},778:(t,e,r)=>{r.r(e),r.d(e,{addStory:()=>y,getAllStories:()=>d,getStoryDetail:()=>v,login:()=>h,register:()=>p,subscribeNotification:()=>m,unsubscribeNotification:()=>g});var n=r(255),o=r(549);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function a(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=s(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function s(t,e){if(t){if("string"==typeof t)return u(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(t,e):void 0}}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function c(){c=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function f(e,r,n,o){var i=r&&r.prototype instanceof d?r:d,a=Object.create(i.prototype);return l(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=x(s,n);if(u){if(u===p)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===p)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new O(o||[])),!0),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var p={};function d(){}function v(){}function y(){}var m={};l(m,a,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(A([])));b&&b!==r&&n.call(b,a)&&(m=b);var w=y.prototype=d.prototype=Object.create(m);function k(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,a,s,u){var c=h(t[o],t,a);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==i(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,s,u)}),(function(t){r("throw",t,s,u)})):e.resolve(f).then((function(t){l.value=t,s(l)}),(function(t){return r("throw",t,s,u)}))}u(c.arg)}var o;l(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var i=h(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,p;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,p):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function _(t){this.tryEntries.push(t)}function S(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function O(t){this.tryEntries=[[-1]],t.forEach(_,this),this.reset(!0)}function A(e){if(null!=e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,s=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return s.next=s}}throw new TypeError(i(e)+" is not iterable")}return v.prototype=y,l(w,"constructor",y),l(y,"constructor",v),v.displayName=l(y,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,l(t,u,"GeneratorFunction")),t.prototype=Object.create(w),t},e.awrap=function(t){return{__await:t}},k(E.prototype),l(E.prototype,s,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(f(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},k(w),l(w,u,"Generator"),l(w,a,(function(){return this})),l(w,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=A,O.prototype={constructor:O,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(S),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],p):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),S(r),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;S(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:A(e),r,n},"next"===this.method&&(this.arg=t),p}},e}function l(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function f(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){l(i,n,o,a,s,"next",t)}function s(t){l(i,n,o,a,s,"throw",t)}a(void 0)}))}}var h=function(){var t=f(c().mark((function t(e){var r,o;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(n.A.BASE_URL,"/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});case 3:return r=t.sent,t.next=6,r.json();case 6:return o=t.sent,t.abrupt("return",o);case 10:return t.prev=10,t.t0=t.catch(0),console.error("Error pada login:",t.t0),t.abrupt("return",{error:!0,message:"Tidak dapat terhubung ke server. Periksa koneksi internet Anda."});case 14:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}(),p=function(){var t=f(c().mark((function t(e){var r,o;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(n.A.BASE_URL,"/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});case 3:return r=t.sent,t.next=6,r.json();case 6:return o=t.sent,t.abrupt("return",o);case 10:return t.prev=10,t.t0=t.catch(0),console.error("Error pada register:",t.t0),t.abrupt("return",{error:!0,message:"Tidak dapat terhubung ke server. Periksa koneksi internet Anda."});case 14:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}(),d=function(){var t=f(c().mark((function t(){var e,r,i,s,u,l,f,h,p,d,v,y,m,g,b,w,k,E,x=arguments;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=(e=x.length>0&&void 0!==x[0]?x[0]:{}).page,i=void 0===r?1:r,s=e.size,u=void 0===s?10:s,l=e.location,f=void 0===l?0:l,t.prev=1,h="".concat(n.A.BASE_URL,"/stories?page=").concat(i,"&size=").concat(u),f&&(h+="&location=1"),p=(0,o.XL)(),t.next=7,fetch(h,{headers:p});case 7:return d=t.sent,t.next=10,d.json();case 10:if(!(v=t.sent).error){t.next=13;break}throw new Error(v.message);case 13:return t.abrupt("return",v);case 16:if(t.prev=16,t.t0=t.catch(1),console.error("Error mendapatkan cerita:",t.t0),!(t.t0 instanceof TypeError&&t.t0.message.includes("Failed to fetch"))){t.next=60;break}if(console.log("Offline mode: Loading cached stories"),!("caches"in window)){t.next=59;break}return t.prev=22,t.next=25,caches.open("stories-cache");case 25:return y=t.sent,t.next=28,y.keys();case 28:m=t.sent,g=a(m),t.prev=30,g.s();case 32:if((b=g.n()).done){t.next=46;break}if(!(w=b.value).url.includes("/stories")){t.next=44;break}return t.next=37,y.match(w);case 37:if(!(k=t.sent)){t.next=44;break}return t.next=41,k.json();case 41:return E=t.sent,console.log("Loaded stories from cache"),t.abrupt("return",E);case 44:t.next=32;break;case 46:t.next=51;break;case 48:t.prev=48,t.t1=t.catch(30),g.e(t.t1);case 51:return t.prev=51,g.f(),t.finish(51);case 54:t.next=59;break;case 56:t.prev=56,t.t2=t.catch(22),console.log("Cache error:",t.t2);case 59:return t.abrupt("return",{error:!1,message:"success",listStory:[{id:"offline-1",name:"Story Offline",description:"Ini adalah story yang tersedia secara offline. Anda dapat melihat story yang telah di-cache saat offline.",photoUrl:"/favicon-192.png",createdAt:(new Date).toISOString(),lat:-6.2088,lon:106.8456},{id:"offline-2",name:"Story Demo",description:"Story demo untuk mode offline. Semua fitur aplikasi tetap berfungsi.",photoUrl:"/favicon-512.png",createdAt:(new Date).toISOString(),lat:-6.1751,lon:106.865},{id:"offline-3",name:"Offline Content",description:"Konten offline tersedia untuk memastikan aplikasi tetap berfungsi tanpa koneksi internet.",photoUrl:"/favicon.png",createdAt:(new Date).toISOString(),lat:-6.2615,lon:106.781}]});case 60:return t.abrupt("return",{error:!0,message:t.t0.message||"Terjadi kesalahan saat memuat cerita. Periksa koneksi internet Anda."});case 61:case"end":return t.stop()}}),t,null,[[1,16],[22,56],[30,48,51,54]])})));return function(){return t.apply(this,arguments)}}(),v=function(){var t=f(c().mark((function t(e){var r,i,a,s,u,l,f;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=(0,o.XL)(),t.next=4,fetch("".concat(n.A.BASE_URL,"/stories/").concat(e),{headers:r});case 4:return i=t.sent,t.next=7,i.json();case 7:return a=t.sent,t.abrupt("return",a);case 11:if(t.prev=11,t.t0=t.catch(0),console.error("Error mendapatkan detail cerita:",t.t0),!(t.t0 instanceof TypeError&&t.t0.message.includes("Failed to fetch"))){t.next=37;break}if(console.log("Offline mode: Loading cached story detail"),!("caches"in window)){t.next=35;break}return t.prev=17,t.next=20,caches.open("story-details-cache");case 20:return s=t.sent,t.next=23,s.match("".concat(n.A.BASE_URL,"/stories/").concat(e));case 23:if(!(u=t.sent)){t.next=30;break}return t.next=27,u.json();case 27:return l=t.sent,console.log("Loaded story detail from cache"),t.abrupt("return",l);case 30:t.next=35;break;case 32:t.prev=32,t.t1=t.catch(17),console.log("Cache error:",t.t1);case 35:return f={"offline-1":{id:"offline-1",name:"Story Offline",description:"Detail story ini tersedia secara offline. Semua fitur aplikasi tetap berfungsi dalam mode offline. Anda dapat tetap menjelajahi aplikasi dan melihat konten yang telah di-cache sebelumnya.",photoUrl:"/favicon-192.png",createdAt:(new Date).toISOString(),lat:-6.2088,lon:106.8456},"offline-2":{id:"offline-2",name:"Story Demo",description:"Story demo yang menunjukkan bagaimana aplikasi tetap berfungsi saat offline. Progressive Web App memungkinkan pengalaman yang seamless bahkan tanpa koneksi internet.",photoUrl:"/favicon-512.png",createdAt:(new Date).toISOString(),lat:-6.1751,lon:106.865},"offline-3":{id:"offline-3",name:"Offline Content",description:"Konten offline yang tersedia untuk memastikan aplikasi tetap berfungsi. Service Worker dan caching memungkinkan akses ke konten bahkan saat tidak ada koneksi internet.",photoUrl:"/favicon.png",createdAt:(new Date).toISOString(),lat:-6.2615,lon:106.781}},t.abrupt("return",{error:!1,message:"success",story:f[e]||f["offline-1"]});case 37:return t.abrupt("return",{error:!0,message:"Terjadi kesalahan saat memuat detail cerita."});case 38:case"end":return t.stop()}}),t,null,[[0,11],[17,32]])})));return function(e){return t.apply(this,arguments)}}(),y=function(){var t=f(c().mark((function t(e){var r,i,u,l,f,h,p,d,v,y,m;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,(r=(0,o.gL)())&&r.token){t.next=4;break}throw new Error("Token tidak tersedia. Silakan login terlebih dahulu.");case 4:if(console.log("Mengirim cerita dengan data:"),console.log("- Description tersedia:",e.has("description")),console.log("- Photo tersedia:",e.has("photo")),console.log("- Lokasi tersedia:",e.has("lat")&&e.has("lon")),i={Authorization:"Bearer ".concat(r.token)},e.has("description")){t.next=11;break}throw new Error("Deskripsi cerita tidak boleh kosong");case 11:if(e.has("photo")){t.next=13;break}throw new Error("Foto tidak boleh kosong");case 13:return t.next=15,fetch("".concat(n.A.BASE_URL,"/stories"),{method:"POST",headers:i,body:e});case 15:if((u=t.sent).ok){t.next=31;break}if(401!==u.status){t.next=21;break}throw new Error("Sesi telah berakhir. Silakan login kembali.");case 21:if(413!==u.status){t.next=25;break}throw new Error("Ukuran foto terlalu besar. Maksimal 1MB.");case 25:if(400!==u.status){t.next=29;break}throw new Error("Data yang dikirim tidak valid. Pastikan format data sudah benar.");case 29:if(500!==u.status){t.next=31;break}throw new Error("Terjadi kesalahan pada server. Silakan coba lagi nanti.");case 31:return t.next=33,u.json();case 33:if(l=t.sent,console.log("Response dari API addStory:",l),!l.error){t.next=38;break}throw console.error("Error saat menambahkan cerita:",l.message),new Error(l.message||"Gagal menambahkan cerita.");case 38:return t.abrupt("return",l);case 41:if(t.prev=41,t.t0=t.catch(0),console.log("Offline mode: Storing story for later sync"),!window.offlineManager){t.next=52;break}f={},h=a(e.entries());try{for(h.s();!(p=h.n()).done;)c=p.value,g=2,d=function(t){if(Array.isArray(t))return t}(c)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,s=[],u=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);u=!0);}catch(t){c=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return s}}(c,g)||s(c,g)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),v=d[0],y=d[1],f[v]=y}catch(t){h.e(t)}finally{h.f()}return(m=(0,o.gL)())&&m.token&&(f.token=m.token),t.next=52,window.offlineManager.handleOfflineForm(f);case 52:return t.abrupt("return",{error:!1,message:"Story disimpan offline dan akan dikirim saat online kembali",offline:!0});case 53:case"end":return t.stop()}var c,g}),t,null,[[0,41]])})));return function(e){return t.apply(this,arguments)}}(),m=function(){var t=f(c().mark((function t(e){var r,i,a;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,(r=(0,o.gL)())&&r.token){t.next=4;break}throw new Error("Token tidak tersedia. Silakan login terlebih dahulu.");case 4:return t.next=6,fetch("".concat(n.A.BASE_URL,"/notifications/subscribe"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r.token)},body:JSON.stringify(e)});case 6:return i=t.sent,t.next=9,i.json();case 9:if(a=t.sent,i.ok&&!a.error){t.next=12;break}throw new Error(a.message||"Gagal berlangganan notifikasi");case 12:return t.abrupt("return",a);case 15:return t.prev=15,t.t0=t.catch(0),console.error("Error subscribe notification:",t.t0),t.abrupt("return",{error:!0,message:t.t0.message||"Gagal berlangganan notifikasi"});case 19:case"end":return t.stop()}}),t,null,[[0,15]])})));return function(e){return t.apply(this,arguments)}}(),g=function(){var t=f(c().mark((function t(e){var r,i,a;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,(r=(0,o.gL)())&&r.token){t.next=4;break}throw new Error("Token tidak tersedia. Silakan login terlebih dahulu.");case 4:return t.next=6,fetch("".concat(n.A.BASE_URL,"/notifications/subscribe"),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r.token)},body:JSON.stringify({endpoint:e})});case 6:return i=t.sent,t.next=9,i.json();case 9:if(a=t.sent,i.ok&&!a.error){t.next=12;break}throw new Error(a.message||"Gagal berhenti berlangganan notifikasi");case 12:return t.abrupt("return",a);case 15:return t.prev=15,t.t0=t.catch(0),console.error("Error unsubscribe notification:",t.t0),t.abrupt("return",{error:!0,message:t.t0.message||"Gagal berhenti berlangganan notifikasi"});case 19:case"end":return t.stop()}}),t,null,[[0,15]])})));return function(e){return t.apply(this,arguments)}}()}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={exports:{}};return t[n](i,i.exports,r),i.exports}r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n=r(778),o=r(549);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function a(){a=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",u=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function l(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function f(e,r,n,o){var i=r&&r.prototype instanceof d?r:d,a=Object.create(i.prototype);return l(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=x(s,n);if(u){if(u===p)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===p)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new O(o||[])),!0),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var p={};function d(){}function v(){}function y(){}var m={};l(m,s,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(A([])));b&&b!==r&&n.call(b,s)&&(m=b);var w=y.prototype=d.prototype=Object.create(m);function k(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,a,s,u){var c=h(t[o],t,a);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==i(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,s,u)}),(function(t){r("throw",t,s,u)})):e.resolve(f).then((function(t){l.value=t,s(l)}),(function(t){return r("throw",t,s,u)}))}u(c.arg)}var o;l(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var i=h(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,p;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,p):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function _(t){this.tryEntries.push(t)}function S(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function O(t){this.tryEntries=[[-1]],t.forEach(_,this),this.reset(!0)}function A(e){if(null!=e){var r=e[s];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(i(e)+" is not iterable")}return v.prototype=y,l(w,"constructor",y),l(y,"constructor",v),v.displayName=l(y,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,l(t,c,"GeneratorFunction")),t.prototype=Object.create(w),t},e.awrap=function(t){return{__await:t}},k(E.prototype),l(E.prototype,u,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(f(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},k(w),l(w,c,"Generator"),l(w,s,(function(){return this})),l(w,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=A,O.prototype={constructor:O,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(S),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],p):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),S(r),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;S(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:A(e),r,n},"next"===this.method&&(this.arg=t),p}},e}function s(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function u(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?s(Object(r),!0).forEach((function(e){c(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function c(t,e,r){return(e=p(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function l(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function f(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){l(i,n,o,a,s,"next",t)}function s(t){l(i,n,o,a,s,"throw",t)}a(void 0)}))}}function h(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,p(n.key),n)}}function p(t){var e=function(t){if("object"!=i(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==i(e)?e:e+""}const d=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"getAllStories",value:(s=f(a().mark((function t(e){var r,i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=u(u({},e),{},{location:1}),(0,o.cY)("Getting stories with params:",r),t.prev=2,t.next=5,(0,n.getAllStories)(r);case 5:return i=t.sent,t.abrupt("return",i);case 9:return t.prev=9,t.t0=t.catch(2),console.error("Error fetching stories:",t.t0),t.abrupt("return",{error:!1,message:"success",listStory:[{id:"offline-1",name:"Story Offline",description:"Story offline tersedia",photoUrl:"/favicon-192.png",createdAt:(new Date).toISOString(),lat:-6.2088,lon:106.8456}]});case 13:case"end":return t.stop()}}),t,null,[[2,9]])}))),function(t){return s.apply(this,arguments)})},{key:"getStoryDetail",value:(i=f(a().mark((function t(e){var r;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(0,o.cY)("Fetching story detail for ID:",e),t.prev=1,t.next=4,(0,n.getStoryDetail)(e);case 4:return r=t.sent,t.abrupt("return",r);case 8:return t.prev=8,t.t0=t.catch(1),console.error("Error fetching story detail:",t.t0),t.abrupt("return",{error:!1,message:"success",story:{id:e,name:"Story Offline",description:"Detail story offline tersedia",photoUrl:"/favicon-192.png",createdAt:(new Date).toISOString(),lat:-6.2088,lon:106.8456}});case 12:case"end":return t.stop()}}),t,null,[[1,8]])}))),function(t){return i.apply(this,arguments)})},{key:"addStory",value:(r=f(a().mark((function t(e){var r;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(0,o.cY)("Adding new story"),t.prev=1,t.next=4,(0,n.addStory)(e);case 4:return r=t.sent,t.abrupt("return",r);case 8:return t.prev=8,t.t0=t.catch(1),console.error("Error adding story:",t.t0),t.abrupt("return",{error:!1,message:"Story disimpan offline dan akan dikirim saat online kembali",offline:!0});case 12:case"end":return t.stop()}}),t,null,[[1,8]])}))),function(t){return r.apply(this,arguments)})}],e&&h(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,i,s}();function v(t){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v(t)}function y(){y=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=x(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new O(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var m={};u(m,i,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(A([])));b&&b!==r&&n.call(b,i)&&(m=b);var w=d.prototype=h.prototype=Object.create(m);function k(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==v(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function _(t){this.tryEntries.push(t)}function S(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function O(t){this.tryEntries=[[-1]],t.forEach(_,this),this.reset(!0)}function A(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(v(e)+" is not iterable")}return p.prototype=d,u(w,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(w),t},e.awrap=function(t){return{__await:t}},k(E.prototype),u(E.prototype,a,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},k(w),u(w,s,"Generator"),u(w,i,(function(){return this})),u(w,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=A,O.prototype={constructor:O,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(S),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),S(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;S(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:A(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function m(t){return function(t){if(Array.isArray(t))return g(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return g(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?g(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function b(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function w(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){b(i,n,o,a,s,"next",t)}function s(t){b(i,n,o,a,s,"throw",t)}a(void 0)}))}}function k(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,E(n.key),n)}}function E(t){var e=function(t){if("object"!=v(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=v(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==v(e)?e:e+""}const x=function(){return t=function t(e){var r=e.view,n=e.model;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._view=r,this._model=n,this._page=1,this._storiesPerPage=5,this._isLoading=!1,this._hasMoreData=!0,this._stories=[]},e=[{key:"loadStories",value:(n=w(y().mark((function t(){var e,r,n,i,a;return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._isLoading){t.next=2;break}return t.abrupt("return");case 2:return this._isLoading=!0,this._view.showLoading(1===this._page),(0,o.cY)("Loading stories page ".concat(this._page,", size ").concat(this._storiesPerPage)),t.prev=5,t.next=8,this._model.getAllStories({page:this._page,size:this._storiesPerPage,location:1});case 8:if((e=t.sent).listStory&&Array.isArray(e.listStory)){t.next=11;break}throw new Error("Format data cerita tidak valid");case 11:r=e.listStory.filter((function(t){return t.lat&&t.lon&&!isNaN(parseFloat(t.lat))&&!isNaN(parseFloat(t.lon))})),(0,o.cY)("Received ".concat(e.listStory.length," stories, ").concat(r.length," have valid coordinates")),r.length>0&&(0,o.cY)("Sample location data:",{name:r[0].name,lat:r[0].lat,lon:r[0].lon}),n=e.listStory,i=new Set(this._stories.map((function(t){return t.id}))),a=this._page>1?n.filter((function(t){return!i.has(t.id)})):n,1===this._page?((0,o.cY)("Setting initial stories list"),this._stories=a):((0,o.cY)("Adding ".concat(a.length," new stories to existing ").concat(this._stories.length)),this._stories=[].concat(m(this._stories),m(a))),this._hasMoreData=n.length===this._storiesPerPage,(0,o.cY)("Has more data: ".concat(this._hasMoreData)),this._stories.length>0?(this._view.renderStories(this._page>1,a),this._view.toggleLoadMoreButton(this._hasMoreData),this._view.isMapError()||((0,o.cY)("Updating map markers with ".concat(this._stories.length," stories")),this._view.updateMapMarkers(this._stories))):this._view.showEmptyStoriesMessage(),t.next=27;break;case 23:t.prev=23,t.t0=t.catch(5),(0,o.cY)("Error loading stories:",t.t0),this._view.showErrorMessage(t.t0.message);case 27:return t.prev=27,this._isLoading=!1,this._view.hideLoadingIndicator(),t.finish(27);case 31:case"end":return t.stop()}}),t,this,[[5,23,27,31]])}))),function(){return n.apply(this,arguments)})},{key:"loadMoreStories",value:function(){!this._isLoading&&this._hasMoreData&&((0,o.cY)("Loading more stories"),this._page++,this.loadStories())}},{key:"setupInfiniteScroll",value:function(){var t=this;(0,o.cY)("Setting up infinite scroll"),this._view.setupInfiniteScroll((function(){return t.loadMoreStories()}))}},{key:"initMap",value:(r=w(y().mark((function t(){var e=this;return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,(0,o.cY)("Initializing map from presenter"),t.next=4,this._view.initMap();case 4:this._stories&&this._stories.length>0&&((0,o.cY)("Updating markers after map init. Total stories: ".concat(this._stories.length)),setTimeout((function(){e._view.updateMapMarkers(e._stories)}),300)),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),(0,o.cY)("Map initialization error:",t.t0),this._view.handleMapError(t.t0);case 11:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(){return r.apply(this,arguments)})}],e&&k(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function _(t){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_(t)}function S(t){return function(t){if(Array.isArray(t))return O(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return O(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?O(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function A(){A=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=k(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(O([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==_(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function O(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(_(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=O,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:O(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function j(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function P(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){j(i,n,o,a,s,"next",t)}function s(t){j(i,n,o,a,s,"throw",t)}a(void 0)}))}}function T(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,B(n.key),n)}}function B(t){var e=function(t){if("object"!=_(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=_(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==_(e)?e:e+""}var I=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._storyModel=new d,this._presenter=new x({view:this,model:this._storyModel}),this._map=null,this._markers=[],this._mapError=!1,this._scrollHandler=null},e=[{key:"render",value:(i=P(A().mark((function t(){return A().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n    <section id="content" class="container" tabindex="-1">\n      <h1 class="page-title"><i class="fas fa-book-reader"></i> Cerita Terbaru</h1>\n      \n      <div class="map-container" id="stories-map"></div>\n      \n      <div id="stories-container" class="stories-container">\n        <div class="loading">\n          <div class="loading-spinner"></div>\n        </div>\n      </div>\n      \n      <div id="load-more-container" style="text-align: center; margin-top: 20px; display: none;">\n        <button id="load-more-button" class="btn btn-primary">\n          <i class="fas fa-sync"></i> Muat Lebih Banyak\n        </button>\n      </div>\n    </section>\n  ');case 1:case"end":return t.stop()}}),t)}))),function(){return i.apply(this,arguments)})},{key:"afterRender",value:(n=P(A().mark((function t(){var e,r,n,i=this;return A().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=document.getElementById("stories-container"),r=document.getElementById("stories-map"),document.getElementById("load-more-container"),n=document.getElementById("load-more-button"),t.prev=4,(0,o.x3)()){t.next=9;break}return e&&(e.innerHTML='\n            <div class="alert alert-error">\n              <p>Anda perlu <a href="#/login">login</a> untuk melihat cerita.</p>\n              <p>Belum punya akun? <a href="#/register">Daftar sekarang</a>.</p>\n            </div>\n          '),r&&(r.style.display="none"),t.abrupt("return");case 9:return n&&n.addEventListener("click",(function(){i._presenter.loadMoreStories()})),this._presenter.setupInfiniteScroll(),t.prev=11,(0,o.cY)("Initializing map before loading stories"),t.next=15,this.initMap();case 15:t.next=21;break;case 17:t.prev=17,t.t0=t.catch(11),(0,o.cY)("Map initialization error:",t.t0),this.handleMapError(t.t0);case 21:return t.next=23,this._presenter.loadStories();case 23:t.next=29;break;case 25:t.prev=25,t.t1=t.catch(4),(0,o.cY)("Error in home page:",t.t1),this.showErrorMessage(t.t1.message);case 29:case"end":return t.stop()}}),t,this,[[4,25],[11,17]])}))),function(){return n.apply(this,arguments)})},{key:"showLoading",value:function(t){var e=document.getElementById("stories-container"),r=document.getElementById("load-more-container");if(t&&e)e.innerHTML='\n        <div class="loading">\n          <div class="loading-spinner"></div>\n        </div>\n      ';else if(r){var n=document.createElement("div");n.className="loading",n.innerHTML='<div class="loading-spinner"></div>',n.id="load-more-spinner",r.appendChild(n)}}},{key:"hideLoadingIndicator",value:function(){var t=document.getElementById("load-more-spinner");t&&t.parentNode&&t.parentNode.removeChild(t)}},{key:"renderStories",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=document.getElementById("stories-container");if(n){r.length>0&&(this._stories=e?[].concat(S(this._stories),S(r)):r);try{var i=r,a=new Set,s=[];i.forEach((function(t){t&&t.id&&!a.has(t.id)&&(a.add(t.id),s.push(t))}));var u=s.map((function(e){return e&&e.name&&e.photoUrl?'\n        <article class="story-card" data-id="'.concat(e.id,'">\n          <div class="story-image-container">\n            <img \n            src="').concat(e.photoUrl,'" \n            alt="Cerita dari ').concat(e.name,'" \n            class="story-image"\n            onerror="this.onerror=null; this.src=\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAD6CAYAAAAbbXrzAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAADhBJREFUeNrs3V9u20YWwGGoaU+R7d7guS9gFYj7CHkDyFIXSHuDBK4vkPgGbW6QODdI4voDbeUuEHWBokBgdxcoshsULtolxk2mZWpKIiUNyRnO9wGC7cSSbXKo+XHOP8bGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANiWzfQ46fzZWvvMh91/tHt3/2f6mP7oP8pXCRQNVhVIVcc2TI836WP6PE46/99x+l8nyVcKbFukDsfTx/up1AvGKJ1E2lkQrEDUxnQSpD/uV1BLh+lkmqW/8pgfIFhBaVR10r8vGnUCJU+Pp+lkmqU/L8UJBCvQcOVBl4aqb2npMk1jT0QKBCtEaTQNVV9/pV36VDODYIWsDtVJA0sXRdJBEIIVuqJ89GkANwGgWSFYwbWqomk0oFBd1bSqnhUkWEEYSqiuqqpZRQJMsELx2pZVgbgWvlCwQgpVOGUhJFiBhCqUQcuhSbCCMJxLSx6VK4QrtMrLgUmwQiOFVRUXwoWCNeTLSyHLWwmCNYQplrJFkCBYgy2s2ArWCRCsoy6s2AusDM0SrEMurChwbR/B2vPYwh7xYKRLXyZYh1pYcXtF9rMlWANytLfz8SWu7SNYe1JYBG3XZbX0ZYJ1SIUVGdqmG9cmWNtmaMZQuRRFsPaEsWMsYfNz5jqFYO2jsCqWMIzCK1x9mWDtubCYnEMRFpexBGvPhbVUWAyjuPJq14K1VWrGiGtUIVj7Lazc0IyxBFYtBGufhUVZxVJYlYK1x8Jy1xvWgrt9Eax9FlZUTLHFNSzBOkACGNesqMQJ1j4LK1JWxMIZ1pYLKyqm2MKKYQnWIRRWVEyxhRXDEqwDJYSCigRr34UVFVNsZUUMRbD2XFhRMcUWVnxIsPZcWEWZUIirYBGsfRZWVEyxhfXegiVY+y6sqJhiCyu2QbAOoLCMHceKbRCsAzVjLDBiyLZhA8Laknw95n4bxldxWcbH/d4bCWGtprDaW2ikOUu0jR0fJ19tPf0sptfbjz8tQ9tQTbCG0YyxpNh+f0gDmjv9LB+/v/C5O8nnTYK1hxlWcQVkZ4HK32Oefv3+2B5fOolmAQ9KsHbQjFFGsZnfzaXfpY9fP/31t9Px9LcfPvzTaWoKrdsqWFsprMpY5rdx/K+pZ33/13+cpHY5NQuoYG2rsIzNGJr59Xf65aeXv/2QJbP/dB+rYG2psIwdMnv744//1JlPnU4Z6qThzgjWdpoxlBVbb2Nzty/6c/ooVJ8K1r4KKyqqKB+nv/vSn6dA5cUXJYZg7bkZY4sxq3LPnTzOnj1/+zY7fu/9+QqGYO25sAphdVr/vf80P+OL/M9ffPnV0fHJV30+bC5YWy+s6mbRKPpcQPr75fPnvy9HNz4OlR/vHhcZg9LfXz57drm8Yf1VG7Tn6XH/2vd68vrRu18+f/66Bf+uLFiFwRnWLaQN/Xp6lN2OoeXuFzEpuGq/TZPPn7+etCRQM0+v7FY7TQO1/ymuR90MK2PG1V5r/Pbbdp0V3fljh3t8/D7EvtcjWAcvKtlXbLvmDyxYglUxn1F/m2INUG4RKNcj+5Fh/VN+vBsrOArW3qXfS2d8JFj7LqtuPSo8zVeI1sAYlGAJFoI1OLlgIS2CVVQCEaxDLqtuPSo8zVeI1sAYlGAJl2INUG4RKNcj+5Fh/VN+vBsrOArW3qXfS2d8JFj7LqtuPSo8zVeI1sAYlGAJFoI1OLlgIS2CVVQCEaxDLqtuPSo8zVeI1sAlBYIlWjKuFJDqPI/HN/y9GSpan7zdjb71WP8Z5j/3P3SStP9bdH3+NRVl/fpylXPPnz/N+9hjvXl1s4L9j38w4fXZYvv9bTDO9v79/4ecSLMH6Qbpw93OfNnfOe8dP19+XLx6JjWD9QPZ+/vSb7H28X/fPGIgTrCE1X9XVk1eVXF97vrT+U7AEK3CvZ8f7vXty9nyRHZ8/1r9dTFoI1oGIQdHf+9m7p2+f3hQXwYvJC1mWYB1Mc9VvY/qzp2/evi0ej68vcbVkX1bB2vv88rvnJHnvUc9hy7JutWbTb7x+V1nCdcjBKndd8l6cX2S56K90LVg/iDAMvj+LFn2W9a7+vS/XL0Ue7L0QrAOdb95b07maTHRZgiVYgwzW68ePpSvBGuTYMa5U9DsSFl2WYAlWYMx6TLAMXsMKVuGGJdOCJVoUxqg6LMGqm2N1ntvZj/WLbEGwBOvQG6z7G9GCJViDuIY1VL+OvvTXNSxcwxrwaFVu4tTjXAQLwaqbZem+EEbB+lEsQ8Gq22aZ9dh4JFi4hNVV//5ZvbosORYs0aqnVdjnzQQEq2HGXjdCLiksK6pCaAWrkRsXl6ZNyK0Q0WrbIrwW0pXPJViHbNXrtYP/OtGxbREeekDvvXNuixAswtb1R2+z0WORYcGCDPu97iq0WoJ1yOF6ONXl8MeBjY+CJW0H3miZZQnWvsyjCDc+3YmV4dIgWA0VQ9kxnHJl8VGwGi0G6aYbzaoFC7JkUB4EyxgWgvVXxrUQrOY2bwHLCuGSJVhQEqnwKlBZwWo88cK29kKwDJOGWVUqKcFqg/jkh4y9LMFqSwiGPLQc7tBBsJo+JKTbNmEsWK3SbMl2SVWw2i6CiqdcU26C1TYtXXGP32zBOih9L/3pdwkXwTqkPKsXt+zyFywonbPQ8uFQsA7dTcbqdFaCRdXlXStGVgSrLTfYwk6bLMMSrLbdnNzPgmC1SXmcRbYFq4XCYhQVwTr4aFEu12ZagtXmaOF+FgQL09wFq+XLv1h1mfQQLLqilRe/zKsQLMoiVnNBWpAJFmVX5YsRKcGiQrRkSrAQKMHiR42WjzUUrAGS+wXrUBus4g3u5V2wDJMQLLYcrfLdESpiFtFhPtbQb3XuOx3aqMq8CsE65Gb20HvZQGEo/bNgQSFeZlgEq1WxMqtCsJouhmZZFCxDRgjWHlk9qx9DwBYsy7AIViPDFcJdj1pNXUOwDr2Y2tTAOfoQLEp6WZUHIMyjQLA6BdQSWZRgIViCBYIlViBYgiVYgCGcYIEgCZZoCZZgQeOYuBcsNlJwzStvIFiCQCBYggUgWNAZEjMtBAvBEiwQLMHCDAvBAjRYIFiwHSoogiVY/ZU3pVOwcA1LsIggCJZgQXDtlGCBYLmERbAEi+E2WIKFa1jtCJZRlmi5S4NgESeXsAQLBBnBEiy2JYAXVWFPrGDBjsSl+a/S/TgRLHzQnWCBYE2LrDkWLHaQrrIbf8uyYInWvjtZJV0u9QmWaLVLlT6WbIHgfT7yLFpH2WsWGY6yUEf5bwsJ2mZq95F3hHw6yv/KIjwZFa89SqN1nMX4ZPQvAubaDbuwV4uKj9mkx2TUI+STkTADALAnbm/g/Vwua88Ea1+OP+lx3OOl10fZ4+S7FxKsBnxy0jPIk+PsMs9pz0t3k+6f/WX24DT7uZO9vvzhXg0WoIFLYZNeEZ30upQ16REd0RKs1oeqzxLWJA/s6Xf8OykDJFitn4pxKaz/a55015l/SqB9GYJnDZbwHuWh7tHfmubN1VEesm8veU8F67CSNRat1XBdXroa/fdLZb/WEa+JcB1OwL69RNWxxmoy/e/LX10+OwXrQC9rXf5Zt9/rd5nrslH79qXLZqdgHWi0TqYlq/3y3NnFdVnnptcTrMNN12lus9fV/p6L91me6WTHm77/sFPBOliX9/2JL5fBzrN0na8Gp5tEX/w6jdMU9NnwHgfugOZinO+rSX667+jHvp3wPT3ZcPR/KlgHvY7rZDrd/3Q6nR7tI1b58+Tpy0fOk+F8UoUJ7+m+J7j3mf6QXYo7n+blgqfTSE273fd0h5+1YB3cJbDp9K/7e1/1Xe/Vw0RYFmVYgyBYggUgWKCnRbAABIsWzwUELHEVLNEaKpO8BMuEMQRLsASL7nUswcLMf0QL17AQLMECBEuwQJewBEuwAMESTFzDQrBwoiZagmUvYRAsAQTXsATLPsIgWIIIRgjBMlAEBEsBmTpwhQnBEsb/EXDAJSzBwnVtdQMEy9VtQJYFC1xwQbAEDBAswQIQrFaHa0ix/nZhv2DBOky9crmOtb7PF/YLFglXKK+LWPn9gkXCFcoVhcqLvOwZxHi+vx2OBQs23uO4zTEfC5bJD8gwggWCJVggWIIFCBYIlmABggWCZUdnwRIsECzBAsECwTKGJViCBYIlWCBYggWCBYIlWCBYIFiCBYIFgiVYIFggWIIFCBYIliBqUWrBEiyAHiYmjbPHD9nj+fTXj81VAmLWRxGwj2TdLO2ZTR+v089f94pifn7mz1fTX9+lP7/JXz+CRcj6KK0pXJfZ47309x9l4TIQ7O9e+vMb089Bve9Lgcu8i4sPp9OfX08DdZr/+Wz6+9kUsDPX/MBYCwB2KO/zrmbTn0/TMF4J11H26wvxAg6k0Zpm65V4AQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwLb8T4ABAFyGt6FLqJ4OAAAAAElFTkSuQmCC\';"\n            loading="lazy"\n          >\n        </div>\n        <div class="story-content">\n          <h2 class="story-title">').concat(e.name,'</h2>\n          <p class="story-meta"><i class="far fa-calendar-alt"></i> ').concat((0,o.Ce)(e.createdAt),'</p>\n          <p class="story-description">').concat(e.description?e.description.length>100?e.description.substring(0,100)+"...":e.description:"Tidak ada deskripsi","</p>\n          ").concat(e.lat&&e.lon?'\n            <div class="story-location">\n              <i class="fas fa-map-marker-alt"></i>\n              '.concat(t._mapError?"Lokasi: ".concat(parseFloat(e.lat).toFixed(6),", ").concat(parseFloat(e.lon).toFixed(6)):"Lokasi tersedia","\n            </div>\n        "):"",' \n          <div class="story-more">\n            <a href="#/story/').concat(e.id,'" class="btn btn-primary">\n              <i class="fas fa-book-open"></i> Lihat Detail\n            </a>\n          </div>\n        </div>\n      </article>\n    '):(console.log("Story data is incomplete:",e),"")})).join("");if(e){var c=document.createElement("div");c.innerHTML=u,Array.from(c.children).forEach((function(t){t.style.opacity="0",t.style.transform="translateY(20px)",n.appendChild(t),setTimeout((function(){t.style.transition="opacity 0.5s, transform 0.5s",t.style.opacity="1",t.style.transform="translateY(0)"}),10)}))}else n.innerHTML=u}catch(t){console.error("Error rendering stories:",t),this.showErrorMessage(t.message)}}else console.warn("Stories container tidak ditemukan")}},{key:"toggleLoadMoreButton",value:function(t){var e=document.getElementById("load-more-container");e&&(e.style.display=t?"block":"none")}},{key:"showEmptyStoriesMessage",value:function(){var t=document.getElementById("stories-container"),e=document.getElementById("load-more-container");t&&(t.innerHTML='\n        <div class="alert alert-info">\n          <p>Belum ada cerita yang tersedia.</p>\n          <p>Jadilah yang pertama <a href="#/add">berbagi cerita</a>!</p>\n        </div>\n      '),e&&(e.style.display="none")}},{key:"showErrorMessage",value:function(t){var e=document.getElementById("stories-container"),r=document.getElementById("stories-map");e&&(e.innerHTML='\n        <div class="alert alert-error">\n          <p>Terjadi kesalahan saat memuat cerita.</p>\n          <p>'.concat(t||"Kesalahan tidak diketahui",'</p>\n          <button onclick="window.location.reload()" class="btn btn-small">Coba Lagi</button>\n        </div>\n      ')),r&&(r.style.display="none")}},{key:"setupInfiniteScroll",value:function(t){var e=this,r=!1;this._scrollHandler=function(){if(!r){r=!0,setTimeout((function(){r=!1}),300);var n=document.getElementById("load-more-button"),o=document.getElementById("stories-container");n&&o?(window.scrollY||window.pageYOffset)+window.innerHeight>=document.documentElement.scrollHeight-300&&t():window.removeEventListener("scroll",e._scrollHandler)}},window.addEventListener("scroll",this._scrollHandler)}},{key:"initMap",value:(r=P(A().mark((function t(){var e,r,n=this;return A().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e=document.getElementById("stories-map")){t.next=5;break}return(0,o.cY)("Map container tidak ditemukan"),t.abrupt("return");case 5:if((0,o.cY)("Initializing map in View..."),0===e.clientHeight&&(e.style.height="400px"),!this._map){t.next=11;break}return(0,o.cY)("Map already exists, invalidating size"),this._map.invalidateSize(),t.abrupt("return");case 11:return t.next=13,(0,o.Q2)();case 13:return r=t.sent,window.L=r,(0,o.cY)("Leaflet script loaded successfully"),t.next=18,new Promise((function(t){return setTimeout(t,300)}));case 18:return(0,o.cY)("Creating map instance"),this._map=r.map(e,{center:[-2.5489,118.0149],zoom:5,zoomControl:!0}),r.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(this._map),window.addEventListener("resize",(function(){n._map&&n._map.invalidateSize()})),document.addEventListener("visibilitychange",(function(){"visible"===document.visibilityState&&n._map&&setTimeout((function(){return n._map.invalidateSize()}),200)})),(0,o.cY)("Map initialization complete"),this._stories&&this._stories.length>0&&((0,o.cY)("Updating markers on map init with ".concat(this._stories.length," existing stories")),setTimeout((function(){n.updateMapMarkers(n._stories)}),500)),t.abrupt("return",this._map);case 28:throw t.prev=28,t.t0=t.catch(0),(0,o.cY)("Error initializing map:",t.t0),this._mapError=!0,t.t0;case 33:case"end":return t.stop()}}),t,this,[[0,28]])}))),function(){return r.apply(this,arguments)})},{key:"updateMapMarkers",value:function(t){var e=this;if((0,o.cY)("updateMapMarkers called with ".concat(t?t.length:0," stories")),this._map&&!this._mapError)if(this._markers&&this._markers.length>0&&((0,o.cY)("Removing ".concat(this._markers.length," existing markers")),this._markers.forEach((function(t){t&&t.remove&&t.remove()})),this._markers=[]),window.L)try{var r=window.L.icon({iconUrl:"https://cdn-icons-png.flaticon.com/512/684/684908.png",iconSize:[32,32],iconAnchor:[16,32],popupAnchor:[0,-32]}),n=0,i=0,a=t.filter((function(t){return t&&t.lat&&t.lon&&!isNaN(parseFloat(t.lat))&&!isNaN(parseFloat(t.lon))}));if((0,o.cY)("Found ".concat(a.length," stories with valid location data")),a.forEach((function(t){var a=parseFloat(t.lat),s=parseFloat(t.lon);i++;try{var u=window.L.marker([a,s],{icon:r});u.bindPopup('\n            <div class="map-popup">\n              <h3>'.concat(t.name,"</h3>\n              <p>").concat(t.description?t.description.substring(0,100)+"...":"Tidak ada deskripsi",'</p>\n              <a href="#/story/').concat(t.id,'" class="btn btn-small">Lihat Detail</a>\n            </div>\n          ')),u.addTo(e._map),e._markers.push(u),n++}catch(e){(0,o.cY)("Error adding marker for story ".concat(t.id,":"),e)}})),(0,o.cY)("Added ".concat(n," markers to map from ").concat(i," valid stories")),this._markers.length>0)try{var s=window.L.featureGroup(this._markers);this._map.fitBounds(s.getBounds(),{padding:[30,30]}),(0,o.cY)("Successfully fit bounds to markers")}catch(t){(0,o.cY)("Error fitting bounds:",t)}else(0,o.cY)("No markers to fit bounds")}catch(t){(0,o.cY)("Error in updateMapMarkers:",t)}else(0,o.cY)("Leaflet not available, skipping marker update");else(0,o.cY)("Map not available or has error, skipping marker update")}},{key:"handleMapError",value:function(t){this._mapError=!0;var e=document.getElementById("stories-map");e&&(e.innerHTML='\n        <div class="alert alert-error">\n          <p>Gagal memuat peta. Mohon periksa koneksi internet Anda.</p>\n          <p>Error: '.concat(t.message||"Tidak diketahui","</p>\n        </div>\n      ")),(0,o.cY)("Map error handled:",t)}},{key:"isMapError",value:function(){return this._mapError}},{key:"cleanup",value:function(){if((0,o.cY)("Cleaning up HomePage resources"),this._scrollHandler&&(window.removeEventListener("scroll",this._scrollHandler),this._scrollHandler=null),this._map){try{this._map.remove(),(0,o.cY)("Map removed successfully")}catch(t){(0,o.cY)("Error removing map:",t)}this._map=null}this._markers=[],console.log("HomePage resources cleaned up")}}],e&&T(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,i}();function L(t){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},L(t)}function M(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,G(n.key),n)}}function N(t,e,r){return e&&M(t.prototype,e),r&&M(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function G(t){var e=function(t){if("object"!=L(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=L(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==L(e)?e:e+""}const F=N((function t(e){var r=e.view;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._view=r}));function C(t){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},C(t)}function Y(){Y=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=k(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==C(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(C(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function D(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function H(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){D(i,n,o,a,s,"next",t)}function s(t){D(i,n,o,a,s,"throw",t)}a(void 0)}))}}function R(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,W(n.key),n)}}function W(t){var e=function(t){if("object"!=C(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=C(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==C(e)?e:e+""}var V=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._presenter=new F({view:this})},e=[{key:"render",value:(n=H(Y().mark((function t(){return Y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section id="content" class="container" tabindex="-1">\n        <h1 class="page-title">Tentang Dicoding Story</h1>\n        \n        <div class="about-content">\n          <p>\n            Dicoding Story adalah platform berbagi cerita dan pengalaman seputar Dicoding. \n            Aplikasi ini dibangun sebagai proyek untuk memenuhi submission kelas Dicoding.\n          </p>\n          \n          <h2>Fitur Aplikasi</h2>\n          <ul>\n            <li>Melihat cerita dari pengguna Dicoding lainnya</li>\n            <li>Berbagi cerita Anda sendiri dengan komunitas Dicoding</li>\n            <li>Menambahkan lokasi pada cerita Anda</li>\n            <li>Melihat lokasi cerita di peta</li>\n            <li>Menyimpan cerita favorit ke bookmark</li>\n            <li>Mengelola koleksi bookmark cerita</li>\n            <li>Akses offline dengan IndexedDB</li>\n            <li>Halaman error yang user-friendly</li>\n          </ul>\n          \n          <h2>Teknologi yang Digunakan</h2>\n          <ul>\n            <li>HTML, CSS, dan JavaScript</li>\n            <li>Arsitektur Single-Page Application (SPA)</li>\n            <li>Pola Model-View-Presenter (MVP)</li>\n            <li>Leaflet untuk menampilkan peta</li>\n            <li>View Transition API untuk transisi halaman yang halus</li>\n            <li>IndexedDB untuk penyimpanan offline</li>\n            <li>Progressive Web App (PWA) features</li>\n          </ul>\n          \n          <h2>Kriteria Proyek</h2>\n          <ol>\n            <li>Menggunakan Dicoding Story API sebagai sumber data</li>\n            <li>Menggunakan arsitektur Single-Page Application</li>\n            <li>Menerapkan teknik hash dalam routing</li>\n            <li>Menampilkan daftar cerita dengan gambar dan teks</li>\n            <li>Menampilkan peta dengan marker untuk cerita</li>\n            <li>Fitur tambah cerita baru dengan kamera dan lokasi</li>\n            <li>Menerapkan aksesibilitas sesuai standar</li>\n            <li>Mengimplementasikan transisi halaman yang halus</li>\n          </ol>\n          \n          <h2>Struktur Aplikasi</h2>\n          <div class="app-structure">\n            <h3>Halaman yang Tersedia:</h3>\n            <ul>\n              <li><strong>Beranda:</strong> Menampilkan daftar semua cerita</li>\n              <li><strong>Detail Cerita:</strong> Menampilkan detail lengkap cerita dengan peta</li>\n              <li><strong>Tambah Cerita:</strong> Form untuk menambahkan cerita baru</li>\n              <li><strong>Bookmark:</strong> Koleksi cerita yang disimpan pengguna</li>\n              <li><strong>Tentang:</strong> Informasi aplikasi dan fitur</li>\n              <li><strong>Login/Register:</strong> Autentikasi pengguna</li>\n              <li><strong>404 Not Found:</strong> Halaman error untuk URL tidak valid</li>\n            </ul>\n          </div>\n          \n          <h2>Pengalaman Pengguna</h2>\n          <div class="ux-features">\n            <ul>\n              <li>Desain responsif untuk desktop dan mobile</li>\n              <li>Loading states untuk feedback visual</li>\n              <li>Notifikasi untuk aksi pengguna</li>\n              <li>Aksesibilitas keyboard dan screen reader</li>\n              <li>Transisi halaman yang smooth</li>\n              <li>Offline capability dengan fallback data</li>\n            </ul>\n          </div>\n          \n          <p style="margin-top: 30px;">\n            &copy; 2025 - Dibuat oleh Kharisma untuk submission kelas Dicoding\n          </p>\n        </div>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:(r=H(Y().mark((function t(){return Y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})}],e&&R(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function U(t){return U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},U(t)}function Q(){Q=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=k(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==U(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(U(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function K(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function z(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){K(i,n,o,a,s,"next",t)}function s(t){K(i,n,o,a,s,"throw",t)}a(void 0)}))}}function X(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,q(n.key),n)}}function q(t){var e=function(t){if("object"!=U(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=U(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==U(e)?e:e+""}const J=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"login",value:(o=z(Q().mark((function t(e){var r;return Q().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,n.login)(e);case 3:if(!(r=t.sent).error){t.next=6;break}throw new Error(r.message||"Login gagal");case 6:return t.abrupt("return",r);case 9:throw t.prev=9,t.t0=t.catch(0),console.error("Error during login:",t.t0),t.t0;case 13:case"end":return t.stop()}}),t,null,[[0,9]])}))),function(t){return o.apply(this,arguments)})},{key:"register",value:(r=z(Q().mark((function t(e){var r;return Q().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,n.register)(e);case 3:if(!(r=t.sent).error){t.next=6;break}throw new Error(r.message||"Registrasi gagal");case 6:return t.abrupt("return",r);case 9:throw t.prev=9,t.t0=t.catch(0),console.error("Error during registration:",t.t0),t.t0;case 13:case"end":return t.stop()}}),t,null,[[0,9]])}))),function(t){return r.apply(this,arguments)})}],e&&X(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,o}();function Z(t){return Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Z(t)}function $(){$=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=k(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==Z(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Z(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function tt(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function et(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,rt(n.key),n)}}function rt(t){var e=function(t){if("object"!=Z(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Z(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Z(e)?e:e+""}const nt=function(){return t=function t(e){var r=e.view,n=e.model;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._view=r,this._model=n},e=[{key:"checkLoginStatus",value:function(){return!!(0,o.x3)()&&(this._view.redirectToHome(),!0)}},{key:"login",value:(r=$().mark((function t(e){var r,n,i,a,s=this;return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.email,n=e.password,i=e.rememberMe,t.prev=1,this._view.showLoading(),t.next=5,this._model.login({email:r,password:n});case 5:if((a=t.sent).loginResult&&a.loginResult.token){t.next=8;break}throw new Error("Token tidak ditemukan dalam respons login");case 8:return(0,o.Ts)(a.loginResult,i),this._view.showSuccessMessage("Login berhasil. Mengalihkan..."),(0,o.Ds)("Berhasil","Login berhasil","success"),setTimeout((function(){s._view.redirectToHome()}),1500),t.abrupt("return",!0);case 15:return t.prev=15,t.t0=t.catch(1),console.error("Login error:",t.t0),this._view.showErrorMessage(t.t0.message||"Terjadi kesalahan saat login"),(0,o.Ds)("Error",t.t0.message||"Terjadi kesalahan saat login","error"),t.abrupt("return",!1);case 21:return t.prev=21,this._view.hideLoading(),t.finish(21);case 24:case"end":return t.stop()}}),t,this,[[1,15,21,24]])})),n=function(){var t=this,e=arguments;return new Promise((function(n,o){var i=r.apply(t,e);function a(t){tt(i,n,o,a,s,"next",t)}function s(t){tt(i,n,o,a,s,"throw",t)}a(void 0)}))},function(t){return n.apply(this,arguments)})}],e&&et(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function ot(t){return ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ot(t)}function it(){it=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=k(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==ot(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(ot(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function at(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function st(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){at(i,n,o,a,s,"next",t)}function s(t){at(i,n,o,a,s,"throw",t)}a(void 0)}))}}function ut(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ct(n.key),n)}}function ct(t){var e=function(t){if("object"!=ot(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ot(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ot(e)?e:e+""}var lt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._authModel=new J,this._presenter=new nt({view:this,model:this._authModel})},e=[{key:"render",value:(n=st(it().mark((function t(){return it().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section id="content" class="container" tabindex="-1">\n        <h1 class="page-title">Login</h1>\n        \n        <div class="form-container">\n          <div id="login-alert" class="alert" style="display: none;"></div>\n          \n          <form id="login-form">\n            <div class="form-group">\n              <label for="email" class="form-label">Email</label>\n              <input \n                type="email" \n                id="email" \n                class="form-input" \n                placeholder="Masukkan email" \n                required\n              >\n            </div>\n            \n            <div class="form-group">\n              <label for="password" class="form-label">Password</label>\n              <input \n                type="password" \n                id="password" \n                class="form-input" \n                placeholder="Masukkan password" \n                required\n              >\n            </div>\n            \n            <div class="form-check" style="margin-bottom: 15px;">\n              <input type="checkbox" id="remember-me" class="form-check-input">\n              <label for="remember-me" class="form-check-label">Ingat saya</label>\n            </div>\n            \n            <button type="submit" class="btn btn-primary btn-block" id="login-button">\n              Login\n            </button>\n          </form>\n          \n          <p style="margin-top: 20px; text-align: center;">\n            Belum punya akun? <a href="#/register">Daftar sekarang</a>\n          </p>\n        </div>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:(r=st(it().mark((function t(){var e,r=this;return it().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._presenter.checkLoginStatus()){t.next=2;break}return t.abrupt("return");case 2:e=document.getElementById("login-form"),document.getElementById("email").focus(),e.addEventListener("submit",function(){var t=st(it().mark((function t(e){var n,i,a;return it().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),n=document.getElementById("email").value,i=document.getElementById("password").value,a=document.getElementById("remember-me").checked,(0,o.cY)("Login attempt",{email:n,rememberMe:a}),t.next=7,r._presenter.login({email:n,password:i,rememberMe:a});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 5:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"showLoading",value:function(){var t=document.getElementById("login-button");t._originalText=t.textContent,t.textContent="Loading...",t.disabled=!0}},{key:"hideLoading",value:function(){var t=document.getElementById("login-button");t&&t._originalText&&(t.textContent=t._originalText,t.disabled=!1)}},{key:"showSuccessMessage",value:function(t){var e=document.getElementById("login-alert");e&&(e.className="alert alert-success",e.textContent=t,e.style.display="block")}},{key:"showErrorMessage",value:function(t){var e=document.getElementById("login-alert");e&&(e.className="alert alert-error",e.textContent=t,e.style.display="block")}},{key:"redirectToHome",value:function(){window.location.hash="#/"}}],e&&ut(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function ft(t){return ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ft(t)}function ht(){ht=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=k(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==ft(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(ft(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function pt(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function dt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,vt(n.key),n)}}function vt(t){var e=function(t){if("object"!=ft(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ft(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ft(e)?e:e+""}const yt=function(){return t=function t(e){var r=e.view,n=e.model;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._view=r,this._model=n},e=[{key:"checkLoginStatus",value:function(){return!!(0,o.x3)()&&(this._view.redirectToHome(),!0)}},{key:"validatePassword",value:function(t,e){return t!==e?"Password dan konfirmasi password tidak sama":t.length<8?"Password harus minimal 8 karakter":null}},{key:"register",value:(r=ht().mark((function t(e){var r,n,o,i,a,s=this;return ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.name,n=e.email,o=e.password,i=e.passwordConfirm,t.prev=1,this._view.showLoading(),!(a=this.validatePassword(o,i))){t.next=6;break}throw new Error(a);case 6:return t.next=8,this._model.register({name:r,email:n,password:o});case 8:return t.sent,this._view.showSuccessMessage("Registrasi berhasil. Silakan login."),setTimeout((function(){s._view.redirectToLogin()}),2e3),t.abrupt("return",!0);case 14:return t.prev=14,t.t0=t.catch(1),console.error("Register error:",t.t0),this._view.showErrorMessage(t.t0.message||"Terjadi kesalahan saat pendaftaran"),t.abrupt("return",!1);case 19:return t.prev=19,this._view.hideLoading(),t.finish(19);case 22:case"end":return t.stop()}}),t,this,[[1,14,19,22]])})),n=function(){var t=this,e=arguments;return new Promise((function(n,o){var i=r.apply(t,e);function a(t){pt(i,n,o,a,s,"next",t)}function s(t){pt(i,n,o,a,s,"throw",t)}a(void 0)}))},function(t){return n.apply(this,arguments)})}],e&&dt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function mt(t){return mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mt(t)}function gt(){gt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=k(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==mt(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(mt(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function bt(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function wt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){bt(i,n,o,a,s,"next",t)}function s(t){bt(i,n,o,a,s,"throw",t)}a(void 0)}))}}function kt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Et(n.key),n)}}function Et(t){var e=function(t){if("object"!=mt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=mt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==mt(e)?e:e+""}var xt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._authModel=new J,this._presenter=new yt({view:this,model:this._authModel})},e=[{key:"render",value:(n=wt(gt().mark((function t(){return gt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section id="content" class="container" tabindex="-1">\n        <h1 class="page-title">Daftar Akun</h1>\n        \n        <div class="form-container">\n          <div id="register-alert" class="alert" style="display: none;"></div>\n          \n          <form id="register-form">\n            <div class="form-group">\n              <label for="name" class="form-label">Nama</label>\n              <input \n                type="text" \n                id="name" \n                class="form-input" \n                placeholder="Masukkan nama" \n                required\n              >\n            </div>\n            \n            <div class="form-group">\n              <label for="email" class="form-label">Email</label>\n              <input \n                type="email" \n                id="email" \n                class="form-input" \n                placeholder="Masukkan email" \n                required\n              >\n            </div>\n            \n            <div class="form-group">\n              <label for="password" class="form-label">Password</label>\n              <input \n                type="password" \n                id="password" \n                class="form-input" \n                placeholder="Minimal 8 karakter" \n                minlength="8"\n                required\n              >\n            </div>\n            \n            <div class="form-group">\n              <label for="password-confirm" class="form-label">Konfirmasi Password</label>\n              <input \n                type="password" \n                id="password-confirm" \n                class="form-input" \n                placeholder="Konfirmasi password" \n                minlength="8"\n                required\n              >\n            </div>\n            \n            <button type="submit" class="btn btn-block" id="register-button">\n              Daftar\n            </button>\n          </form>\n          \n          <p style="margin-top: 20px; text-align: center;">\n            Sudah punya akun? <a href="#/login">Login</a>\n          </p>\n        </div>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:(r=wt(gt().mark((function t(){var e,r,n,i,a=this;return gt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=function(){r.value!==n.value?n.setCustomValidity("Password dan konfirmasi password tidak sama"):n.setCustomValidity("")},!this._presenter.checkLoginStatus()){t.next=3;break}return t.abrupt("return");case 3:e=document.getElementById("register-form"),r=document.getElementById("password"),n=document.getElementById("password-confirm"),document.getElementById("name").focus(),r.addEventListener("change",i),n.addEventListener("keyup",i),e.addEventListener("submit",function(){var t=wt(gt().mark((function t(e){var r,n,i,s;return gt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),r=document.getElementById("name").value,n=document.getElementById("email").value,i=document.getElementById("password").value,s=document.getElementById("password-confirm").value,(0,o.cY)("Register attempt",{name:r,email:n}),t.next=8,a._presenter.register({name:r,email:n,password:i,passwordConfirm:s});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 10:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"showLoading",value:function(){var t=document.getElementById("register-button"),e=t.textContent;t.textContent="Loading...",t.disabled=!0,t._originalText=e}},{key:"hideLoading",value:function(){var t=document.getElementById("register-button");t&&t._originalText&&(t.textContent=t._originalText,t.disabled=!1)}},{key:"showSuccessMessage",value:function(t){var e=document.getElementById("register-alert");e&&(e.className="alert alert-success",e.textContent=t,e.style.display="block")}},{key:"showErrorMessage",value:function(t){var e=document.getElementById("register-alert");e&&(e.className="alert alert-error",e.textContent=t,e.style.display="block",window.scrollTo({top:0,behavior:"smooth"}))}},{key:"redirectToHome",value:function(){window.location.hash="#/"}},{key:"redirectToLogin",value:function(){window.location.hash="#/login"}}],e&&kt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function _t(t){return _t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_t(t)}function St(){St=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=k(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==_t(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(_t(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function Ot(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function At(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Ot(i,n,o,a,s,"next",t)}function s(t){Ot(i,n,o,a,s,"throw",t)}a(void 0)}))}}function jt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Pt(n.key),n)}}function Pt(t){var e=function(t){if("object"!=_t(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=_t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==_t(e)?e:e+""}const Tt=function(){return t=function t(e){var r=e.view,n=e.model;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._view=r,this._model=n},e=[{key:"addStory",value:(i=At(St().mark((function t(e){var r,n,i;return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,this._view.showLoading(),e instanceof FormData?(r=e.get("description"),n=e.get("photo")):(r=e.description,n=e.photo),r&&("string"!=typeof r||""!==r.trim())){t.next=5;break}throw new Error("Deskripsi cerita tidak boleh kosong");case 5:if(n){t.next=7;break}throw new Error("Silakan ambil atau pilih foto terlebih dahulu");case 7:return(0,o.cY)("Mengirim data cerita dengan valid data"),t.next=10,this._model.addStory(e);case 10:if((i=t.sent).error){t.next=22;break}if(!i.offline){t.next=16;break}(0,o.Ds)("Offline","Story disimpan offline, akan dikirim saat online","info"),t.next=19;break;case 16:return(0,o.Ds)("Berhasil","Story berhasil ditambahkan","success"),t.next=19,this._sendPushNotification(r);case 19:return t.abrupt("return",!0);case 22:throw new Error(i.message||"Gagal menambahkan cerita");case 23:t.next=30;break;case 25:return t.prev=25,t.t0=t.catch(0),(0,o.cY)("Error adding story:",t.t0),this._view.showErrorMessage(t.t0.message),t.abrupt("return",!1);case 30:return t.prev=30,this._view.hideLoading(),t.finish(30);case 33:case"end":return t.stop()}}),t,this,[[0,25,30,33]])}))),function(t){return i.apply(this,arguments)})},{key:"_sendPushNotification",value:(n=At(St().mark((function t(e){var r,n;return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!("serviceWorker"in navigator)||!("PushManager"in window)){t.next=11;break}return t.next=4,navigator.serviceWorker.ready;case 4:return r=t.sent,t.next=7,r.pushManager.getSubscription();case 7:t.sent?(n={title:"Story berhasil dibuat",options:{body:"Anda telah membuat story baru dengan deskripsi: ".concat(e.substring(0,100)).concat(e.length>100?"...":""),icon:"./favicon.png",badge:"./favicon.png",tag:"story-created",requireInteraction:!1,silent:!1,data:{url:"#/"}}},r.active&&r.active.postMessage({type:"SHOW_NOTIFICATION",payload:n}),(0,o.cY)("Push notification sent successfully")):(0,o.cY)("User not subscribed to push notifications"),t.next=12;break;case 11:(0,o.cY)("Push notifications not supported");case 12:t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),(0,o.cY)("Error sending push notification:",t.t0);case 17:case"end":return t.stop()}}),t,null,[[0,14]])}))),function(t){return n.apply(this,arguments)})},{key:"initMap",value:(r=At(St().mark((function t(){return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._view.initMap();case 3:t.next=9;break;case 5:t.prev=5,t.t0=t.catch(0),(0,o.cY)("Map initialization error:",t.t0),this._view.handleMapError(t.t0);case 9:case"end":return t.stop()}}),t,this,[[0,5]])}))),function(){return r.apply(this,arguments)})},{key:"updateMarker",value:function(t,e){this._view.updateMarker(t,e)}},{key:"getCurrentLocation",value:function(){this._view.getCurrentLocation()}},{key:"resetMapMarker",value:function(){this._view.resetMapMarker()}}],e&&jt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,i}();function Bt(t){return Bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bt(t)}function It(){It=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=k(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==Bt(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Bt(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function Lt(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function Mt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Lt(i,n,o,a,s,"next",t)}function s(t){Lt(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Nt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Gt(n.key),n)}}function Gt(t){var e=function(t){if("object"!=Bt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Bt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Bt(e)?e:e+""}var Ft=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._storyModel=new d,this._presenter=new Tt({view:this,model:this._storyModel}),this._map=null,this._currentMarker=null,this._cameraStream=null,this._imageBlob=null,this._location={lat:null,lon:null},this.handleSubmit=this.handleSubmit.bind(this),this.startCamera=this.startCamera.bind(this),this.capturePhoto=this.capturePhoto.bind(this),this.resetCamera=this.resetCamera.bind(this),this.handleGalleryInput=this.handleGalleryInput.bind(this),this.getCurrentLocation=this.getCurrentLocation.bind(this),this.isSubmitting=!1},e=[{key:"render",value:(c=Mt(It().mark((function t(){return It().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section id="content" class="container" tabindex="-1">\n        <h1 class="page-title"><i class="fas fa-plus-circle"></i> Tambah Cerita Baru</h1>\n        \n        <div class="form-container">\n          <div id="add-story-alert" class="alert" style="display: none;"></div>\n          \n          <form id="add-story-form">\n            <div class="form-group">\n              <label for="description" class="form-label"><i class="fas fa-edit"></i> Deskripsi</label>\n              <textarea \n                id="description" \n                class="form-input" \n                placeholder="Ceritakan pengalamanmu..." \n                required\n                rows="4"\n              ></textarea>\n            </div>\n            \n            <div class="form-group">\n              <label class="form-label"><i class="fas fa-camera"></i> Foto</label>\n              \n              <div class="camera-section">\n                <div class="camera-container">\n                  <video id="camera-preview" autoplay playsinline style="display: none;"></video>\n                  <canvas id="camera-canvas" style="display: none;"></canvas>\n                  <img id="photo-preview" class="photo-preview" src="#" alt="Preview" style="display: none;">\n                </div>\n                \n                <div class="camera-buttons">\n                  <button type="button" id="camera-start-button" class="btn btn-primary">\n                    <i class="fas fa-camera"></i> Kamera\n                  </button>\n                  <button type="button" id="gallery-button" class="btn btn-info">\n                    <i class="far fa-images"></i> Galeri\n                  </button>\n                  <button type="button" id="camera-capture-button" class="btn btn-success" style="display: none;">\n                    <i class="fas fa-camera-retro"></i> Ambil Foto\n                  </button>\n                  <button type="button" id="camera-reset-button" class="btn btn-danger" style="display: none;">\n                    <i class="fas fa-trash-alt"></i> Reset\n                  </button>\n                </div>\n                \n                <input type="file" id="gallery-input" accept="image/*" style="display: none;">\n              </div>\n            </div>\n            \n            <div class="form-group">\n              <label class="form-label"><i class="fas fa-map-marker-alt"></i> Lokasi</label>\n              \n              <div id="map-container" class="map-container" style="height: 300px;"></div>\n              \n              <div class="location-info" style="margin-top: 10px;">\n                <p id="location-text">Klik pada peta untuk memilih lokasi, atau gunakan lokasi saat ini.</p>\n                \n                <button type="button" id="current-location-button" class="btn btn-info">\n                  <i class="fas fa-crosshairs"></i> Gunakan Lokasi Saat Ini\n                </button>\n                \n                <div class="coordinates-display" style="margin-top: 10px; display: none;" id="coordinates-display">\n                  <div class="form-row">\n                    <div class="form-group form-group-half">\n                      <label for="lat" class="form-label">Latitude</label>\n                      <input type="text" id="lat" class="form-input" readonly>\n                    </div>\n                    <div class="form-group form-group-half">\n                      <label for="lon" class="form-label">Longitude</label>\n                      <input type="text" id="lon" class="form-input" readonly>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n            \n            <button type="submit" class="btn btn-primary btn-block" id="submit-button">\n              <i class="fas fa-paper-plane"></i> Tambah Cerita\n            </button>\n          </form>\n        </div>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return c.apply(this,arguments)})},{key:"afterRender",value:(u=Mt(It().mark((function t(){var e,r,n,o,i,a,s,u,c=this;return It().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e=document.getElementById("add-story-form"),document.getElementById("submit-button"),r=document.getElementById("camera-start-button"),n=document.getElementById("camera-capture-button"),o=document.getElementById("camera-reset-button"),document.getElementById("camera-preview"),document.getElementById("camera-canvas"),document.getElementById("photo-preview"),i=document.getElementById("gallery-button"),a=document.getElementById("gallery-input"),s=document.getElementById("current-location-button"),t.next=14,this._presenter.initMap();case 14:(u=document.querySelector(".notification-modal"))&&u.remove(),r&&r.addEventListener("click",this.startCamera),n&&n.addEventListener("click",this.capturePhoto),o&&o.addEventListener("click",this.resetCamera),i&&a&&(i.addEventListener("click",(function(){c.resetCamera(),a.click()})),a.addEventListener("change",this.handleGalleryInput)),s&&s.addEventListener("click",this.getCurrentLocation),e&&e.addEventListener("submit",this.handleSubmit),t.next=27;break;case 24:t.prev=24,t.t0=t.catch(0),this.showPageError(t.t0);case 27:case"end":return t.stop()}}),t,this,[[0,24]])}))),function(){return u.apply(this,arguments)})},{key:"startCamera",value:(s=Mt(It().mark((function t(e){var r,n,i,a,s,u;return It().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=document.getElementById("camera-start-button"),n=document.getElementById("camera-preview"),i=document.getElementById("camera-capture-button"),a=document.getElementById("camera-reset-button"),s=document.getElementById("photo-preview"),r.disabled=!0,n.style.display="block",i.style.display="inline-block",a.style.display="inline-block",s.style.display="none",t.next=13,(0,o.Gc)(n);case 13:this._cameraStream=t.sent,i.disabled=!1,t.next=22;break;case 17:t.prev=17,t.t0=t.catch(0),(0,o.Ds)("Error",t.t0.message,"error"),(u=document.getElementById("camera-start-button"))&&(u.disabled=!1);case 22:case"end":return t.stop()}}),t,this,[[0,17]])}))),function(t){return s.apply(this,arguments)})},{key:"capturePhoto",value:(a=Mt(It().mark((function t(e){var r,n,i,a,s;return It().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=document.getElementById("camera-preview"),n=document.getElementById("camera-canvas"),i=document.getElementById("photo-preview"),a=document.getElementById("camera-capture-button"),t.next=7,(0,o.O$)(r,n);case 7:this._imageBlob=t.sent,s=URL.createObjectURL(this._imageBlob),i.src=s,i.style.display="block",r.style.display="none",this._cameraStream&&((0,o.tx)(this._cameraStream),this._cameraStream=null),a.style.display="none",t.next=19;break;case 16:t.prev=16,t.t0=t.catch(0),(0,o.Ds)("Error",t.t0.message,"error");case 19:case"end":return t.stop()}}),t,this,[[0,16]])}))),function(t){return a.apply(this,arguments)})},{key:"handleGalleryInput",value:(i=Mt(It().mark((function t(e){var r,n,i,a,s,u,c;return It().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r=document.getElementById("photo-preview"),n=document.getElementById("camera-preview"),i=document.getElementById("camera-capture-button"),a=document.getElementById("camera-reset-button"),s=document.getElementById("camera-start-button"),!e.target.files||!e.target.files[0]){t.next=18;break}return u=e.target.files[0],t.next=10,(0,o.zF)(u);case 10:this._imageBlob=t.sent,c=URL.createObjectURL(this._imageBlob),r.src=c,r.style.display="block",n.style.display="none",i.style.display="none",a.style.display="inline-block",s.disabled=!0;case 18:t.next=23;break;case 20:t.prev=20,t.t0=t.catch(0),(0,o.Ds)("Error",t.t0.message,"error");case 23:case"end":return t.stop()}}),t,this,[[0,20]])}))),function(t){return i.apply(this,arguments)})},{key:"handleSubmit",value:(n=Mt(It().mark((function t(e){var r,n,i,a,s,u,c,l;return It().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.preventDefault(),!this.isSubmitting){t.next=3;break}return t.abrupt("return");case 3:return this.isSubmitting=!0,t.prev=4,r=document.getElementById("description").value,n=this._imageBlob,i=document.getElementById("lat").value,a=document.getElementById("lon").value,s=new FormData,r&&s.append("description",r),n&&(u=new File([n],"photo.jpg",{type:"image/jpeg"}),s.append("photo",u)),i&&a&&(s.append("lat",parseFloat(i)),s.append("lon",parseFloat(a))),(0,o.cY)("Mengirim data cerita baru:",{description:r,photoSize:n?n.size:0,hasLocation:!(!i||!a)}),t.next=16,this._presenter.addStory(s);case 16:t.sent&&(c=document.getElementById("add-story-form"),l=document.getElementById("photo-preview"),c&&c.reset(),l&&(l.style.display="none"),this._imageBlob=null,this._presenter.resetMapMarker(),setTimeout((function(){window.location.href="#/"}),1500)),t.next=23;break;case 20:t.prev=20,t.t0=t.catch(4),this.showErrorMessage(t.t0.message||"Gagal menambahkan cerita");case 23:return t.prev=23,this.isSubmitting=!1,t.finish(23);case 26:case"end":return t.stop()}}),t,this,[[4,20,23,26]])}))),function(t){return n.apply(this,arguments)})},{key:"resetCamera",value:function(){this._cameraStream&&((0,o.tx)(this._cameraStream),this._cameraStream=null),this._imageBlob=null;var t=document.getElementById("photo-preview"),e=document.getElementById("camera-preview"),r=document.getElementById("camera-capture-button"),n=document.getElementById("camera-reset-button"),i=document.getElementById("camera-start-button");t&&(t.style.display="none"),e&&(e.style.display="none"),r&&(r.style.display="none"),n&&(n.style.display="none"),i&&(i.disabled=!1)}},{key:"initMap",value:(r=Mt(It().mark((function t(){var e,r=this;return It().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,o.Q2)();case 3:if(e=t.sent,document.getElementById("map-container")){t.next=7;break}throw new Error("Map container not found");case 7:if(e){t.next=10;break}return this.handleMapError(new Error("Map tidak tersedia dalam mode offline")),t.abrupt("return");case 10:this._map=e.map("map-container").setView([-2.5489,118.0149],5),e.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(this._map),this._map.on("click",(function(t){r._presenter.updateMarker(t.latlng.lat,t.latlng.lng)})),t.next=18;break;case 15:t.prev=15,t.t0=t.catch(0),this.handleMapError(t.t0);case 18:case"end":return t.stop()}}),t,this,[[0,15]])}))),function(){return r.apply(this,arguments)})},{key:"updateMarker",value:function(t,e){try{var r=parseFloat(t).toFixed(6),n=parseFloat(e).toFixed(6);if(this._location={lat:r,lon:n},document.getElementById("lat").value=r,document.getElementById("lon").value=n,document.getElementById("coordinates-display").style.display="block",document.getElementById("location-text").textContent="Lokasi dipilih: ".concat(r,", ").concat(n),this._currentMarker&&this._map&&this._map.removeLayer(this._currentMarker),this._map&&window.L){var i=window.L.icon({iconUrl:"https://cdn-icons-png.flaticon.com/512/684/684908.png",iconSize:[32,32],iconAnchor:[16,32],popupAnchor:[0,-32]});this._currentMarker=window.L.marker([t,e],{icon:i}).addTo(this._map).bindPopup("Lokasi cerita").openPopup()}}catch(t){(0,o.Ds)("Error","Gagal memperbarui marker: ".concat(t.message),"error")}}},{key:"resetMapMarker",value:function(){try{this._location={lat:null,lon:null},this._currentMarker&&this._map&&(this._map.removeLayer(this._currentMarker),this._currentMarker=null),document.getElementById("lat").value="",document.getElementById("lon").value="",document.getElementById("coordinates-display").style.display="none",document.getElementById("location-text").textContent="Klik pada peta untuk memilih lokasi, atau gunakan lokasi saat ini."}catch(t){console.error("Error resetting map marker:",t)}}},{key:"getCurrentLocation",value:function(){var t=this;try{if(!navigator.geolocation)throw new Error("Geolocation tidak didukung oleh browser Anda");var e=document.getElementById("current-location-button"),r=e.textContent;e.textContent="Mendapatkan Lokasi...",e.disabled=!0,navigator.geolocation.getCurrentPosition((function(n){var o=n.coords,i=o.latitude,a=o.longitude;t.updateMarker(i,a),t._map&&t._map.setView([i,a],15),e.textContent=r,e.disabled=!1}),(function(t){var n="Gagal mendapatkan lokasi: ";switch(t.code){case t.PERMISSION_DENIED:n+="Izin lokasi ditolak.";break;case t.POSITION_UNAVAILABLE:n+="Informasi lokasi tidak tersedia.";break;case t.TIMEOUT:n+="Waktu permintaan lokasi habis.";break;default:n+="Kesalahan tidak diketahui."}(0,o.Ds)("Error",n,"error"),e.textContent=r,e.disabled=!1}),{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})}catch(t){(0,o.Ds)("Error",t.message,"error")}}},{key:"showLoading",value:function(){var t=document.getElementById("submit-button");t._originalText=t.textContent,t.textContent="Mengirim...",t.disabled=!0;var e=document.getElementById("add-story-alert");e&&(e.className="alert alert-info",e.textContent="Sedang mengirim cerita...",e.style.display="block")}},{key:"hideLoading",value:function(){var t=document.getElementById("submit-button");t&&t._originalText&&(t.textContent=t._originalText,t.disabled=!1)}},{key:"showSuccessMessage",value:function(t){var e=document.getElementById("add-story-alert");e&&(e.className="alert alert-success",e.textContent=t,e.style.display="block"),(0,o.Ds)("Berhasil",t,"success")}},{key:"showErrorMessage",value:function(t){var e=document.getElementById("add-story-alert");e&&(e.className="alert alert-error",e.textContent=t,e.style.display="block"),(0,o.Ds)("Error",t,"error")}},{key:"showPageError",value:function(t){var e=document.querySelector(".container");e&&(e.innerHTML='\n        <div class="alert alert-error">\n          <p>Terjadi kesalahan saat memuat halaman tambah cerita.</p>\n          <p>'.concat(t.message||"Kesalahan tidak diketahui",'</p>\n          <p><a href="#/">Kembali ke beranda</a></p>\n        </div>\n      '))}},{key:"handleMapError",value:function(t){console.log("Map error handled gracefully:",t.message);var e=document.getElementById("map-container");e&&(e.innerHTML='\n        <div class="alert alert-info" style="padding: 20px; text-align: center; background: #f0f8ff; border: 1px solid #add8e6; border-radius: 5px;">\n          <i class="fas fa-info-circle"></i>\n          <p><strong>Mode Offline</strong></p>\n          <p>Peta tidak tersedia saat offline. Anda masih dapat menambahkan cerita tanpa lokasi.</p>\n          <p><small>Koordinat akan disimpan jika Anda menggunakan geolocation.</small></p>\n        </div>\n      ')}},{key:"cleanup",value:function(){try{var t=document.getElementById("add-story-form");t&&t.removeEventListener("submit",this.handleSubmit);var e=document.getElementById("camera-start-button");e&&e.removeEventListener("click",this.startCamera);var r=document.getElementById("camera-capture-button");r&&r.removeEventListener("click",this.capturePhoto);var n=document.getElementById("camera-reset-button");n&&n.removeEventListener("click",this.resetCamera);var i=document.getElementById("gallery-input");i&&i.removeEventListener("change",this.handleGalleryInput);var a=document.getElementById("current-location-button");a&&a.removeEventListener("click",this.getCurrentLocation),this._cameraStream&&((0,o.tx)(this._cameraStream),this._cameraStream=null),this._map&&(this._map.remove(),this._map=null);var s=document.querySelector(".notification-modal");s&&s.remove(),console.log("AddStoryPage resources cleaned up")}catch(t){console.error("Error during cleanup:",t)}}}],e&&Nt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,i,a,s,u,c}();function Ct(t){return Ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ct(t)}function Yt(){Yt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=k(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==Ct(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Ct(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function Dt(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function Ht(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Dt(i,n,o,a,s,"next",t)}function s(t){Dt(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Rt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Wt(n.key),n)}}function Wt(t){var e=function(t){if("object"!=Ct(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Ct(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ct(e)?e:e+""}const Vt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.DB_NAME="StoryBookmarksDB",this.DB_VERSION=1,this.STORE_NAME="bookmarks",this.db=null},e=[{key:"_initDB",value:(u=Ht(Yt().mark((function t(){var e=this;return Yt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.db){t.next=2;break}return t.abrupt("return",this.db);case 2:return t.abrupt("return",new Promise((function(t,r){var n=indexedDB.open(e.DB_NAME,e.DB_VERSION);n.onerror=function(){(0,o.cY)("Error opening IndexedDB:",n.error),r(n.error)},n.onsuccess=function(){e.db=n.result,(0,o.cY)("IndexedDB opened successfully"),t(e.db)},n.onupgradeneeded=function(t){var r=t.target.result;r.objectStoreNames.contains(e.STORE_NAME)&&r.deleteObjectStore(e.STORE_NAME);var n=r.createObjectStore(e.STORE_NAME,{keyPath:"id"});n.createIndex("name","name",{unique:!1}),n.createIndex("createdAt","createdAt",{unique:!1}),n.createIndex("bookmarkedAt","bookmarkedAt",{unique:!1}),(0,o.cY)("IndexedDB store created successfully")}})));case 3:case"end":return t.stop()}}),t,this)}))),function(){return u.apply(this,arguments)})},{key:"addBookmark",value:(s=Ht(Yt().mark((function t(e){var r,n=this;return Yt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._initDB();case 3:return r={id:e.id,name:e.name,description:e.description,photoUrl:e.photoUrl,createdAt:e.createdAt,lat:e.lat,lon:e.lon,bookmarkedAt:(new Date).toISOString()},t.abrupt("return",new Promise((function(t,i){var a=n.db.transaction([n.STORE_NAME],"readwrite").objectStore(n.STORE_NAME).put(r);a.onsuccess=function(){(0,o.cY)("Story bookmarked successfully:",e.id),t({error:!1,message:"Story berhasil ditambahkan ke bookmark"})},a.onerror=function(){(0,o.cY)("Error adding bookmark:",a.error),i({error:!0,message:"Gagal menambahkan bookmark"})}})));case 7:return t.prev=7,t.t0=t.catch(0),(0,o.cY)("Error in addBookmark:",t.t0),t.abrupt("return",{error:!0,message:"Terjadi kesalahan saat menambahkan bookmark"});case 11:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(t){return s.apply(this,arguments)})},{key:"getAllBookmarks",value:(a=Ht(Yt().mark((function t(){var e=this;return Yt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._initDB();case 3:return t.abrupt("return",new Promise((function(t,r){var n=e.db.transaction([e.STORE_NAME],"readonly").objectStore(e.STORE_NAME).getAll();n.onsuccess=function(){var e=n.result;e.sort((function(t,e){return new Date(e.bookmarkedAt)-new Date(t.bookmarkedAt)})),(0,o.cY)("Retrieved bookmarks:",e.length),t({error:!1,message:"success",listStory:e})},n.onerror=function(){(0,o.cY)("Error getting bookmarks:",n.error),r({error:!0,message:"Gagal mengambil data bookmark"})}})));case 6:return t.prev=6,t.t0=t.catch(0),(0,o.cY)("Error in getAllBookmarks:",t.t0),t.abrupt("return",{error:!0,message:"Terjadi kesalahan saat mengambil bookmark",listStory:[]});case 10:case"end":return t.stop()}}),t,this,[[0,6]])}))),function(){return a.apply(this,arguments)})},{key:"deleteBookmark",value:(i=Ht(Yt().mark((function t(e){var r=this;return Yt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._initDB();case 3:return t.abrupt("return",new Promise((function(t,n){var i=r.db.transaction([r.STORE_NAME],"readwrite").objectStore(r.STORE_NAME).delete(e);i.onsuccess=function(){(0,o.cY)("Bookmark deleted successfully:",e),t({error:!1,message:"Bookmark berhasil dihapus"})},i.onerror=function(){(0,o.cY)("Error deleting bookmark:",i.error),n({error:!0,message:"Gagal menghapus bookmark"})}})));case 6:return t.prev=6,t.t0=t.catch(0),(0,o.cY)("Error in deleteBookmark:",t.t0),t.abrupt("return",{error:!0,message:"Terjadi kesalahan saat menghapus bookmark"});case 10:case"end":return t.stop()}}),t,this,[[0,6]])}))),function(t){return i.apply(this,arguments)})},{key:"isBookmarked",value:(n=Ht(Yt().mark((function t(e){var r=this;return Yt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._initDB();case 3:return t.abrupt("return",new Promise((function(t,n){var i=r.db.transaction([r.STORE_NAME],"readonly").objectStore(r.STORE_NAME).get(e);i.onsuccess=function(){var r=!!i.result;(0,o.cY)("Bookmark check for",e,":",r),t(r)},i.onerror=function(){(0,o.cY)("Error checking bookmark:",i.error),t(!1)}})));case 6:return t.prev=6,t.t0=t.catch(0),(0,o.cY)("Error in isBookmarked:",t.t0),t.abrupt("return",!1);case 10:case"end":return t.stop()}}),t,this,[[0,6]])}))),function(t){return n.apply(this,arguments)})},{key:"getBookmarkCount",value:(r=Ht(Yt().mark((function t(){var e=this;return Yt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._initDB();case 3:return t.abrupt("return",new Promise((function(t,r){var n=e.db.transaction([e.STORE_NAME],"readonly").objectStore(e.STORE_NAME).count();n.onsuccess=function(){t(n.result)},n.onerror=function(){(0,o.cY)("Error getting bookmark count:",n.error),t(0)}})));case 6:return t.prev=6,t.t0=t.catch(0),(0,o.cY)("Error in getBookmarkCount:",t.t0),t.abrupt("return",0);case 10:case"end":return t.stop()}}),t,this,[[0,6]])}))),function(){return r.apply(this,arguments)})}],e&&Rt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,i,a,s,u}();function Ut(t){return Ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ut(t)}function Qt(){Qt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=k(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==Ut(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Ut(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function Kt(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function zt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Kt(i,n,o,a,s,"next",t)}function s(t){Kt(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Xt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,qt(n.key),n)}}function qt(t){var e=function(t){if("object"!=Ut(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Ut(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ut(e)?e:e+""}const Jt=function(){return t=function t(e){var r=e.view,n=e.model,o=e.storyId;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._view=r,this._model=n,this._storyId=o,this._story=null},e=[{key:"loadStoryDetail",value:(n=zt(Qt().mark((function t(){var e;return Qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this._view.showLoading(),t.next=4,this._model.getStoryDetail(this._storyId);case 4:if(e=t.sent,this._story=e.story,this._story){t.next=8;break}throw new Error("Cerita tidak ditemukan");case 8:return t.next=10,this._view.renderStoryDetail(this._story);case 10:if(!this._story.lat||!this._story.lon){t.next=13;break}return t.next=13,this.initMap();case 13:t.next=19;break;case 15:t.prev=15,t.t0=t.catch(0),console.error("Error loading story detail:",t.t0),this._view.showErrorMessage(t.t0.message);case 19:return t.prev=19,this._view.hideLoading(),t.finish(19);case 22:case"end":return t.stop()}}),t,this,[[0,15,19,22]])}))),function(){return n.apply(this,arguments)})},{key:"initMap",value:(r=zt(Qt().mark((function t(){return Qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._story.lat&&this._story.lon){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,new Promise((function(t){return setTimeout(t,100)}));case 5:return t.next=7,this._view.initMap(this._story.lat,this._story.lon,this._story);case 7:t.next=13;break;case 9:t.prev=9,t.t0=t.catch(2),console.error("Map initialization error:",t.t0),this._view.handleMapError(t.t0);case 13:case"end":return t.stop()}}),t,this,[[2,9]])}))),function(){return r.apply(this,arguments)})}],e&&Xt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function Zt(t){return Zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zt(t)}function $t(){$t=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=k(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==Zt(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Zt(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function te(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function ee(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){te(i,n,o,a,s,"next",t)}function s(t){te(i,n,o,a,s,"throw",t)}a(void 0)}))}}function re(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ne(n.key),n)}}function ne(t){var e=function(t){if("object"!=Zt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Zt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Zt(e)?e:e+""}var oe=function(){return t=function t(e){var r=e.view,n=e.model;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._view=r,this._model=n},e=[{key:"loadBookmarks",value:(s=ee($t().mark((function t(){var e,r;return $t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this._view.showLoading(),(0,o.cY)("Loading bookmarks from IndexedDB"),t.next=5,this._model.getAllBookmarks();case 5:if(r=t.sent,this._view.hideLoading(),!r.error){t.next=11;break}return(0,o.cY)("Error loading bookmarks:",r.message),this._view.showErrorMessage(r.message),t.abrupt("return");case 11:(0,o.cY)("Bookmarks loaded successfully:",(null===(e=r.listStory)||void 0===e?void 0:e.length)||0),this._view.renderBookmarks(r),t.next=20;break;case 15:t.prev=15,t.t0=t.catch(0),(0,o.cY)("Error in loadBookmarks presenter:",t.t0),this._view.hideLoading(),this._view.showErrorMessage("Terjadi kesalahan saat memuat bookmark");case 20:case"end":return t.stop()}}),t,this,[[0,15]])}))),function(){return s.apply(this,arguments)})},{key:"addBookmark",value:(a=ee($t().mark((function t(e){var r;return $t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,(0,o.cY)("Adding bookmark:",e.id),t.next=4,this._model.addBookmark(e);case 4:if(!(r=t.sent).error){t.next=8;break}return(0,o.cY)("Error adding bookmark:",r.message),t.abrupt("return",r);case 8:return(0,o.cY)("Bookmark added successfully"),t.abrupt("return",r);case 12:return t.prev=12,t.t0=t.catch(0),(0,o.cY)("Error in addBookmark presenter:",t.t0),t.abrupt("return",{error:!0,message:"Terjadi kesalahan saat menambahkan bookmark"});case 16:case"end":return t.stop()}}),t,this,[[0,12]])}))),function(t){return a.apply(this,arguments)})},{key:"removeBookmark",value:(i=ee($t().mark((function t(e){var r;return $t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,(0,o.cY)("Removing bookmark:",e),t.next=4,this._model.deleteBookmark(e);case 4:if(!(r=t.sent).error){t.next=8;break}return(0,o.cY)("Error removing bookmark:",r.message),t.abrupt("return",r);case 8:return(0,o.cY)("Bookmark removed successfully"),t.abrupt("return",r);case 12:return t.prev=12,t.t0=t.catch(0),(0,o.cY)("Error in removeBookmark presenter:",t.t0),t.abrupt("return",{error:!0,message:"Terjadi kesalahan saat menghapus bookmark"});case 16:case"end":return t.stop()}}),t,this,[[0,12]])}))),function(t){return i.apply(this,arguments)})},{key:"isBookmarked",value:(n=ee($t().mark((function t(e){var r;return $t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,(0,o.cY)("Checking bookmark status:",e),t.next=4,this._model.isBookmarked(e);case 4:return r=t.sent,(0,o.cY)("Bookmark status:",r),t.abrupt("return",r);case 9:return t.prev=9,t.t0=t.catch(0),(0,o.cY)("Error checking bookmark status:",t.t0),t.abrupt("return",!1);case 13:case"end":return t.stop()}}),t,this,[[0,9]])}))),function(t){return n.apply(this,arguments)})},{key:"getBookmarkCount",value:(r=ee($t().mark((function t(){var e;return $t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._model.getBookmarkCount();case 3:return e=t.sent,(0,o.cY)("Bookmark count:",e),t.abrupt("return",e);case 8:return t.prev=8,t.t0=t.catch(0),(0,o.cY)("Error getting bookmark count:",t.t0),t.abrupt("return",0);case 12:case"end":return t.stop()}}),t,this,[[0,8]])}))),function(){return r.apply(this,arguments)})}],e&&re(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,i,a,s}();function ie(t){var e=t.split("/");return{resource:e[1]||null,id:e[2]||null}}function ae(t){var e="";return t.resource&&(e=e.concat("/".concat(t.resource))),t.id&&(e=e.concat("/:id")),e||"/"}function se(){return location.hash.replace("#","")||"/"}function ue(t){return ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ue(t)}function ce(){ce=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=k(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==ue(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(ue(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function le(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function fe(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){le(i,n,o,a,s,"next",t)}function s(t){le(i,n,o,a,s,"throw",t)}a(void 0)}))}}function he(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,pe(n.key),n)}}function pe(t){var e=function(t){if("object"!=ue(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ue(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ue(e)?e:e+""}function de(t){return de="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},de(t)}function ve(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return ye(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ye(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function ye(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function me(){me=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=k(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==de(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(de(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function ge(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function be(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){ge(i,n,o,a,s,"next",t)}function s(t){ge(i,n,o,a,s,"throw",t)}a(void 0)}))}}function we(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ke(n.key),n)}}function ke(t){var e=function(t){if("object"!=de(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=de(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==de(e)?e:e+""}function Ee(t){return Ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ee(t)}function xe(){xe=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=k(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==Ee(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Ee(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function _e(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function Se(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){_e(i,n,o,a,s,"next",t)}function s(t){_e(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Oe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ae(n.key),n)}}function Ae(t){var e=function(t){if("object"!=Ee(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Ee(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ee(e)?e:e+""}const je={"/":I,"/about":V,"/login":lt,"/register":xt,"/add":Ft,"/story/:id":function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._storyModel=new d,this._bookmarkModel=new Vt;var e=ie(se()).id;this._presenter=new Jt({view:this,model:this._storyModel,storyId:e}),this._bookmarkPresenter=new oe({view:this,model:this._bookmarkModel}),this._map=null,this._mapError=!1,this._story=null,this._isBookmarked=!1},e=[{key:"render",value:(u=fe(ce().mark((function t(){return ce().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section id="content" class="container" tabindex="-1">\n        <div id="story-detail-container">\n          <div class="loading">\n            <div class="loading-spinner"></div>\n          </div>\n        </div>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return u.apply(this,arguments)})},{key:"afterRender",value:(s=fe(ce().mark((function t(){return ce().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((0,o.x3)()){t.next=3;break}return window.location.hash="#/login",t.abrupt("return");case 3:return t.next=5,this._presenter.loadStoryDetail();case 5:case"end":return t.stop()}}),t,this)}))),function(){return s.apply(this,arguments)})},{key:"showLoading",value:function(){var t=document.getElementById("story-detail-container");t&&(t.innerHTML='\n        <div class="loading">\n          <div class="loading-spinner"></div>\n        </div>\n      ')}},{key:"hideLoading",value:function(){(0,o.cY)("Loading hidden")}},{key:"renderStoryDetail",value:(a=fe(ce().mark((function t(e){var r;return ce().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._story=e,t.next=3,this._bookmarkPresenter.isBookmarked(e.id);case 3:if(this._isBookmarked=t.sent,r=document.getElementById("story-detail-container")){t.next=7;break}return t.abrupt("return");case 7:if(t.prev=7,r.innerHTML='\n        <div class="story-detail">\n          <div class="story-detail-header">\n            <img \n              src="'.concat(e.photoUrl,'" \n              alt="Cerita dari ').concat(e.name,'" \n              class="story-detail-image"\n              onerror="this.onerror=null; this.src=\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNk+A8AAQUBAScY42YAAAAASUVORK5CYII=\';"\n            >\n            \n            <div class="story-detail-overlay">\n              <button \n                id="bookmark-toggle-btn" \n                class="btn btn-icon bookmark-btn ').concat(this._isBookmarked?"bookmarked":"",'"\n                title="').concat(this._isBookmarked?"Hapus dari bookmark":"Tambah ke bookmark",'"\n              >\n                <i class="fas fa-bookmark"></i>\n              </button>\n            </div>\n          </div>\n          \n          <div class="story-detail-content">\n            <h1 class="story-detail-title">Cerita dari ').concat(e.name,'</h1>\n            \n            <div class="story-detail-meta">\n              <span class="story-date">\n                <i class="far fa-calendar-alt"></i>\n                ').concat((0,o.Ce)(e.createdAt),"\n              </span>\n              \n              ").concat(e.lat&&e.lon?'\n                <span class="story-location">\n                  <i class="fas fa-map-marker-alt"></i>\n                  '.concat(this._mapError?"Lokasi: ".concat(e.lat.toFixed(6),", ").concat(e.lon.toFixed(6)):"Lokasi tersedia","\n                </span>\n              "):"",'\n            </div>\n            \n            <p class="story-detail-description">').concat(e.description||"Tidak ada deskripsi","</p>\n            \n            ").concat(e.lat&&e.lon?'\n              <div id="story-detail-map" class="story-detail-map"></div>\n            ':"",'\n            \n            <div class="story-detail-actions">\n              <a href="#/" class="btn btn-primary">\n                <i class="fas fa-arrow-left"></i> Kembali ke Beranda\n              </a>\n              \n              <button \n                id="bookmark-text-btn" \n                class="btn ').concat(this._isBookmarked?"btn-secondary":"btn-outline",'"\n              >\n                <i class="fas fa-bookmark"></i>\n                ').concat(this._isBookmarked?"Hapus Bookmark":"Tambah Bookmark",'\n              </button>\n              \n              <a href="#/bookmarks" class="btn btn-outline">\n                <i class="fas fa-bookmark"></i> Lihat Bookmark\n              </a>\n            </div>\n          </div>\n        </div>\n      '),this._attachBookmarkEventListeners(),!e.lat||!e.lon){t.next=13;break}return t.next=13,this._waitForMapContainer();case 13:t.next=19;break;case 15:t.prev=15,t.t0=t.catch(7),(0,o.cY)("Error rendering story detail:",t.t0),this.showErrorMessage(t.t0.message);case 19:case"end":return t.stop()}}),t,this,[[7,15]])}))),function(t){return a.apply(this,arguments)})},{key:"_waitForMapContainer",value:(i=fe(ce().mark((function t(){return ce().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){var e=function(){var r=document.getElementById("story-detail-map");r&&null!==r.offsetParent?t():setTimeout(e,50)};e()})));case 1:case"end":return t.stop()}}),t)}))),function(){return i.apply(this,arguments)})},{key:"_attachBookmarkEventListeners",value:function(){var t=this,e=document.getElementById("bookmark-toggle-btn"),r=document.getElementById("bookmark-text-btn");e&&e.addEventListener("click",function(){var e=fe(ce().mark((function e(r){return ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),e.next=3,t._handleBookmarkToggle();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),r&&r.addEventListener("click",function(){var e=fe(ce().mark((function e(r){return ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),e.next=3,t._handleBookmarkToggle();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},{key:"_handleBookmarkToggle",value:(n=fe(ce().mark((function t(){var e;return ce().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._story){t.next=3;break}return this._showNotification("Data cerita tidak tersedia","error"),t.abrupt("return");case 3:if(t.prev=3,this._setBookmarkButtonsLoading(!0),!this._isBookmarked){t.next=12;break}return t.next=8,this._bookmarkPresenter.removeBookmark(this._story.id);case 8:(e=t.sent).error||(this._isBookmarked=!1,this._updateBookmarkButtons(),this._showNotification("Cerita dihapus dari bookmark","success")),t.next=16;break;case 12:return t.next=14,this._bookmarkPresenter.addBookmark(this._story);case 14:(e=t.sent).error||(this._isBookmarked=!0,this._updateBookmarkButtons(),this._showNotification("Cerita ditambahkan ke bookmark","success"));case 16:e.error&&this._showNotification(e.message||"Terjadi kesalahan","error"),t.next=23;break;case 19:t.prev=19,t.t0=t.catch(3),(0,o.cY)("Error toggling bookmark:",t.t0),this._showNotification("Terjadi kesalahan saat mengubah bookmark","error");case 23:return t.prev=23,this._setBookmarkButtonsLoading(!1),t.finish(23);case 26:case"end":return t.stop()}}),t,this,[[3,19,23,26]])}))),function(){return n.apply(this,arguments)})},{key:"_setBookmarkButtonsLoading",value:function(t){var e=document.getElementById("bookmark-toggle-btn"),r=document.getElementById("bookmark-text-btn");e&&(e.disabled=t,e.innerHTML=t?'<i class="fas fa-spinner fa-spin"></i>':'<i class="fas fa-bookmark"></i>'),r&&(r.disabled=t,t&&(r.innerHTML='<i class="fas fa-spinner fa-spin"></i> Memproses...'))}},{key:"_updateBookmarkButtons",value:function(){var t=document.getElementById("bookmark-toggle-btn"),e=document.getElementById("bookmark-text-btn");t&&(t.className="btn btn-icon bookmark-btn ".concat(this._isBookmarked?"bookmarked":""),t.title=this._isBookmarked?"Hapus dari bookmark":"Tambah ke bookmark",t.innerHTML='<i class="fas fa-bookmark"></i>'),e&&(e.className="btn ".concat(this._isBookmarked?"btn-secondary":"btn-outline"),e.innerHTML='\n        <i class="fas fa-bookmark"></i>\n        '.concat(this._isBookmarked?"Hapus Bookmark":"Tambah Bookmark","\n      "))}},{key:"_showNotification",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",r=document.createElement("div");r.className="notification notification-".concat(e),r.innerHTML='\n      <div class="notification-content">\n        <i class="fas fa-'.concat("success"===e?"check-circle":"error"===e?"exclamation-circle":"info-circle",'"></i>\n        <span>').concat(t,"</span>\n      </div>\n    "),document.body.appendChild(r),setTimeout((function(){r.remove()}),3e3)}},{key:"showErrorMessage",value:function(t){var e=document.getElementById("story-detail-container");e&&(e.innerHTML='\n        <div class="alert alert-error">\n          <p><i class="fas fa-exclamation-triangle"></i> Terjadi kesalahan saat memuat detail cerita.</p>\n          <p>'.concat(t||"Kesalahan tidak diketahui",'</p>\n          <p><a href="#/" class="btn btn-primary"><i class="fas fa-home"></i> Kembali ke beranda</a></p>\n        </div>\n      '))}},{key:"initMap",value:(r=fe(ce().mark((function t(e,r,n){var i,a,s,u=this;return ce().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,document.getElementById("story-detail-map")){t.next=4;break}throw new Error("Map container not found");case 4:return t.next=6,(0,o.Q2)();case 6:if(s=t.sent){t.next=10;break}return this.handleMapError(new Error("Map tidak tersedia dalam mode offline")),t.abrupt("return");case 10:this._map&&(this._map.remove(),this._map=null),this._map=s.map("story-detail-map").setView([e,r],13),s.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(this._map),s.marker([e,r]).addTo(this._map).bindPopup("\n        <div>\n          <h3>".concat(n.name,"</h3>\n          <p>").concat(null===(i=n.description)||void 0===i?void 0:i.substring(0,50)).concat((null===(a=n.description)||void 0===a?void 0:a.length)>50?"...":"","</p>\n        </div>\n      ")).openPopup(),setTimeout((function(){u._map&&u._map.invalidateSize()}),100),t.next=21;break;case 18:t.prev=18,t.t0=t.catch(0),this.handleMapError(t.t0);case 21:case"end":return t.stop()}}),t,this,[[0,18]])}))),function(t,e,n){return r.apply(this,arguments)})},{key:"handleMapError",value:function(t){(0,o.cY)("Error initializing map:",t),this._mapError=!0;var e,r,n=document.getElementById("story-detail-map");n&&this._story&&(n.innerHTML='\n        <div class="alert alert-info" style="padding: 20px; text-align: center; background: #f0f8ff; border: 1px solid #add8e6; border-radius: 5px;">\n          <i class="fas fa-info-circle"></i>\n          <p><strong>Mode Offline</strong></p>\n          <p>Peta tidak tersedia saat offline.</p>\n          <p>Koordinat lokasi: <strong>'.concat(null===(e=this._story.lat)||void 0===e?void 0:e.toFixed(6),", ").concat(null===(r=this._story.lon)||void 0===r?void 0:r.toFixed(6),"</strong></p>\n        </div>\n      "))}}],e&&he(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,i,a,s,u}(),"/bookmarks":function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._bookmarkModel=new Vt,this._presenter=new oe({view:this,model:this._bookmarkModel})},e=[{key:"render",value:(a=be(me().mark((function t(){return me().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section id="content" class="container" tabindex="-1">\n        <div class="page-header">\n          <h1 class="page-title">\n            <i class="fas fa-bookmark"></i>\n            Bookmark Saya\n          </h1>\n          <p class="page-subtitle">Koleksi cerita yang telah Anda simpan</p>\n        </div>\n        \n        <div id="bookmark-container">\n          <div class="loading">\n            <div class="loading-spinner"></div>\n            <p>Memuat bookmark...</p>\n          </div>\n        </div>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return a.apply(this,arguments)})},{key:"afterRender",value:(i=be(me().mark((function t(){return me().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((0,o.x3)()){t.next=3;break}return window.location.hash="#/login",t.abrupt("return");case 3:return t.next=5,this._presenter.loadBookmarks();case 5:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"showLoading",value:function(){var t=document.getElementById("bookmark-container");t&&(t.innerHTML='\n        <div class="loading">\n          <div class="loading-spinner"></div>\n          <p>Memuat bookmark...</p>\n        </div>\n      ')}},{key:"hideLoading",value:function(){(0,o.cY)("Bookmark loading hidden")}},{key:"renderBookmarks",value:function(t){var e=this,r=document.getElementById("bookmark-container");if(r){var n=t.listStory||[];if(0!==n.length){var o=n.map((function(t){return'\n        <div class="story-card" data-story-id="'.concat(t.id,'">\n          <div class="story-image-container">\n            <img \n              src="').concat(t.photoUrl,'" \n              alt="Cerita dari ').concat(t.name,'" \n              class="story-image"\n              onerror="this.onerror=null; this.src=\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNk+A8AAQUBAScY42YAAAAASUVORK5CYII=\';"\n            >\n            <div class="story-actions">\n              <button \n                class="btn btn-icon bookmark-btn bookmarked" \n                data-story-id="').concat(t.id,'"\n                title="Hapus dari bookmark"\n              >\n                <i class="fas fa-bookmark"></i>\n              </button>\n            </div>\n          </div>\n          \n          <div class="story-content">\n            <h3 class="story-title">\n              <a href="#/story/').concat(t.id,'">Cerita dari ').concat(t.name,'</a>\n            </h3>\n            \n            <p class="story-description">\n              ').concat(t.description?t.description.length>100?t.description.substring(0,100)+"...":t.description:"Tidak ada deskripsi",'\n            </p>\n            \n            <div class="story-meta">\n              <span class="story-date">\n                <i class="far fa-calendar-alt"></i>\n                ').concat(e._formatDate(t.createdAt),"\n              </span>\n              \n              ").concat(t.bookmarkedAt?'\n                <span class="bookmark-date">\n                  <i class="fas fa-bookmark"></i>\n                  Disimpan '.concat(e._formatDate(t.bookmarkedAt),"\n                </span>\n              "):"","\n              \n              ").concat(t.lat&&t.lon?'\n                <span class="story-location">\n                  <i class="fas fa-map-marker-alt"></i>\n                  Lokasi tersedia\n                </span>\n              ':"",'\n            </div>\n            \n            <div class="story-actions-bottom">\n              <a href="#/story/').concat(t.id,'" class="btn btn-primary btn-sm">\n                <i class="far fa-eye"></i> Lihat Detail\n              </a>\n              <button \n                class="btn btn-secondary btn-sm remove-bookmark-btn" \n                data-story-id="').concat(t.id,'"\n                data-story-name="').concat(t.name,'"\n              >\n                <i class="fas fa-trash-alt"></i> Hapus\n              </button>\n            </div>\n          </div>\n        </div>\n      ')})).join("");r.innerHTML='\n      <div class="bookmarks-header">\n        <div class="bookmarks-count">\n          <i class="fas fa-bookmark"></i>\n          <span>'.concat(n.length,' cerita tersimpan</span>\n        </div>\n        \n        <div class="bookmarks-actions">\n          <button id="clear-all-bookmarks" class="btn btn-outline btn-sm">\n            <i class="fas fa-trash-alt"></i> Hapus Semua\n          </button>\n        </div>\n      </div>\n      \n      <div class="stories-grid">\n        ').concat(o,"\n      </div>\n    "),this._attachEventListeners()}else r.innerHTML='\n        <div class="empty-state">\n          <div class="empty-state-icon">\n            <i class="far fa-bookmark"></i>\n          </div>\n          <h3>Belum Ada Bookmark</h3>\n          <p>Anda belum menyimpan cerita apapun ke bookmark.</p>\n          <p>Mulai jelajahi cerita dan simpan yang menarik!</p>\n          <a href="#/" class="btn btn-primary">\n            <i class="fas fa-home"></i> Jelajahi Cerita\n          </a>\n        </div>\n      '}}},{key:"_attachEventListeners",value:function(){var t=this;document.querySelectorAll(".remove-bookmark-btn").forEach((function(e){e.addEventListener("click",function(){var r=be(me().mark((function r(n){var o,i;return me().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n.preventDefault(),o=e.dataset.storyId,i=e.dataset.storyName,r.next=5,t._handleRemoveBookmark(o,i);case 5:case"end":return r.stop()}}),r)})));return function(t){return r.apply(this,arguments)}}())})),document.querySelectorAll(".bookmark-btn").forEach((function(e){e.addEventListener("click",function(){var r=be(me().mark((function r(n){var o;return me().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n.preventDefault(),o=e.dataset.storyId,r.next=4,t._handleRemoveBookmark(o);case 4:case"end":return r.stop()}}),r)})));return function(t){return r.apply(this,arguments)}}())}));var e=document.getElementById("clear-all-bookmarks");e&&e.addEventListener("click",function(){var e=be(me().mark((function e(r){return me().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),e.next=3,t._handleClearAllBookmarks();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},{key:"_handleRemoveBookmark",value:(n=be(me().mark((function t(e){var r,n,i,a=arguments;return me().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=(r=a.length>1&&void 0!==a[1]?a[1]:"")?'Hapus "'.concat(r,'" dari bookmark?'):"Hapus cerita ini dari bookmark?",!confirm(n)){t.next=21;break}return t.prev=3,this.showLoading(),t.next=7,this._bookmarkModel.deleteBookmark(e);case 7:if((i=t.sent).error){t.next=14;break}return t.next=11,this._presenter.loadBookmarks();case 11:this._showNotification("Bookmark berhasil dihapus","success"),t.next=15;break;case 14:this._showNotification(i.message||"Gagal menghapus bookmark","error");case 15:t.next=21;break;case 17:t.prev=17,t.t0=t.catch(3),(0,o.cY)("Error removing bookmark:",t.t0),this._showNotification("Terjadi kesalahan saat menghapus bookmark","error");case 21:case"end":return t.stop()}}),t,this,[[3,17]])}))),function(t){return n.apply(this,arguments)})},{key:"_handleClearAllBookmarks",value:(r=be(me().mark((function t(){var e,r,n,i;return me().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!confirm("Hapus semua bookmark? Tindakan ini tidak dapat dibatalkan.")){t.next=33;break}return t.prev=1,this.showLoading(),t.next=5,this._bookmarkModel.getAllBookmarks();case 5:if(!((e=t.sent).listStory&&e.listStory.length>0)){t.next=27;break}r=ve(e.listStory),t.prev=8,r.s();case 10:if((n=r.n()).done){t.next=16;break}return i=n.value,t.next=14,this._bookmarkModel.deleteBookmark(i.id);case 14:t.next=10;break;case 16:t.next=21;break;case 18:t.prev=18,t.t0=t.catch(8),r.e(t.t0);case 21:return t.prev=21,r.f(),t.finish(21);case 24:return t.next=26,this._presenter.loadBookmarks();case 26:this._showNotification("Semua bookmark berhasil dihapus","success");case 27:t.next=33;break;case 29:t.prev=29,t.t1=t.catch(1),(0,o.cY)("Error clearing all bookmarks:",t.t1),this._showNotification("Terjadi kesalahan saat menghapus bookmark","error");case 33:case"end":return t.stop()}}),t,this,[[1,29],[8,18,21,24]])}))),function(){return r.apply(this,arguments)})},{key:"_showNotification",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",r=document.createElement("div");r.className="notification notification-".concat(e),r.innerHTML='\n      <div class="notification-content">\n        <i class="fas fa-'.concat("success"===e?"check-circle":"error"===e?"exclamation-circle":"info-circle",'"></i>\n        <span>').concat(t,"</span>\n      </div>\n    "),document.body.appendChild(r),setTimeout((function(){r.remove()}),3e3)}},{key:"_formatDate",value:function(t){try{var e=new Date(t),r=new Date,n=Math.abs(r-e),i=Math.ceil(n/864e5);return 1===i?"Hari ini":2===i?"Kemarin":i<=7?"".concat(i-1," hari lalu"):e.toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric"})}catch(t){return(0,o.cY)("Error formatting date:",t),"Tanggal tidak valid"}}},{key:"showErrorMessage",value:function(t){var e=this,r=document.getElementById("bookmark-container");if(r){r.innerHTML='\n        <div class="alert alert-error">\n          <p><i class="fas fa-exclamation-triangle"></i> Terjadi kesalahan saat memuat bookmark.</p>\n          <p>'.concat(t||"Kesalahan tidak diketahui",'</p>\n          <div style="margin-top: 15px;">\n            <button id="retry-load-bookmarks" class="btn btn-primary btn-sm">\n              <i class="fas fa-redo"></i> Coba Lagi\n            </button>\n            <a href="#/" class="btn btn-secondary btn-sm">\n              <i class="fas fa-home"></i> Kembali ke Beranda\n            </a>\n          </div>\n        </div>\n      ');var n=document.getElementById("retry-load-bookmarks");n&&n.addEventListener("click",be(me().mark((function t(){return me().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._presenter.loadBookmarks();case 2:case"end":return t.stop()}}),t)}))))}}}],e&&we(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,i,a}(),"/404":function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._currentPath=window.location.hash.replace("#","")||"/"},e=[{key:"render",value:(n=Se(xe().mark((function t(){return xe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section id="content" class="container" tabindex="-1">\n        <div class="not-found-page">\n          <div class="not-found-content">\n            <div class="not-found-icon">\n              <i class="fas fa-search"></i>\n              <span class="not-found-number">404</span>\n            </div>\n            \n            <h1 class="not-found-title">Halaman Tidak Ditemukan</h1>\n            \n            <p class="not-found-description">\n              Maaf, halaman yang Anda cari tidak dapat ditemukan atau mungkin telah dipindahkan.\n            </p>\n            \n            <div class="not-found-path">\n              <p>Path yang diminta: <code>'.concat(this._currentPath,'</code></p>\n            </div>\n            \n            <div class="not-found-actions">\n              <a href="#/" class="btn btn-primary">\n                <i class="fas fa-home"></i> Kembali ke Beranda\n              </a>\n              \n              <button id="go-back-btn" class="btn btn-secondary">\n                <i class="fas fa-arrow-left"></i> Halaman Sebelumnya\n              </button>\n              \n              <a href="#/about" class="btn btn-outline">\n                <i class="fas fa-info-circle"></i> Tentang Aplikasi\n              </a>\n            </div>\n            \n            <div class="not-found-suggestions">\n              <h3>Mungkin Anda mencari:</h3>\n              <ul class="suggestions-list">\n                <li><a href="#/"><i class="fas fa-home"></i> Halaman Beranda</a></li>\n                <li><a href="#/add"><i class="fas fa-plus-circle"></i> Tambah Cerita Baru</a></li>\n                <li><a href="#/bookmarks"><i class="fas fa-bookmark"></i> Bookmark Saya</a></li>\n                <li><a href="#/about"><i class="fas fa-info-circle"></i> Tentang Aplikasi</a></li>\n              </ul>\n            </div>\n          </div>\n        </div>\n      </section>\n    '));case 1:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:(r=Se(xe().mark((function t(){return xe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._attachEventListeners();case 1:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"_attachEventListeners",value:function(){var t=document.getElementById("go-back-btn");t&&t.addEventListener("click",(function(t){t.preventDefault(),window.history.length>1?window.history.back():window.location.hash="#/"}))}},{key:"cleanup",value:function(){var t=document.getElementById("go-back-btn");t&&t.removeEventListener("click",this._handleGoBack)}}],e&&Oe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}()};function Pe(t){return Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pe(t)}function Te(){Te=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=k(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==Pe(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Pe(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function Be(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function Ie(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Be(i,n,o,a,s,"next",t)}function s(t){Be(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Le(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Me(n.key),n)}}function Me(t){var e=function(t){if("object"!=Pe(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Pe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Pe(e)?e:e+""}function Ne(t,e,r){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,r)}function Ge(t,e){return t.get(Ce(t,e))}function Fe(t,e,r){return t.set(Ce(t,e),r),r}function Ce(t,e,r){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ye=new WeakMap,De=new WeakMap,He=new WeakMap,Re=new WeakMap,We=new WeakMap,Ve=new WeakMap,Ue=new WeakMap;const Qe=function(){return t=function t(e){var r,n,o=e.navigationDrawer,i=e.drawerButton,a=e.content,s=e.authMenu;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Ne(this,Ye,null),Ne(this,De,null),Ne(this,He,null),Ne(this,Re,null),Ne(this,We,null),Ne(this,Ve,null),Ne(this,Ue,null),r=this,(n=Me(n="currentPage"))in r?Object.defineProperty(r,n,{value:null,enumerable:!0,configurable:!0,writable:!0}):r[n]=null,Fe(Ye,this,a),Fe(De,this,i),Fe(He,this,o),Fe(Re,this,s),Fe(We,this,document.getElementById("drawer-overlay")),Fe(Ve,this,document.querySelector("header .main-header")),Fe(Ue,this,document.querySelector("footer")),this._checkBrowserCompatibility(),this._setupDrawer(),this._updateAuthMenu(),this._initSkipToContent()},e=[{key:"_checkBrowserCompatibility",value:function(){var t=(0,o.o7)();if((0,o.cY)("Browser support check:",t),!t.fullSupport&&(console.warn("Browser tidak mendukung fitur:",t.unsupported),t.unsupported.includes("camera")||t.unsupported.includes("localStorage"))){var e,r='\n          <div class="alert alert-warning" style="position: fixed; top: 0; left: 0; right: 0; z-index: 10000; text-align: center; padding: 10px;">\n            Browser Anda tidak mendukung fitur: '.concat(t.unsupported.join(", "),'.\n            Beberapa fitur aplikasi mungkin tidak berfungsi dengan baik.\n            <button id="dismiss-warning" style="margin-left: 10px; padding: 2px 8px;">Tutup</button>\n          </div>\n        '),n=document.createElement("div");n.innerHTML=r,document.body.insertBefore(n,document.body.firstChild),null===(e=document.getElementById("dismiss-warning"))||void 0===e||e.addEventListener("click",(function(){n.remove()}))}}},{key:"_setupDrawer",value:function(){var t=this;try{Ge(De,this).addEventListener("click",(function(e){e.stopPropagation(),t._toggleDrawer()})),Ge(We,this)&&Ge(We,this).addEventListener("click",(function(){t._closeDrawer()}));var e=document.querySelector(".brand-name");e&&e.addEventListener("click",(function(e){Ge(He,t).classList.contains("open")&&(e.preventDefault(),t._closeDrawer())})),document.body.addEventListener("click",(function(e){Ge(He,t).contains(e.target)||Ge(De,t).contains(e.target)||e.target.closest(".header-left")||t._closeDrawer(),Ge(He,t).querySelectorAll("a").forEach((function(r){r.contains(e.target)&&t._closeDrawer()}))})),document.addEventListener("keydown",(function(e){"Escape"===e.key&&Ge(He,t).classList.contains("open")&&t._closeDrawer()}))}catch(t){(0,o.cY)("Error setting up drawer:",t)}}},{key:"_toggleDrawer",value:function(){Ge(He,this).classList.contains("open")?this._closeDrawer():this._openDrawer()}},{key:"_openDrawer",value:function(){Ge(He,this).classList.add("open"),Ge(We,this)&&Ge(We,this).classList.add("open"),Ge(Ve,this)&&Ge(Ve,this).classList.add("drawer-open"),Ge(Ye,this)&&Ge(Ye,this).classList.add("drawer-open"),Ge(Ue,this)&&Ge(Ue,this).classList.add("drawer-open"),document.body.style.overflow="hidden"}},{key:"_closeDrawer",value:function(){Ge(He,this).classList.remove("open"),Ge(We,this)&&Ge(We,this).classList.remove("open"),Ge(Ve,this)&&Ge(Ve,this).classList.remove("drawer-open"),Ge(Ye,this)&&Ge(Ye,this).classList.remove("drawer-open"),Ge(Ue,this)&&Ge(Ue,this).classList.remove("drawer-open"),document.body.style.overflow=""}},{key:"_updateAuthMenu",value:function(){try{var t=document.getElementById("bookmark-menu");if((0,o.x3)()){Ge(Re,this).innerHTML='\n          <a href="#" id="logout-button"><i class="fas fa-sign-out-alt"></i> Logout</a>\n        ',t&&(t.style.display="list-item");var e=document.getElementById("logout-button");e&&e.addEventListener("click",(function(t){t.preventDefault(),alert("Anda berhasil logout"),(0,o.f$)(),window.location="#/login",setTimeout((function(){window.location.reload(!0)}),100)}))}else{Ge(Re,this).innerHTML='<a href="#/login"><i class="fas fa-sign-in-alt"></i> Login</a>',t&&(t.style.display="none");var r=window.location.hash.replace("#","");["/","/add","/story","/bookmarks"].some((function(t){return r===t||r.startsWith(t+"/")}))&&(window.location="#/login")}}catch(t){console.error("Error updating auth menu:",t),Ge(Re,this).innerHTML='<a href="#/login"><i class="fas fa-sign-in-alt"></i> Login</a>';var n=document.getElementById("bookmark-menu");n&&(n.style.display="none")}}},{key:"_initSkipToContent",value:function(){try{var t=document.querySelector(".skip-link");t&&t.addEventListener("click",(function(t){t.preventDefault();var e=document.querySelector("#content");e&&(e.setAttribute("tabindex","-1"),e.focus(),e.scrollIntoView())}))}catch(t){console.error("Error initializing skip to content:",t)}}},{key:"renderPage",value:(n=Ie(Te().mark((function t(){var e=this;return Te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!document.startViewTransition){t.next=6;break}return t.next=4,document.startViewTransition(Ie(Te().mark((function t(){return Te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._renderContent();case 2:case"end":return t.stop()}}),t)})))).finished;case 4:t.next=8;break;case 6:return t.next=8,this._renderContent();case 8:this._updateAuthMenu(),this._initSkipToContent(),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(0),(0,o.cY)("Error during page rendering:",t.t0),Ge(Ye,this).innerHTML='\n        <div class="container">\n          <h2 class="page-title">Terjadi Kesalahan</h2>\n          <p>Maaf, terjadi kesalahan saat memuat halaman.</p>\n          <p>'.concat(t.t0.message||"Kesalahan tidak diketahui",'</p>\n          <p><a href="#/">Kembali ke beranda</a></p>\n        </div>\n      ');case 16:case"end":return t.stop()}}),t,this,[[0,12]])}))),function(){return n.apply(this,arguments)})},{key:"_renderContent",value:(r=Ie(Te().mark((function t(){var e,r,n;return Te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,void 0,i=se(),e="/bookmarks"===i?"/bookmarks":ae(ie(i)),r=je[e]){t.next=8;break}if(r=je["/404"]){t.next=8;break}return Ge(Ye,this).innerHTML='\n            <div id="content" class="container" tabindex="-1">\n              <h2 class="page-title">Halaman Tidak Ditemukan</h2>\n              <p>Halaman yang Anda cari tidak tersedia.</p>\n              <p><a href="#/">Kembali ke beranda</a></p>\n            </div>\n          ',t.abrupt("return");case 8:if(Ge(Ye,this).innerHTML='\n        <div class="container">\n          <div class="loading">\n            <div class="loading-spinner"></div>\n          </div>\n        </div>\n      ',this.currentPage&&"function"==typeof this.currentPage.cleanup)try{this.currentPage.cleanup()}catch(t){console.error("Error cleaning up previous page:",t)}return this.currentPage=new r,t.next=13,this.currentPage.render();case 13:return(n=t.sent).includes('id="content"')?Ge(Ye,this).innerHTML=n:Ge(Ye,this).innerHTML=n.replace('<section class="container"','<section id="content" class="container" tabindex="-1"'),t.next=17,this.currentPage.afterRender();case 17:t.next=23;break;case 19:throw t.prev=19,t.t0=t.catch(0),(0,o.cY)("Error in _renderContent:",t.t0),t.t0;case 23:case"end":return t.stop()}var i}),t,this,[[0,19]])}))),function(){return r.apply(this,arguments)})},{key:"cleanup",value:function(){if(this.currentPage&&"function"==typeof this.currentPage.cleanup)try{this.currentPage.cleanup(),this.currentPage=null}catch(t){console.error("Error during app cleanup:",t)}this._closeDrawer(),console.log("App resources cleaned up")}}],e&&Le(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function Ke(t){return Ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ke(t)}function ze(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=qe(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function Xe(t){return function(t){if(Array.isArray(t))return Je(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||qe(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qe(t,e){if(t){if("string"==typeof t)return Je(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Je(t,e):void 0}}function Je(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Ze(){Ze=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=k(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==Ke(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Ke(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function $e(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function tr(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){$e(i,n,o,a,s,"next",t)}function s(t){$e(i,n,o,a,s,"throw",t)}a(void 0)}))}}function er(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,rr(n.key),n)}}function rr(t){var e=function(t){if("object"!=Ke(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Ke(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ke(e)?e:e+""}var nr=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.isOnline=navigator.onLine,this.offlineQueue=[],this.setupEventListeners()},e=[{key:"setupEventListeners",value:function(){var t=this;window.addEventListener("online",(function(){t.isOnline=!0,t.showOnlineNotification(),t.syncOfflineData()})),window.addEventListener("offline",(function(){t.isOnline=!1,t.showOfflineNotification()}))}},{key:"showOfflineNotification",value:function(){var t=document.createElement("div");t.id="offline-notification",t.className="offline-notification",t.innerHTML='\n      <div class="notification-content">\n        <i class="fas fa-wifi-slash"></i>\n        <span>Mode Offline - Fitur terbatas tersedia</span>\n        <button onclick="this.parentElement.parentElement.remove()">×</button>\n      </div>\n    ';var e=document.getElementById("offline-notification");e&&e.remove(),document.body.appendChild(t),setTimeout((function(){t.parentElement&&t.remove()}),5e3)}},{key:"showOnlineNotification",value:function(){var t=document.createElement("div");t.className="online-notification",t.innerHTML='\n      <div class="notification-content">\n        <i class="fas fa-wifi"></i>\n        <span>Kembali Online - Menyinkronkan data...</span>\n      </div>\n    ',document.body.appendChild(t),setTimeout((function(){t.parentElement&&t.remove()}),3e3)}},{key:"handleOfflineForm",value:(o=tr(Ze().mark((function t(e){return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isOnline){t.next=2;break}return t.abrupt("return",this.submitForm(e));case 2:if(this.offlineQueue.push({type:"form",data:e,timestamp:Date.now()}),!("serviceWorker"in navigator)){t.next=8;break}return t.next=6,navigator.serviceWorker.ready;case 6:t.sent.active.postMessage({type:"STORE_OFFLINE_FORM",payload:e});case 8:return this.showOfflineFormNotification(),t.abrupt("return",{success:!0,offline:!0});case 10:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"showOfflineFormNotification",value:function(){var t=document.createElement("div");t.className="offline-form-notification",t.innerHTML='\n      <div class="notification-content">\n        <i class="fas fa-cloud-upload-alt"></i>\n        <span>Data disimpan offline - akan dikirim saat online</span>\n      </div>\n    ',document.body.appendChild(t),setTimeout((function(){t.parentElement&&t.remove()}),4e3)}},{key:"syncOfflineData",value:(n=tr(Ze().mark((function t(){var e,r,n,o;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.isOnline&&0!==this.offlineQueue.length){t.next=2;break}return t.abrupt("return");case 2:e=Xe(this.offlineQueue),this.offlineQueue=[],r=ze(e),t.prev=5,r.s();case 7:if((n=r.n()).done){t.next=21;break}return o=n.value,t.prev=9,t.next=12,this.submitForm(o.data);case 12:console.log("Synced offline item:",o.data),t.next=19;break;case 15:t.prev=15,t.t0=t.catch(9),console.error("Failed to sync offline item:",t.t0),this.offlineQueue.push(o);case 19:t.next=7;break;case 21:t.next=26;break;case 23:t.prev=23,t.t1=t.catch(5),r.e(t.t1);case 26:return t.prev=26,r.f(),t.finish(26);case 29:case"end":return t.stop()}}),t,this,[[5,23,26,29],[9,15]])}))),function(){return n.apply(this,arguments)})},{key:"submitForm",value:(r=tr(Ze().mark((function t(e){var r;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/api/stories",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e.token)},body:JSON.stringify(e)});case 2:if((r=t.sent).ok){t.next=5;break}throw new Error("HTTP error! status: ".concat(r.status));case 5:return t.abrupt("return",r.json());case 6:case"end":return t.stop()}}),t)}))),function(t){return r.apply(this,arguments)})},{key:"getOfflineStories",value:function(){return[{id:"offline-1",name:"Offline Story",description:"This story is available offline. You can view cached stories when offline.",photoUrl:"/favicon-192.png",createdAt:(new Date).toISOString(),lat:null,lon:null}]}},{key:"isOffline",value:function(){return!this.isOnline}}],e&&er(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o}();function or(t){return or="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},or(t)}function ir(){ir=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=k(s,n);if(u){if(u===f)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f={};function h(){}function p(){}function d(){}var v={};u(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==r&&n.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==or(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(or(e)+" is not iterable")}return p.prototype=d,u(g,"constructor",d),u(d,"constructor",p),p.displayName=u(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function ar(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function sr(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){ar(i,n,o,a,s,"next",t)}function s(t){ar(i,n,o,a,s,"throw",t)}a(void 0)}))}}var ur=null,cr=null,lr=window.location.pathname.includes("/Web-Intermediate1/")?"/Web-Intermediate1":"";function fr(){var t=document.getElementById("notification-toggle-btn"),e=(0,o.gL)();t&&(e&&e.token?t.style.display="block":t.style.display="none")}document.addEventListener("DOMContentLoaded",sr(ir().mark((function t(){var e;return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return document.startViewTransition||console.warn("Browser Anda tidak mendukung View Transitions API. Transisi halaman mungkin kurang smooth."),ur&&(ur.cleanup(),ur=null),(ur=new Qe({content:document.querySelector("#main-content"),drawerButton:document.querySelector("#drawer-button"),navigationDrawer:document.querySelector("#navigation-drawer"),authMenu:document.querySelector("#auth-menu")})).cleanup||(ur.cleanup=function(){this.currentPage&&"function"==typeof this.currentPage.cleanup&&this.currentPage.cleanup(),console.log("App instance cleaned up")}),t.next=6,ur.renderPage();case 6:if(window._hashChangeHandler&&window.removeEventListener("hashchange",window._hashChangeHandler),window._hashChangeHandler=sr(ir().mark((function t(){return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!ur._isRendering){t.next=3;break}return console.log("Render sedang berjalan, abaikan hashchange event"),t.abrupt("return");case 3:return ur._isRendering=!0,t.prev=4,t.next=7,ur.renderPage();case 7:fr(),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(4),console.error("Error rendering page:",t.t0);case 13:return t.prev=13,ur._isRendering=!1,t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[4,10,13,16]])}))),window.addEventListener("hashchange",window._hashChangeHandler),!("serviceWorker"in navigator)){t.next=23;break}return t.prev=10,t.next=13,navigator.serviceWorker.register("".concat(lr,"/service-worker-enhanced.js"),{scope:"".concat(lr,"/"),updateViaCache:"none"});case 13:e=t.sent,console.log("Enhanced service worker registered successfully with scope:",e.scope),e.update(),setInterval((function(){e.update(),console.log("Checking for service worker updates...")}),36e5),(0,o.MU)(),fr(),window.addEventListener("hashchange",fr),setInterval(fr,1e3),t.next=23;break;case 20:t.prev=20,t.t0=t.catch(10),console.error("Service worker registration failed:",t.t0);case 23:r=void 0,(r=document.createElement("style")).textContent="\n    .offline-notification,\n    .online-notification,\n    .offline-form-notification {\n      position: fixed;\n      top: 20px;\n      right: 20px;\n      z-index: 10000;\n      background: #333;\n      color: white;\n      padding: 12px 16px;\n      border-radius: 8px;\n      box-shadow: 0 4px 12px rgba(0,0,0,0.3);\n      max-width: 350px;\n      animation: slideIn 0.3s ease-out;\n    }\n\n    .offline-notification {\n      background: #f44336;\n    }\n\n    .online-notification {\n      background: #4caf50;\n    }\n\n    .offline-form-notification {\n      background: #ff9800;\n    }\n\n    .notification-content {\n      display: flex;\n      align-items: center;\n      gap: 10px;\n    }\n\n    .notification-content i {\n      font-size: 18px;\n    }\n\n    .notification-content button {\n      background: none;\n      border: none;\n      color: white;\n      font-size: 20px;\n      cursor: pointer;\n      margin-left: auto;\n      padding: 0;\n      width: 24px;\n      height: 24px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    }\n\n    @keyframes slideIn {\n      from {\n        transform: translateX(100%);\n        opacity: 0;\n      }\n      to {\n        transform: translateX(0);\n        opacity: 1;\n      }\n    }\n  ",document.head.appendChild(r),cr=new nr,window.offlineManager=cr,console.log("✅ Offline Manager initialized"),window.addEventListener("beforeunload",(function(){ur&&ur.cleanup()}));case 27:case"end":return t.stop()}var r}),t,null,[[10,20]])}))))})();