/*! For license information please see app.bundle.js.LICENSE.txt */
(()=>{"use strict";const t="https://story-api.dicoding.dev/v1",e="id-ID",r=!0;function n(){n=function(){return e};var t,e={},r=Object.prototype,i=r.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},u=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function l(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function h(e,r,n,o){var i=r&&r.prototype instanceof d?r:d,a=Object.create(i.prototype);return l(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=x(u,n);if(s){if(s===p)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===p)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new j(o||[])),!0),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var p={};function d(){}function y(){}function v(){}var m={};l(m,u,(function(){return this}));var g=Object.getPrototypeOf,w=g&&g(g(A([])));w&&w!==r&&i.call(w,u)&&(m=w);var b=v.prototype=d.prototype=Object.create(m);function k(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(n,a,u,s){var c=f(t[n],t,a);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==o(h)&&i.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,u,s)}),(function(t){r("throw",t,u,s)})):e.resolve(h).then((function(t){l.value=t,u(l)}),(function(t){return r("throw",t,u,s)}))}s(c.arg)}var n;l(this,"_invoke",(function(t,o){function i(){return new e((function(e,n){r(t,o,e,n)}))}return n=n?n.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var i=f(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,p;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,p):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function _(t){this.tryEntries.push(t)}function S(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function j(t){this.tryEntries=[[-1]],t.forEach(_,this),this.reset(!0)}function A(e){if(null!=e){var r=e[u];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,a=function r(){for(;++n<e.length;)if(i.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(o(e)+" is not iterable")}return y.prototype=v,l(b,"constructor",v),l(v,"constructor",y),y.displayName=l(v,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,l(t,c,"GeneratorFunction")),t.prototype=Object.create(b),t},e.awrap=function(t){return{__await:t}},k(E.prototype),l(E.prototype,s,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(h(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},k(b),l(b,c,"Generator"),l(b,u,(function(){return this})),l(b,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=A,j.prototype={constructor:j,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(S),!e)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=t,n(s),!0;if(u<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],p):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),S(r),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;S(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:A(e),r,n},"next"===this.method&&(this.arg=t),p}},e}function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function i(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function a(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function u(t){i(a,n,o,u,s,"next",t)}function s(t){i(a,n,o,u,s,"throw",t)}u(void 0)}))}}function u(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return s(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function c(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function l(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?c(Object(r),!0).forEach((function(e){h(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function h(t,e,r){return(e=function(t){var e=function(t){if("object"!=o(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==o(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function f(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Date(t).toLocaleDateString(r,l({year:"numeric",month:"long",day:"numeric"},n))}function p(){try{var t=JSON.parse(localStorage.getItem("userData")||"null");return t&&t.expiry&&t.expiry<Date.now()?(v(),null):t}catch(t){return k("Error parsing user data from localStorage:",t),null}}function d(){var t=p();return null!==t&&void 0!==t.token}function y(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{if(e){var r=new Date;r.setDate(r.getDate()+30);var n=l(l({},t),{},{expiry:r.getTime()});localStorage.setItem("userData",JSON.stringify(n))}else localStorage.setItem("userData",JSON.stringify(t))}catch(t){k("Error saving user data to localStorage:",t)}}function v(){try{localStorage.removeItem("userData"),window.location.hash="#/login"}catch(t){k("Error clearing user data from localStorage:",t)}}function m(){return new Promise((function(t,e){window.L?t(window.L):fetch("https://unpkg.com/leaflet@1.9.4/dist/leaflet.css",{method:"HEAD",mode:"no-cors",cache:"no-cache"}).then((function(){var r=document.createElement("link");r.rel="stylesheet",r.href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css",document.head.appendChild(r);var n=document.createElement("script");n.src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js",n.onload=function(){k("Leaflet script loaded successfully"),t(window.L)},n.onerror=function(t){k("Failed to load Leaflet script:",t),e(new Error("Failed to load map library. Please check your internet connection."))},document.head.appendChild(n)})).catch((function(t){k("Failed to fetch Leaflet CSS:",t),e(new Error("Failed to load map resources. Please check your internet connection."))}))}))}function g(t){return new Promise((function(e,r){navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({video:{width:{ideal:1280,max:1920},height:{ideal:720,max:1080},facingMode:"environment"}}).then((function(n){t.srcObject=n,t.onloadedmetadata=function(){t.play().then((function(){e(n)})).catch((function(t){k("Error playing video:",t),r(new Error("Gagal memulai kamera: "+t.message))}))},t.onerror=function(t){k("Video element error:",t),r(new Error("Terjadi kesalahan pada elemen video: "+t.message))}})).catch((function(t){k("getUserMedia error:",t);var e="Gagal mengakses kamera: ";switch(t.name){case"NotAllowedError":e+="Izin kamera ditolak. Harap berikan izin kamera di pengaturan browser Anda.";break;case"NotFoundError":e+="Tidak ada kamera yang ditemukan pada perangkat Anda.";break;case"NotReadableError":e+="Kamera sedang digunakan oleh aplikasi lain.";break;case"OverconstrainedError":e+="Kamera tidak mendukung kualitas yang diminta.";break;case"AbortError":e+="Akses kamera dibatalkan.";break;default:e+=t.message||"Error tidak diketahui."}r(new Error(e))})):r(new Error("Browser Anda tidak mendukung penggunaan kamera. Coba gunakan browser modern seperti Chrome, Firefox, atau Edge terbaru."))}))}function w(t,e){var r=e,n=r.getContext("2d");try{return r.width=t.videoWidth,r.height=t.videoHeight,n.drawImage(t,0,0,r.width,r.height),new Promise((function(t,e){r.toBlob((function(r){r?t(r):e(new Error("Gagal mengambil gambar. Silakan coba lagi."))}),"image/jpeg",.8)}))}catch(t){return k("Error capturing image:",t),Promise.reject(new Error("Gagal mengambil gambar: "+t.message))}}function b(t){if(t)try{t.getTracks().forEach((function(t){t.stop()})),k("Camera stopped successfully")}catch(t){k("Error stopping camera:",t)}}function k(){if(r){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];(t=console).log.apply(t,["[DEBUG]"].concat(n))}}function E(t,e){alert("".concat(t,": ").concat(e))}function x(t){return new Promise((function(e,r){if(t&&t.type.match("image.*")){var n=new FileReader;n.onload=function(n){var o=new Image;o.onload=function(){var n=document.createElement("canvas"),i=o.width,a=o.height,u=1600;(i>u||a>u)&&(i>a?(a=Math.round(a*(u/i)),i=u):(i=Math.round(i*(u/a)),a=u)),n.width=i,n.height=a,n.getContext("2d").drawImage(o,0,0,i,a),n.toBlob((function(n){n?(n.name=t.name||"photo.jpg",e(n)):r(new Error("Gagal memproses gambar"))}),"image/jpeg",.85)},o.onerror=function(){r(new Error("Gagal memuat gambar"))},o.src=n.target.result},n.onerror=function(){r(new Error("Gagal membaca file gambar"))},n.readAsDataURL(t)}else r(new Error("File harus berupa gambar (jpg, png, gif, dll)"))}))}function _(){try{var t=p();if(!t||!t.token)throw new Error("Token tidak tersedia");return{Authorization:"Bearer ".concat(t.token)}}catch(t){throw k("Error mendapatkan header otorisasi:",t),t}}function S(t){for(var e=(t+"=".repeat((4-t.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),r=window.atob(e),n=new Uint8Array(r.length),o=0;o<r.length;++o)n[o]=r.charCodeAt(o);return n}function j(){return A.apply(this,arguments)}function A(){return(A=a(n().mark((function t(){var e;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("Notification"in window){t.next=2;break}throw new Error("Browser tidak mendukung notifikasi");case 2:if("granted"!==Notification.permission){t.next=4;break}return t.abrupt("return",!0);case 4:if("denied"===Notification.permission){t.next=9;break}return t.next=7,Notification.requestPermission();case 7:return e=t.sent,t.abrupt("return","granted"===e);case 9:return t.abrupt("return",!1);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function O(t){return P.apply(this,arguments)}function P(){return(P=a(n().mark((function t(e){var r,o;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r={userVisibleOnly:!0,applicationServerKey:S("BCCs2eonMI-6H2ctvFaWg-UYdDv387Vno_bzUzALpB442r2lCnsHmtrx8biyPi_E-1fSGABK_Qs_GlvPoJJqxbk")},t.next=3,e.pushManager.subscribe(r);case 3:return o=t.sent,t.abrupt("return",o);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function T(t){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T(t)}function I(){I=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return s(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=k(u,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function p(){}function d(){}var y={};s(y,i,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(S([])));m&&m!==r&&n.call(m,i)&&(y=m);var g=d.prototype=f.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,h=c.value;return h&&"object"==T(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var o;s(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(T(e)+" is not iterable")}return p.prototype=d,s(g,"constructor",d),s(d,"constructor",p),p.displayName=s(d,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),s(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),s(g,u,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=t,n(s),!0;if(u<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function B(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function M(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){B(i,n,o,a,u,"next",t)}function u(t){B(i,n,o,a,u,"throw",t)}a(void 0)}))}}var G=function(){var e=M(I().mark((function e(r){var n,o;return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(t,"/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});case 3:return n=e.sent,e.next=6,n.json();case 6:return o=e.sent,e.abrupt("return",o);case 10:return e.prev=10,e.t0=e.catch(0),console.error("Error pada login:",e.t0),e.abrupt("return",{error:!0,message:"Tidak dapat terhubung ke server. Periksa koneksi internet Anda."});case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=M(I().mark((function e(r){var n,o;return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(t,"/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});case 3:return n=e.sent,e.next=6,n.json();case 6:return o=e.sent,e.abrupt("return",o);case 10:return e.prev=10,e.t0=e.catch(0),console.error("Error pada register:",e.t0),e.abrupt("return",{error:!0,message:"Tidak dapat terhubung ke server. Periksa koneksi internet Anda."});case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=M(I().mark((function e(){var r,n,o,i,a,u,s,c,l,h,f,p=arguments;return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(r=p.length>0&&void 0!==p[0]?p[0]:{}).page,o=void 0===n?1:n,i=r.size,a=void 0===i?10:i,u=r.location,s=void 0===u?0:u,e.prev=1,c="".concat(t,"/stories?page=").concat(o,"&size=").concat(a),s&&(c+="&location=1"),l=_(),e.next=7,fetch(c,{headers:l});case 7:return h=e.sent,e.next=10,h.json();case 10:if(!(f=e.sent).error){e.next=13;break}throw new Error(f.message);case 13:return e.abrupt("return",f);case 16:if(e.prev=16,e.t0=e.catch(1),console.error("Error mendapatkan cerita:",e.t0),!(e.t0 instanceof TypeError&&e.t0.message.includes("Failed to fetch"))){e.next=21;break}return e.abrupt("return",{error:!0,message:"Tidak dapat terhubung ke server. Periksa koneksi internet Anda."});case 21:return e.abrupt("return",{error:!0,message:e.t0.message||"Terjadi kesalahan saat memuat cerita. Periksa koneksi internet Anda."});case 22:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(){return e.apply(this,arguments)}}(),N=function(){var e=M(I().mark((function e(r){var n,o,i;return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=_(),e.next=4,fetch("".concat(t,"/stories/").concat(r),{headers:n});case 4:return o=e.sent,e.next=7,o.json();case 7:return i=e.sent,e.abrupt("return",i);case 11:return e.prev=11,e.t0=e.catch(0),console.error("Error mendapatkan detail cerita:",e.t0),e.abrupt("return",{error:!0,message:"Terjadi kesalahan saat memuat detail cerita."});case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}(),D=function(){var e=M(I().mark((function e(r){var n,o,i,a;return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,(n=p())&&n.token){e.next=4;break}throw new Error("Token tidak tersedia. Silakan login terlebih dahulu.");case 4:if(console.log("Mengirim cerita dengan data:"),console.log("- Description tersedia:",r.has("description")),console.log("- Photo tersedia:",r.has("photo")),console.log("- Lokasi tersedia:",r.has("lat")&&r.has("lon")),o={Authorization:"Bearer ".concat(n.token)},r.has("description")){e.next=11;break}throw new Error("Deskripsi cerita tidak boleh kosong");case 11:if(r.has("photo")){e.next=13;break}throw new Error("Foto tidak boleh kosong");case 13:return e.next=15,fetch("".concat(t,"/stories"),{method:"POST",headers:o,body:r});case 15:if((i=e.sent).ok){e.next=31;break}if(401!==i.status){e.next=21;break}throw new Error("Sesi telah berakhir. Silakan login kembali.");case 21:if(413!==i.status){e.next=25;break}throw new Error("Ukuran foto terlalu besar. Maksimal 1MB.");case 25:if(400!==i.status){e.next=29;break}throw new Error("Data yang dikirim tidak valid. Pastikan format data sudah benar.");case 29:if(500!==i.status){e.next=31;break}throw new Error("Terjadi kesalahan pada server. Silakan coba lagi nanti.");case 31:return e.next=33,i.json();case 33:if(a=e.sent,console.log("Response dari API addStory:",a),!a.error){e.next=38;break}throw console.error("Error saat menambahkan cerita:",a.message),new Error(a.message||"Gagal menambahkan cerita.");case 38:return e.abrupt("return",a);case 41:if(e.prev=41,e.t0=e.catch(0),"AbortError"!==e.t0.name){e.next=47;break}return e.abrupt("return",{error:!0,message:"Permintaan timeout. Mungkin ukuran foto terlalu besar atau koneksi lambat."});case 47:if("TypeError"!==e.t0.name||!e.t0.message.includes("Failed to fetch")){e.next=49;break}return e.abrupt("return",{error:!0,message:"Tidak dapat terhubung ke server. Periksa koneksi internet Anda."});case 49:return console.error("Error menambahkan cerita:",e.t0),e.abrupt("return",{error:!0,message:e.t0.message||"Gagal menambahkan cerita. Silakan coba lagi."});case 51:case"end":return e.stop()}}),e,null,[[0,41]])})));return function(t){return e.apply(this,arguments)}}(),Y=function(){var e=M(I().mark((function e(r){var n,o,i;return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,(n=p())&&n.token){e.next=4;break}throw new Error("Token tidak tersedia. Silakan login terlebih dahulu.");case 4:return e.next=6,fetch("".concat(t,"/notifications/subscribe"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n.token)},body:JSON.stringify(r)});case 6:return o=e.sent,e.next=9,o.json();case 9:if(i=e.sent,o.ok&&!i.error){e.next=12;break}throw new Error(i.message||"Gagal berlangganan notifikasi");case 12:return e.abrupt("return",i);case 15:return e.prev=15,e.t0=e.catch(0),console.error("Error subscribe notification:",e.t0),e.abrupt("return",{error:!0,message:e.t0.message||"Gagal berlangganan notifikasi"});case 19:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t){return e.apply(this,arguments)}}();function V(t){return V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},V(t)}function W(){W=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return s(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=k(u,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function p(){}function d(){}var y={};s(y,i,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(S([])));m&&m!==r&&n.call(m,i)&&(y=m);var g=d.prototype=f.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,h=c.value;return h&&"object"==V(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var o;s(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(V(e)+" is not iterable")}return p.prototype=d,s(g,"constructor",d),s(d,"constructor",p),p.displayName=s(d,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),s(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),s(g,u,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=t,n(s),!0;if(u<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function H(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function R(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?H(Object(r),!0).forEach((function(e){Q(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):H(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Q(t,e,r){return(e=X(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function z(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function U(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){z(i,n,o,a,u,"next",t)}function u(t){z(i,n,o,a,u,"throw",t)}a(void 0)}))}}function K(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,X(n.key),n)}}function X(t){var e=function(t){if("object"!=V(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=V(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==V(e)?e:e+""}const J=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"getAllStories",value:(o=U(W().mark((function t(e){var r,n,o;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,k("Getting stories with params:",r=R(R({},e),{},{location:1})),t.next=5,C(r);case 5:if(!(n=t.sent).error){t.next=8;break}throw new Error(n.message||"Gagal memuat cerita");case 8:return n.listStory&&(o=n.listStory.filter((function(t){return t.lat&&t.lon&&!isNaN(parseFloat(t.lat))&&!isNaN(parseFloat(t.lon))})).length,k("Received ".concat(n.listStory.length," stories, ").concat(o," with valid location"))),t.abrupt("return",n);case 12:throw t.prev=12,t.t0=t.catch(0),console.error("Error fetching stories:",t.t0),t.t0;case 16:case"end":return t.stop()}}),t,null,[[0,12]])}))),function(t){return o.apply(this,arguments)})},{key:"getStoryDetail",value:(n=U(W().mark((function t(e){var r;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,k("Fetching story detail for ID:",e),t.next=4,N(e);case 4:if(!(r=t.sent).error){t.next=7;break}throw new Error(r.message||"Gagal memuat detail cerita");case 7:return t.abrupt("return",r);case 10:throw t.prev=10,t.t0=t.catch(0),console.error("Error fetching story detail:",t.t0),t.t0;case 14:case"end":return t.stop()}}),t,null,[[0,10]])}))),function(t){return n.apply(this,arguments)})},{key:"addStory",value:(r=U(W().mark((function t(e){var r;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,k("Adding new story"),t.next=4,D(e);case 4:if(!(r=t.sent).error){t.next=7;break}throw new Error(r.message||"Gagal menambahkan cerita");case 7:return t.abrupt("return",r);case 10:throw t.prev=10,t.t0=t.catch(0),console.error("Error adding story:",t.t0),t.t0;case 14:case"end":return t.stop()}}),t,null,[[0,10]])}))),function(t){return r.apply(this,arguments)})}],e&&K(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o}();function q(t){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},q(t)}function Z(){Z=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return s(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=k(u,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function p(){}function d(){}var y={};s(y,i,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(S([])));m&&m!==r&&n.call(m,i)&&(y=m);var g=d.prototype=f.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,h=c.value;return h&&"object"==q(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var o;s(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(q(e)+" is not iterable")}return p.prototype=d,s(g,"constructor",d),s(d,"constructor",p),p.displayName=s(d,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),s(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),s(g,u,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=t,n(s),!0;if(u<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function $(t){return function(t){if(Array.isArray(t))return tt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return tt(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?tt(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function et(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function rt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){et(i,n,o,a,u,"next",t)}function u(t){et(i,n,o,a,u,"throw",t)}a(void 0)}))}}function nt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ot(n.key),n)}}function ot(t){var e=function(t){if("object"!=q(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=q(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==q(e)?e:e+""}const it=function(){return t=function t(e){var r=e.view,n=e.model;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._view=r,this._model=n,this._page=1,this._storiesPerPage=5,this._isLoading=!1,this._hasMoreData=!0,this._stories=[]},e=[{key:"loadStories",value:(n=rt(Z().mark((function t(){var e,r,n,o,i;return Z().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._isLoading){t.next=2;break}return t.abrupt("return");case 2:return this._isLoading=!0,this._view.showLoading(1===this._page),k("Loading stories page ".concat(this._page,", size ").concat(this._storiesPerPage)),t.prev=5,t.next=8,this._model.getAllStories({page:this._page,size:this._storiesPerPage,location:1});case 8:if((e=t.sent).listStory&&Array.isArray(e.listStory)){t.next=11;break}throw new Error("Format data cerita tidak valid");case 11:r=e.listStory.filter((function(t){return t.lat&&t.lon&&!isNaN(parseFloat(t.lat))&&!isNaN(parseFloat(t.lon))})),k("Received ".concat(e.listStory.length," stories, ").concat(r.length," have valid coordinates")),r.length>0&&k("Sample location data:",{name:r[0].name,lat:r[0].lat,lon:r[0].lon}),n=e.listStory,o=new Set(this._stories.map((function(t){return t.id}))),i=this._page>1?n.filter((function(t){return!o.has(t.id)})):n,1===this._page?(k("Setting initial stories list"),this._stories=i):(k("Adding ".concat(i.length," new stories to existing ").concat(this._stories.length)),this._stories=[].concat($(this._stories),$(i))),this._hasMoreData=n.length===this._storiesPerPage,k("Has more data: ".concat(this._hasMoreData)),this._stories.length>0?(this._view.renderStories(this._page>1,i),this._view.toggleLoadMoreButton(this._hasMoreData),this._view.isMapError()||(k("Updating map markers with ".concat(this._stories.length," stories")),this._view.updateMapMarkers(this._stories))):this._view.showEmptyStoriesMessage(),t.next=27;break;case 23:t.prev=23,t.t0=t.catch(5),k("Error loading stories:",t.t0),this._view.showErrorMessage(t.t0.message);case 27:return t.prev=27,this._isLoading=!1,this._view.hideLoadingIndicator(),t.finish(27);case 31:case"end":return t.stop()}}),t,this,[[5,23,27,31]])}))),function(){return n.apply(this,arguments)})},{key:"loadMoreStories",value:function(){!this._isLoading&&this._hasMoreData&&(k("Loading more stories"),this._page++,this.loadStories())}},{key:"setupInfiniteScroll",value:function(){var t=this;k("Setting up infinite scroll"),this._view.setupInfiniteScroll((function(){return t.loadMoreStories()}))}},{key:"initMap",value:(r=rt(Z().mark((function t(){var e=this;return Z().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,k("Initializing map from presenter"),t.next=4,this._view.initMap();case 4:this._stories&&this._stories.length>0&&(k("Updating markers after map init. Total stories: ".concat(this._stories.length)),setTimeout((function(){e._view.updateMapMarkers(e._stories)}),300)),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),k("Map initialization error:",t.t0),this._view.handleMapError(t.t0);case 11:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(){return r.apply(this,arguments)})}],e&&nt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function at(t){return at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},at(t)}function ut(t){return function(t){if(Array.isArray(t))return st(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return st(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?st(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function st(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function ct(){ct=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return s(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=k(u,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function p(){}function d(){}var y={};s(y,i,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(S([])));m&&m!==r&&n.call(m,i)&&(y=m);var g=d.prototype=f.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,h=c.value;return h&&"object"==at(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var o;s(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(at(e)+" is not iterable")}return p.prototype=d,s(g,"constructor",d),s(d,"constructor",p),p.displayName=s(d,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),s(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),s(g,u,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=t,n(s),!0;if(u<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function lt(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function ht(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){lt(i,n,o,a,u,"next",t)}function u(t){lt(i,n,o,a,u,"throw",t)}a(void 0)}))}}function ft(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,pt(n.key),n)}}function pt(t){var e=function(t){if("object"!=at(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=at(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==at(e)?e:e+""}var dt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._storyModel=new J,this._presenter=new it({view:this,model:this._storyModel}),this._map=null,this._markers=[],this._mapError=!1,this._scrollHandler=null},e=[{key:"render",value:(o=ht(ct().mark((function t(){return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n    <section id="content" class="container" tabindex="-1">\n      <h1 class="page-title"><i class="fas fa-book-reader"></i> Cerita Terbaru</h1>\n      \n      <div class="map-container" id="stories-map"></div>\n      \n      <div id="stories-container" class="stories-container">\n        <div class="loading">\n          <div class="loading-spinner"></div>\n        </div>\n      </div>\n      \n      <div id="load-more-container" style="text-align: center; margin-top: 20px; display: none;">\n        <button id="load-more-button" class="btn btn-primary">\n          <i class="fas fa-sync"></i> Muat Lebih Banyak\n        </button>\n      </div>\n    </section>\n  ');case 1:case"end":return t.stop()}}),t)}))),function(){return o.apply(this,arguments)})},{key:"afterRender",value:(n=ht(ct().mark((function t(){var e,r,n,o=this;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=document.getElementById("stories-container"),r=document.getElementById("stories-map"),document.getElementById("load-more-container"),n=document.getElementById("load-more-button"),t.prev=4,d()){t.next=9;break}return e&&(e.innerHTML='\n            <div class="alert alert-error">\n              <p>Anda perlu <a href="#/login">login</a> untuk melihat cerita.</p>\n              <p>Belum punya akun? <a href="#/register">Daftar sekarang</a>.</p>\n            </div>\n          '),r&&(r.style.display="none"),t.abrupt("return");case 9:return n&&n.addEventListener("click",(function(){o._presenter.loadMoreStories()})),this._presenter.setupInfiniteScroll(),t.prev=11,k("Initializing map before loading stories"),t.next=15,this.initMap();case 15:t.next=21;break;case 17:t.prev=17,t.t0=t.catch(11),k("Map initialization error:",t.t0),this.handleMapError(t.t0);case 21:return t.next=23,this._presenter.loadStories();case 23:t.next=29;break;case 25:t.prev=25,t.t1=t.catch(4),k("Error in home page:",t.t1),this.showErrorMessage(t.t1.message);case 29:case"end":return t.stop()}}),t,this,[[4,25],[11,17]])}))),function(){return n.apply(this,arguments)})},{key:"showLoading",value:function(t){var e=document.getElementById("stories-container"),r=document.getElementById("load-more-container");if(t&&e)e.innerHTML='\n        <div class="loading">\n          <div class="loading-spinner"></div>\n        </div>\n      ';else if(r){var n=document.createElement("div");n.className="loading",n.innerHTML='<div class="loading-spinner"></div>',n.id="load-more-spinner",r.appendChild(n)}}},{key:"hideLoadingIndicator",value:function(){var t=document.getElementById("load-more-spinner");t&&t.parentNode&&t.parentNode.removeChild(t)}},{key:"renderStories",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=document.getElementById("stories-container");if(n){r.length>0&&(this._stories=e?[].concat(ut(this._stories),ut(r)):r);try{var o=r,i=new Set,a=[];o.forEach((function(t){t&&t.id&&!i.has(t.id)&&(i.add(t.id),a.push(t))}));var u=a.map((function(e){return e&&e.name&&e.photoUrl?'\n        <article class="story-card" data-id="'.concat(e.id,'">\n          <div class="story-image-container">\n            <img \n            src="').concat(e.photoUrl,'" \n            alt="Cerita dari ').concat(e.name,'" \n            class="story-image"\n            onerror="this.onerror=null; this.src=\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAD6CAYAAAAbbXrzAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAADhBJREFUeNrs3V9u20YWwGGoaU+R7d7guS9gFYj7CHkDyFIXSHuDBK4vkPgGbW6QODdI4voDbeUuEHWBokBgdxcoshsULtolxk2mZWpKIiUNyRnO9wGC7cSSbXKo+XHOP8bGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANiWzfQ46fzZWvvMh91/tHt3/2f6mP7oP8pXCRQNVhVIVcc2TI836WP6PE46/99x+l8nyVcKbFukDsfTx/up1AvGKJ1E2lkQrEDUxnQSpD/uV1BLh+lkmqW/8pgfIFhBaVR10r8vGnUCJU+Pp+lkmqU/L8UJBCvQcOVBl4aqb2npMk1jT0QKBCtEaTQNVV9/pV36VDODYIWsDtVJA0sXRdJBEIIVuqJ89GkANwGgWSFYwbWqomk0oFBd1bSqnhUkWEEYSqiuqqpZRQJMsELx2pZVgbgWvlCwQgpVOGUhJFiBhCqUQcuhSbCCMJxLSx6VK4QrtMrLgUmwQiOFVRUXwoWCNeTLSyHLWwmCNYQplrJFkCBYgy2s2ArWCRCsoy6s2AusDM0SrEMurChwbR/B2vPYwh7xYKRLXyZYh1pYcXtF9rMlWANytLfz8SWu7SNYe1JYBG3XZbX0ZYJ1SIUVGdqmG9cmWNtmaMZQuRRFsPaEsWMsYfNz5jqFYO2jsCqWMIzCK1x9mWDtubCYnEMRFpexBGvPhbVUWAyjuPJq14K1VWrGiGtUIVj7Lazc0IyxBFYtBGufhUVZxVJYlYK1x8Jy1xvWgrt9Eax9FlZUTLHFNSzBOkACGNesqMQJ1j4LK1JWxMIZ1pYLKyqm2MKKYQnWIRRWVEyxhRXDEqwDJYSCigRr34UVFVNsZUUMRbD2XFhRMcUWVnxIsPZcWEWZUIirYBGsfRZWVEyxhfXegiVY+y6sqJhiCyu2QbAOoLCMHceKbRCsAzVjLDBiyLZhA8Laknw95n4bxldxWcbH/d4bCWGtprDaW2ikOUu0jR0fJ19tPf0sptfbjz8tQ9tQTbCG0YyxpNh+f0gDmjv9LB+/v/C5O8nnTYK1hxlWcQVkZ4HK32Oefv3+2B5fOolmAQ9KsHbQjFFGsZnfzaXfpY9fP/31t9Px9LcfPvzTaWoKrdsqWFsprMpY5rdx/K+pZ33/13+cpHY5NQuoYG2rsIzNGJr59Xf65aeXv/2QJbP/dB+rYG2psIwdMnv744//1JlPnU4Z6qThzgjWdpoxlBVbb2Nzty/6c/ooVJ8K1r4KKyqqKB+nv/vSn6dA5cUXJYZg7bkZY4sxq3LPnTzOnj1/+zY7fu/9+QqGYO25sAphdVr/vf80P+OL/M9ffPnV0fHJV30+bC5YWy+s6mbRKPpcQPr75fPnvy9HNz4OlR/vHhcZg9LfXz57drm8Yf1VG7Tn6XH/2vd68vrRu18+f/66Bf+uLFiFwRnWLaQN/Xp6lN2OoeXuFzEpuGq/TZPPn7+etCRQM0+v7FY7TQO1/ymuR90MK2PG1V5r/Pbbdp0V3fljh3t8/D7EvtcjWAcvKtlXbLvmDyxYglUxn1F/m2INUG4RKNcj+5Fh/VN+vBsrOArW3qXfS2d8JFj7LqtuPSo8zVeI1sAYlGAJFoI1OLlgIS2CVVQCEaxDLqtuPSo8zVeI1sAYlGAJl2INUG4RKNcj+5Fh/VN+vBsrOArW3qXfS2d8JFj7LqtuPSo8zVeI1sAYlGAJFoI1OLlgIS2CVVQCEaxDLqtuPSo8zVeI1sAlBYIlWjKuFJDqPI/HN/y9GSpan7zdjb71WP8Z5j/3P3SStP9bdH3+NRVl/fpylXPPnz/N+9hjvXl1s4L9j38w4fXZYvv9bTDO9v79/4ecSLMH6Qbpw93OfNnfOe8dP19+XLx6JjWD9QPZ+/vSb7H28X/fPGIgTrCE1X9XVk1eVXF97vrT+U7AEK3CvZ8f7vXty9nyRHZ8/1r9dTFoI1oGIQdHf+9m7p2+f3hQXwYvJC1mWYB1Mc9VvY/qzp2/evi0ej68vcbVkX1bB2vv88rvnJHnvUc9hy7JutWbTb7x+V1nCdcjBKndd8l6cX2S56K90LVg/iDAMvj+LFn2W9a7+vS/XL0Ue7L0QrAOdb95b07maTHRZgiVYgwzW68ePpSvBGuTYMa5U9DsSFl2WYAlWYMx6TLAMXsMKVuGGJdOCJVoUxqg6LMGqm2N1ntvZj/WLbEGwBOvQG6z7G9GCJViDuIY1VL+OvvTXNSxcwxrwaFVu4tTjXAQLwaqbZem+EEbB+lEsQ8Gq22aZ9dh4JFi4hNVV//5ZvbosORYs0aqnVdjnzQQEq2HGXjdCLiksK6pCaAWrkRsXl6ZNyK0Q0WrbIrwW0pXPJViHbNXrtYP/OtGxbREeekDvvXNuixAswtb1R2+z0WORYcGCDPu97iq0WoJ1yOF6ONXl8MeBjY+CJW0H3miZZQnWvsyjCDc+3YmV4dIgWA0VQ9kxnHJl8VGwGi0G6aYbzaoFC7JkUB4EyxgWgvVXxrUQrOY2bwHLCuGSJVhQEqnwKlBZwWo88cK29kKwDJOGWVUqKcFqg/jkh4y9LMFqSwiGPLQc7tBBsJo+JKTbNmEsWK3SbMl2SVWw2i6CiqdcU26C1TYtXXGP32zBOih9L/3pdwkXwTqkPKsXt+zyFywonbPQ8uFQsA7dTcbqdFaCRdXlXStGVgSrLTfYwk6bLMMSrLbdnNzPgmC1SXmcRbYFq4XCYhQVwTr4aFEu12ZagtXmaOF+FgQL09wFq+XLv1h1mfQQLLqilRe/zKsQLMoiVnNBWpAJFmVX5YsRKcGiQrRkSrAQKMHiR42WjzUUrAGS+wXrUBus4g3u5V2wDJMQLLYcrfLdESpiFtFhPtbQb3XuOx3aqMq8CsE65Gb20HvZQGEo/bNgQSFeZlgEq1WxMqtCsJouhmZZFCxDRgjWHlk9qx9DwBYsy7AIViPDFcJdj1pNXUOwDr2Y2tTAOfoQLEp6WZUHIMyjQLA6BdQSWZRgIViCBYIlViBYgiVYgCGcYIEgCZZoCZZgQeOYuBcsNlJwzStvIFiCQCBYggUgWNAZEjMtBAvBEiwQLMHCDAvBAjRYIFiwHSoogiVY/ZU3pVOwcA1LsIggCJZgQXDtlGCBYLmERbAEi+E2WIKFa1jtCJZRlmi5S4NgESeXsAQLBBnBEiy2JYAXVWFPrGDBjsSl+a/S/TgRLHzQnWCBYE2LrDkWLHaQrrIbf8uyYInWvjtZJV0u9QmWaLVLlT6WbIHgfT7yLFpH2WsWGY6yUEf5bwsJ2mZq95F3hHw6yv/KIjwZFa89SqN1nMX4ZPQvAubaDbuwV4uKj9mkx2TUI+STkTADALAnbm/g/Vwua88Ea1+OP+lx3OOl10fZ4+S7FxKsBnxy0jPIk+PsMs9pz0t3k+6f/WX24DT7uZO9vvzhXg0WoIFLYZNeEZ30upQ16REd0RKs1oeqzxLWJA/s6Xf8OykDJFitn4pxKaz/a55015l/SqB9GYJnDZbwHuWh7tHfmubN1VEesm8veU8F67CSNRat1XBdXroa/fdLZb/WEa+JcB1OwL69RNWxxmoy/e/LX10+OwXrQC9rXf5Zt9/rd5nrslH79qXLZqdgHWi0TqYlq/3y3NnFdVnnptcTrMNN12lus9fV/p6L91me6WTHm77/sFPBOliX9/2JL5fBzrN0na8Gp5tEX/w6jdMU9NnwHgfugOZinO+rSX667+jHvp3wPT3ZcPR/KlgHvY7rZDrd/3Q6nR7tI1b58+Tpy0fOk+F8UoUJ7+m+J7j3mf6QXYo7n+blgqfTSE273fd0h5+1YB3cJbDp9K/7e1/1Xe/Vw0RYFmVYgyBYggUgWKCnRbAABIsWzwUELHEVLNEaKpO8BMuEMQRLsASL7nUswcLMf0QL17AQLMECBEuwQJewBEuwAMESTFzDQrBwoiZagmUvYRAsAQTXsATLPsIgWIIIRgjBMlAEBEsBmTpwhQnBEsb/EXDAJSzBwnVtdQMEy9VtQJYFC1xwQbAEDBAswQIQrFaHa0ix/nZhv2DBOky9crmOtb7PF/YLFglXKK+LWPn9gkXCFcoVhcqLvOwZxHi+vx2OBQs23uO4zTEfC5bJD8gwggWCJVggWIIFCBYIlmABggWCZUdnwRIsECzBAsECwTKGJViCBYIlWCBYggWCBYIlWCBYIFiCBYIFgiVYIFggWIIFCBYIliBqUWrBEiyAHiYmjbPHD9nj+fTXj81VAmLWRxGwj2TdLO2ZTR+v089f94pifn7mz1fTX9+lP7/JXz+CRcj6KK0pXJfZ47309x9l4TIQ7O9e+vMb089Bve9Lgcu8i4sPp9OfX08DdZr/+Wz6+9kUsDPX/MBYCwB2KO/zrmbTn0/TMF4J11H26wvxAg6k0Zpm65V4AQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwLb8T4ABAFyGt6FLqJ4OAAAAAElFTkSuQmCC\';"\n            loading="lazy"\n          >\n        </div>\n        <div class="story-content">\n          <h2 class="story-title">').concat(e.name,'</h2>\n          <p class="story-meta"><i class="far fa-calendar-alt"></i> ').concat(f(e.createdAt),'</p>\n          <p class="story-description">').concat(e.description?e.description.length>100?e.description.substring(0,100)+"...":e.description:"Tidak ada deskripsi","</p>\n          ").concat(e.lat&&e.lon?'\n            <div class="story-location">\n              <i class="fas fa-map-marker-alt"></i>\n              '.concat(t._mapError?"Lokasi: ".concat(parseFloat(e.lat).toFixed(6),", ").concat(parseFloat(e.lon).toFixed(6)):"Lokasi tersedia","\n            </div>\n        "):"",' \n          <div class="story-more">\n            <a href="#/story/').concat(e.id,'" class="btn btn-primary">\n              <i class="fas fa-book-open"></i> Lihat Detail\n            </a>\n          </div>\n        </div>\n      </article>\n    '):(console.log("Story data is incomplete:",e),"")})).join("");if(e){var s=document.createElement("div");s.innerHTML=u,Array.from(s.children).forEach((function(t){t.style.opacity="0",t.style.transform="translateY(20px)",n.appendChild(t),setTimeout((function(){t.style.transition="opacity 0.5s, transform 0.5s",t.style.opacity="1",t.style.transform="translateY(0)"}),10)}))}else n.innerHTML=u}catch(t){console.error("Error rendering stories:",t),this.showErrorMessage(t.message)}}else console.warn("Stories container tidak ditemukan")}},{key:"toggleLoadMoreButton",value:function(t){var e=document.getElementById("load-more-container");e&&(e.style.display=t?"block":"none")}},{key:"showEmptyStoriesMessage",value:function(){var t=document.getElementById("stories-container"),e=document.getElementById("load-more-container");t&&(t.innerHTML='\n        <div class="alert alert-info">\n          <p>Belum ada cerita yang tersedia.</p>\n          <p>Jadilah yang pertama <a href="#/add">berbagi cerita</a>!</p>\n        </div>\n      '),e&&(e.style.display="none")}},{key:"showErrorMessage",value:function(t){var e=document.getElementById("stories-container"),r=document.getElementById("stories-map");e&&(e.innerHTML='\n        <div class="alert alert-error">\n          <p>Terjadi kesalahan saat memuat cerita.</p>\n          <p>'.concat(t||"Kesalahan tidak diketahui",'</p>\n          <button onclick="window.location.reload()" class="btn btn-small">Coba Lagi</button>\n        </div>\n      ')),r&&(r.style.display="none")}},{key:"setupInfiniteScroll",value:function(t){var e=this,r=!1;this._scrollHandler=function(){if(!r){r=!0,setTimeout((function(){r=!1}),300);var n=document.getElementById("load-more-button"),o=document.getElementById("stories-container");n&&o?(window.scrollY||window.pageYOffset)+window.innerHeight>=document.documentElement.scrollHeight-300&&t():window.removeEventListener("scroll",e._scrollHandler)}},window.addEventListener("scroll",this._scrollHandler)}},{key:"initMap",value:(r=ht(ct().mark((function t(){var e,r,n=this;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e=document.getElementById("stories-map")){t.next=5;break}return k("Map container tidak ditemukan"),t.abrupt("return");case 5:if(k("Initializing map in View..."),0===e.clientHeight&&(e.style.height="400px"),!this._map){t.next=11;break}return k("Map already exists, invalidating size"),this._map.invalidateSize(),t.abrupt("return");case 11:return t.next=13,m();case 13:return r=t.sent,window.L=r,k("Leaflet script loaded successfully"),t.next=18,new Promise((function(t){return setTimeout(t,300)}));case 18:return k("Creating map instance"),this._map=r.map(e,{center:[-2.5489,118.0149],zoom:5,zoomControl:!0}),r.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(this._map),window.addEventListener("resize",(function(){n._map&&n._map.invalidateSize()})),document.addEventListener("visibilitychange",(function(){"visible"===document.visibilityState&&n._map&&setTimeout((function(){return n._map.invalidateSize()}),200)})),k("Map initialization complete"),this._stories&&this._stories.length>0&&(k("Updating markers on map init with ".concat(this._stories.length," existing stories")),setTimeout((function(){n.updateMapMarkers(n._stories)}),500)),t.abrupt("return",this._map);case 28:throw t.prev=28,t.t0=t.catch(0),k("Error initializing map:",t.t0),this._mapError=!0,t.t0;case 33:case"end":return t.stop()}}),t,this,[[0,28]])}))),function(){return r.apply(this,arguments)})},{key:"updateMapMarkers",value:function(t){var e=this;if(k("updateMapMarkers called with ".concat(t?t.length:0," stories")),this._map&&!this._mapError)if(this._markers&&this._markers.length>0&&(k("Removing ".concat(this._markers.length," existing markers")),this._markers.forEach((function(t){t&&t.remove&&t.remove()})),this._markers=[]),window.L)try{var r=window.L.icon({iconUrl:"https://cdn-icons-png.flaticon.com/512/684/684908.png",iconSize:[32,32],iconAnchor:[16,32],popupAnchor:[0,-32]}),n=0,o=0,i=t.filter((function(t){return t&&t.lat&&t.lon&&!isNaN(parseFloat(t.lat))&&!isNaN(parseFloat(t.lon))}));if(k("Found ".concat(i.length," stories with valid location data")),i.forEach((function(t){var i=parseFloat(t.lat),a=parseFloat(t.lon);o++;try{var u=window.L.marker([i,a],{icon:r});u.bindPopup('\n            <div class="map-popup">\n              <h3>'.concat(t.name,"</h3>\n              <p>").concat(t.description?t.description.substring(0,100)+"...":"Tidak ada deskripsi",'</p>\n              <a href="#/story/').concat(t.id,'" class="btn btn-small">Lihat Detail</a>\n            </div>\n          ')),u.addTo(e._map),e._markers.push(u),n++}catch(e){k("Error adding marker for story ".concat(t.id,":"),e)}})),k("Added ".concat(n," markers to map from ").concat(o," valid stories")),this._markers.length>0)try{var a=window.L.featureGroup(this._markers);this._map.fitBounds(a.getBounds(),{padding:[30,30]}),k("Successfully fit bounds to markers")}catch(t){k("Error fitting bounds:",t)}else k("No markers to fit bounds")}catch(t){k("Error in updateMapMarkers:",t)}else k("Leaflet not available, skipping marker update");else k("Map not available or has error, skipping marker update")}},{key:"handleMapError",value:function(t){this._mapError=!0;var e=document.getElementById("stories-map");e&&(e.innerHTML='\n        <div class="alert alert-error">\n          <p>Gagal memuat peta. Mohon periksa koneksi internet Anda.</p>\n          <p>Error: '.concat(t.message||"Tidak diketahui","</p>\n        </div>\n      ")),k("Map error handled:",t)}},{key:"isMapError",value:function(){return this._mapError}},{key:"cleanup",value:function(){if(k("Cleaning up HomePage resources"),this._scrollHandler&&(window.removeEventListener("scroll",this._scrollHandler),this._scrollHandler=null),this._map){try{this._map.remove(),k("Map removed successfully")}catch(t){k("Error removing map:",t)}this._map=null}this._markers=[],console.log("HomePage resources cleaned up")}}],e&&ft(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o}();function yt(t){return yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yt(t)}function vt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,gt(n.key),n)}}function mt(t,e,r){return e&&vt(t.prototype,e),r&&vt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function gt(t){var e=function(t){if("object"!=yt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=yt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==yt(e)?e:e+""}const wt=mt((function t(e){var r=e.view;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._view=r}));function bt(t){return bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bt(t)}function kt(){kt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return s(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=k(u,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function p(){}function d(){}var y={};s(y,i,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(S([])));m&&m!==r&&n.call(m,i)&&(y=m);var g=d.prototype=f.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,h=c.value;return h&&"object"==bt(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var o;s(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(bt(e)+" is not iterable")}return p.prototype=d,s(g,"constructor",d),s(d,"constructor",p),p.displayName=s(d,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),s(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),s(g,u,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=t,n(s),!0;if(u<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function Et(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function xt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Et(i,n,o,a,u,"next",t)}function u(t){Et(i,n,o,a,u,"throw",t)}a(void 0)}))}}function _t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,St(n.key),n)}}function St(t){var e=function(t){if("object"!=bt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=bt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==bt(e)?e:e+""}var jt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._presenter=new wt({view:this})},e=[{key:"render",value:(n=xt(kt().mark((function t(){return kt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section id="content" class="container" tabindex="-1">\n        <h1 class="page-title">Tentang Dicoding Story</h1>\n        \n        <div class="about-content">\n          <p>\n            Dicoding Story adalah platform berbagi cerita dan pengalaman seputar Dicoding. \n            Aplikasi ini dibangun sebagai proyek untuk memenuhi submission kelas Dicoding.\n          </p>\n          \n          <h2>Fitur Aplikasi</h2>\n          <ul>\n            <li>Melihat cerita dari pengguna Dicoding lainnya</li>\n            <li>Berbagi cerita Anda sendiri dengan komunitas Dicoding</li>\n            <li>Menambahkan lokasi pada cerita Anda</li>\n            <li>Melihat lokasi cerita di peta</li>\n          </ul>\n          \n          <h2>Teknologi yang Digunakan</h2>\n          <ul>\n            <li>HTML, CSS, dan JavaScript</li>\n            <li>Arsitektur Single-Page Application (SPA)</li>\n            <li>Pola Model-View-Presenter (MVP)</li>\n            <li>Leaflet untuk menampilkan peta</li>\n            <li>View Transition API untuk transisi halaman yang halus</li>\n          </ul>\n          \n          <h2>Kriteria Proyek</h2>\n          <ol>\n            <li>Menggunakan Dicoding Story API sebagai sumber data</li>\n            <li>Menggunakan arsitektur Single-Page Application</li>\n            <li>Menerapkan teknik hash dalam routing</li>\n            <li>Menampilkan daftar cerita dengan gambar dan teks</li>\n            <li>Menampilkan peta dengan marker untuk cerita</li>\n            <li>Fitur tambah cerita baru dengan kamera dan lokasi</li>\n            <li>Menerapkan aksesibilitas sesuai standar</li>\n            <li>Mengimplementasikan transisi halaman yang halus</li>\n          </ol>\n          \n          <p style="margin-top: 30px;">\n            &copy; 2025 - Dibuat oleh Kharisma untuk submission kelas Dicoding\n          </p>\n        </div>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:(r=xt(kt().mark((function t(){return kt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})}],e&&_t(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function At(t){return At="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},At(t)}function Ot(){Ot=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return s(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=k(u,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function p(){}function d(){}var y={};s(y,i,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(S([])));m&&m!==r&&n.call(m,i)&&(y=m);var g=d.prototype=f.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,h=c.value;return h&&"object"==At(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var o;s(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(At(e)+" is not iterable")}return p.prototype=d,s(g,"constructor",d),s(d,"constructor",p),p.displayName=s(d,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),s(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),s(g,u,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=t,n(s),!0;if(u<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function Pt(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function Tt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Pt(i,n,o,a,u,"next",t)}function u(t){Pt(i,n,o,a,u,"throw",t)}a(void 0)}))}}function It(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Lt(n.key),n)}}function Lt(t){var e=function(t){if("object"!=At(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=At(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==At(e)?e:e+""}const Bt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"login",value:(n=Tt(Ot().mark((function t(e){var r;return Ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,G(e);case 3:if(!(r=t.sent).error){t.next=6;break}throw new Error(r.message||"Login gagal");case 6:return t.abrupt("return",r);case 9:throw t.prev=9,t.t0=t.catch(0),console.error("Error during login:",t.t0),t.t0;case 13:case"end":return t.stop()}}),t,null,[[0,9]])}))),function(t){return n.apply(this,arguments)})},{key:"register",value:(r=Tt(Ot().mark((function t(e){var r;return Ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,F(e);case 3:if(!(r=t.sent).error){t.next=6;break}throw new Error(r.message||"Registrasi gagal");case 6:return t.abrupt("return",r);case 9:throw t.prev=9,t.t0=t.catch(0),console.error("Error during registration:",t.t0),t.t0;case 13:case"end":return t.stop()}}),t,null,[[0,9]])}))),function(t){return r.apply(this,arguments)})}],e&&It(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function Mt(t){return Mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mt(t)}function Gt(){Gt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return s(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=k(u,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function p(){}function d(){}var y={};s(y,i,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(S([])));m&&m!==r&&n.call(m,i)&&(y=m);var g=d.prototype=f.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,h=c.value;return h&&"object"==Mt(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var o;s(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Mt(e)+" is not iterable")}return p.prototype=d,s(g,"constructor",d),s(d,"constructor",p),p.displayName=s(d,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),s(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),s(g,u,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=t,n(s),!0;if(u<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function Ft(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function Ct(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Ft(i,n,o,a,u,"next",t)}function u(t){Ft(i,n,o,a,u,"throw",t)}a(void 0)}))}}function Nt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Dt(n.key),n)}}function Dt(t){var e=function(t){if("object"!=Mt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Mt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Mt(e)?e:e+""}const Yt=function(){return t=function t(e){var r=e.view,n=e.model;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._view=r,this._model=n},e=[{key:"checkLoginStatus",value:function(){return!!d()&&(this._view.redirectToHome(),!0)}},{key:"login",value:(n=Ct(Gt().mark((function t(e){var r,n,o,i,a=this;return Gt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.email,n=e.password,o=e.rememberMe,t.prev=1,this._view.showLoading(),t.next=5,this._model.login({email:r,password:n});case 5:if((i=t.sent).loginResult&&i.loginResult.token){t.next=8;break}throw new Error("Token tidak ditemukan dalam respons login");case 8:return y(i.loginResult,o),t.next=11,this.initializePushNotificationAfterLogin();case 11:return this._view.showSuccessMessage("Login berhasil. Mengalihkan..."),E("Berhasil","Login berhasil"),setTimeout((function(){a._view.redirectToHome()}),1500),t.abrupt("return",!0);case 17:return t.prev=17,t.t0=t.catch(1),console.error("Login error:",t.t0),this._view.showErrorMessage(t.t0.message||"Terjadi kesalahan saat login"),E("Error",t.t0.message||"Terjadi kesalahan saat login"),t.abrupt("return",!1);case 23:return t.prev=23,this._view.hideLoading(),t.finish(23);case 26:case"end":return t.stop()}}),t,this,[[1,17,23,26]])}))),function(t){return n.apply(this,arguments)})},{key:"initializePushNotificationAfterLogin",value:(r=Ct(Gt().mark((function t(){var e,r,n;return Gt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,j();case 3:if(t.sent){t.next=7;break}return console.log("Izin notifikasi ditolak"),t.abrupt("return");case 7:return t.next=9,navigator.serviceWorker.ready;case 9:return e=t.sent,t.next=12,e.pushManager.getSubscription();case 12:if(t.sent){t.next=22;break}return t.next=16,O(e);case 16:return r=t.sent,n={endpoint:r.endpoint,keys:{p256dh:btoa(String.fromCharCode.apply(null,new Uint8Array(r.getKey("p256dh")))),auth:btoa(String.fromCharCode.apply(null,new Uint8Array(r.getKey("auth"))))}},t.next=20,Y(n);case 20:t.sent.error||console.log("Berhasil berlangganan push notification setelah login");case 22:t.next=27;break;case 24:t.prev=24,t.t0=t.catch(0),console.error("Gagal setup push notification setelah login:",t.t0);case 27:case"end":return t.stop()}}),t,null,[[0,24]])}))),function(){return r.apply(this,arguments)})}],e&&Nt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function Vt(t){return Vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vt(t)}function Wt(){Wt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return s(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=k(u,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function p(){}function d(){}var y={};s(y,i,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(S([])));m&&m!==r&&n.call(m,i)&&(y=m);var g=d.prototype=f.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,h=c.value;return h&&"object"==Vt(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var o;s(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Vt(e)+" is not iterable")}return p.prototype=d,s(g,"constructor",d),s(d,"constructor",p),p.displayName=s(d,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),s(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),s(g,u,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=t,n(s),!0;if(u<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function Ht(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function Rt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Ht(i,n,o,a,u,"next",t)}function u(t){Ht(i,n,o,a,u,"throw",t)}a(void 0)}))}}function Qt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,zt(n.key),n)}}function zt(t){var e=function(t){if("object"!=Vt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Vt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Vt(e)?e:e+""}var Ut=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._authModel=new Bt,this._presenter=new Yt({view:this,model:this._authModel})},e=[{key:"render",value:(n=Rt(Wt().mark((function t(){return Wt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section id="content" class="container" tabindex="-1">\n        <h1 class="page-title">Login</h1>\n        \n        <div class="form-container">\n          <div id="login-alert" class="alert" style="display: none;"></div>\n          \n          <form id="login-form">\n            <div class="form-group">\n              <label for="email" class="form-label">Email</label>\n              <input \n                type="email" \n                id="email" \n                class="form-input" \n                placeholder="Masukkan email" \n                required\n              >\n            </div>\n            \n            <div class="form-group">\n              <label for="password" class="form-label">Password</label>\n              <input \n                type="password" \n                id="password" \n                class="form-input" \n                placeholder="Masukkan password" \n                required\n              >\n            </div>\n            \n            <div class="form-check" style="margin-bottom: 15px;">\n              <input type="checkbox" id="remember-me" class="form-check-input">\n              <label for="remember-me" class="form-check-label">Ingat saya</label>\n            </div>\n            \n            <button type="submit" class="btn btn-primary btn-block" id="login-button">\n              Login\n            </button>\n          </form>\n          \n          <p style="margin-top: 20px; text-align: center;">\n            Belum punya akun? <a href="#/register">Daftar sekarang</a>\n          </p>\n        </div>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:(r=Rt(Wt().mark((function t(){var e,r=this;return Wt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._presenter.checkLoginStatus()){t.next=2;break}return t.abrupt("return");case 2:e=document.getElementById("login-form"),document.getElementById("email").focus(),e.addEventListener("submit",function(){var t=Rt(Wt().mark((function t(e){var n,o,i;return Wt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),n=document.getElementById("email").value,o=document.getElementById("password").value,i=document.getElementById("remember-me").checked,k("Login attempt",{email:n,rememberMe:i}),t.next=7,r._presenter.login({email:n,password:o,rememberMe:i});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 5:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"showLoading",value:function(){var t=document.getElementById("login-button");t._originalText=t.textContent,t.textContent="Loading...",t.disabled=!0}},{key:"hideLoading",value:function(){var t=document.getElementById("login-button");t&&t._originalText&&(t.textContent=t._originalText,t.disabled=!1)}},{key:"showSuccessMessage",value:function(t){var e=document.getElementById("login-alert");e&&(e.className="alert alert-success",e.textContent=t,e.style.display="block")}},{key:"showErrorMessage",value:function(t){var e=document.getElementById("login-alert");e&&(e.className="alert alert-error",e.textContent=t,e.style.display="block")}},{key:"redirectToHome",value:function(){window.location.hash="#/"}}],e&&Qt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function Kt(t){return Kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kt(t)}function Xt(){Xt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return s(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=k(u,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function p(){}function d(){}var y={};s(y,i,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(S([])));m&&m!==r&&n.call(m,i)&&(y=m);var g=d.prototype=f.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,h=c.value;return h&&"object"==Kt(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var o;s(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Kt(e)+" is not iterable")}return p.prototype=d,s(g,"constructor",d),s(d,"constructor",p),p.displayName=s(d,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),s(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),s(g,u,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=t,n(s),!0;if(u<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function Jt(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function qt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Zt(n.key),n)}}function Zt(t){var e=function(t){if("object"!=Kt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Kt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Kt(e)?e:e+""}const $t=function(){return t=function t(e){var r=e.view,n=e.model;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._view=r,this._model=n},e=[{key:"checkLoginStatus",value:function(){return!!d()&&(this._view.redirectToHome(),!0)}},{key:"validatePassword",value:function(t,e){return t!==e?"Password dan konfirmasi password tidak sama":t.length<8?"Password harus minimal 8 karakter":null}},{key:"register",value:(r=Xt().mark((function t(e){var r,n,o,i,a,u=this;return Xt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.name,n=e.email,o=e.password,i=e.passwordConfirm,t.prev=1,this._view.showLoading(),!(a=this.validatePassword(o,i))){t.next=6;break}throw new Error(a);case 6:return t.next=8,this._model.register({name:r,email:n,password:o});case 8:return t.sent,this._view.showSuccessMessage("Registrasi berhasil. Silakan login."),setTimeout((function(){u._view.redirectToLogin()}),2e3),t.abrupt("return",!0);case 14:return t.prev=14,t.t0=t.catch(1),console.error("Register error:",t.t0),this._view.showErrorMessage(t.t0.message||"Terjadi kesalahan saat pendaftaran"),t.abrupt("return",!1);case 19:return t.prev=19,this._view.hideLoading(),t.finish(19);case 22:case"end":return t.stop()}}),t,this,[[1,14,19,22]])})),n=function(){var t=this,e=arguments;return new Promise((function(n,o){var i=r.apply(t,e);function a(t){Jt(i,n,o,a,u,"next",t)}function u(t){Jt(i,n,o,a,u,"throw",t)}a(void 0)}))},function(t){return n.apply(this,arguments)})}],e&&qt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function te(t){return te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},te(t)}function ee(){ee=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return s(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=k(u,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function p(){}function d(){}var y={};s(y,i,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(S([])));m&&m!==r&&n.call(m,i)&&(y=m);var g=d.prototype=f.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,h=c.value;return h&&"object"==te(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var o;s(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(te(e)+" is not iterable")}return p.prototype=d,s(g,"constructor",d),s(d,"constructor",p),p.displayName=s(d,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),s(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),s(g,u,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=t,n(s),!0;if(u<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function re(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function ne(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){re(i,n,o,a,u,"next",t)}function u(t){re(i,n,o,a,u,"throw",t)}a(void 0)}))}}function oe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ie(n.key),n)}}function ie(t){var e=function(t){if("object"!=te(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=te(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==te(e)?e:e+""}var ae=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._authModel=new Bt,this._presenter=new $t({view:this,model:this._authModel})},e=[{key:"render",value:(n=ne(ee().mark((function t(){return ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section id="content" class="container" tabindex="-1">\n        <h1 class="page-title">Daftar Akun</h1>\n        \n        <div class="form-container">\n          <div id="register-alert" class="alert" style="display: none;"></div>\n          \n          <form id="register-form">\n            <div class="form-group">\n              <label for="name" class="form-label">Nama</label>\n              <input \n                type="text" \n                id="name" \n                class="form-input" \n                placeholder="Masukkan nama" \n                required\n              >\n            </div>\n            \n            <div class="form-group">\n              <label for="email" class="form-label">Email</label>\n              <input \n                type="email" \n                id="email" \n                class="form-input" \n                placeholder="Masukkan email" \n                required\n              >\n            </div>\n            \n            <div class="form-group">\n              <label for="password" class="form-label">Password</label>\n              <input \n                type="password" \n                id="password" \n                class="form-input" \n                placeholder="Minimal 8 karakter" \n                minlength="8"\n                required\n              >\n            </div>\n            \n            <div class="form-group">\n              <label for="password-confirm" class="form-label">Konfirmasi Password</label>\n              <input \n                type="password" \n                id="password-confirm" \n                class="form-input" \n                placeholder="Konfirmasi password" \n                minlength="8"\n                required\n              >\n            </div>\n            \n            <button type="submit" class="btn btn-block" id="register-button">\n              Daftar\n            </button>\n          </form>\n          \n          <p style="margin-top: 20px; text-align: center;">\n            Sudah punya akun? <a href="#/login">Login</a>\n          </p>\n        </div>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:(r=ne(ee().mark((function t(){var e,r,n,o,i=this;return ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=function(){r.value!==n.value?n.setCustomValidity("Password dan konfirmasi password tidak sama"):n.setCustomValidity("")},!this._presenter.checkLoginStatus()){t.next=3;break}return t.abrupt("return");case 3:e=document.getElementById("register-form"),r=document.getElementById("password"),n=document.getElementById("password-confirm"),document.getElementById("name").focus(),r.addEventListener("change",o),n.addEventListener("keyup",o),e.addEventListener("submit",function(){var t=ne(ee().mark((function t(e){var r,n,o,a;return ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),r=document.getElementById("name").value,n=document.getElementById("email").value,o=document.getElementById("password").value,a=document.getElementById("password-confirm").value,k("Register attempt",{name:r,email:n}),t.next=8,i._presenter.register({name:r,email:n,password:o,passwordConfirm:a});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 10:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"showLoading",value:function(){var t=document.getElementById("register-button"),e=t.textContent;t.textContent="Loading...",t.disabled=!0,t._originalText=e}},{key:"hideLoading",value:function(){var t=document.getElementById("register-button");t&&t._originalText&&(t.textContent=t._originalText,t.disabled=!1)}},{key:"showSuccessMessage",value:function(t){var e=document.getElementById("register-alert");e&&(e.className="alert alert-success",e.textContent=t,e.style.display="block")}},{key:"showErrorMessage",value:function(t){var e=document.getElementById("register-alert");e&&(e.className="alert alert-error",e.textContent=t,e.style.display="block",window.scrollTo({top:0,behavior:"smooth"}))}},{key:"redirectToHome",value:function(){window.location.hash="#/"}},{key:"redirectToLogin",value:function(){window.location.hash="#/login"}}],e&&oe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function ue(t){return ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ue(t)}function se(){se=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return s(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=k(u,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function p(){}function d(){}var y={};s(y,i,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(S([])));m&&m!==r&&n.call(m,i)&&(y=m);var g=d.prototype=f.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,h=c.value;return h&&"object"==ue(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var o;s(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(ue(e)+" is not iterable")}return p.prototype=d,s(g,"constructor",d),s(d,"constructor",p),p.displayName=s(d,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),s(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),s(g,u,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=t,n(s),!0;if(u<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function ce(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function le(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){ce(i,n,o,a,u,"next",t)}function u(t){ce(i,n,o,a,u,"throw",t)}a(void 0)}))}}function he(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,fe(n.key),n)}}function fe(t){var e=function(t){if("object"!=ue(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ue(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ue(e)?e:e+""}const pe=function(){return t=function t(e){var r=e.view,n=e.model;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._view=r,this._model=n},e=[{key:"addStory",value:(n=le(se().mark((function t(e){var r,n,o,i;return se().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,this._view.showLoading(),e instanceof FormData?(r=e.get("description"),n=e.get("photo")):(r=e.description,n=e.photo),r&&("string"!=typeof r||""!==r.trim())){t.next=5;break}throw new Error("Deskripsi cerita tidak boleh kosong");case 5:if(n){t.next=7;break}throw new Error("Silakan ambil atau pilih foto terlebih dahulu");case 7:return k("Mengirim data cerita dengan valid data"),t.next=10,this._model.addStory(e);case 10:if((o=t.sent).error){t.next=28;break}if(this._view.showSuccessMessage("Cerita berhasil ditambahkan"),!("serviceWorker"in navigator)){t.next=25;break}return t.prev=14,t.next=17,navigator.serviceWorker.ready;case 17:return i=t.sent,t.next=20,i.showNotification("Story berhasil dibuat",{body:"Anda telah membuat story baru dengan deskripsi: ".concat(r),icon:"./favicon.png",badge:"./favicon.png",tag:"story-created",requireInteraction:!0,data:{url:"#/"}});case 20:t.next=25;break;case 22:t.prev=22,t.t0=t.catch(14),console.error("Gagal menampilkan notifikasi:",t.t0);case 25:return t.abrupt("return",!0);case 28:throw new Error(o.message||"Gagal menambahkan cerita");case 29:t.next=37;break;case 31:return t.prev=31,t.t1=t.catch(0),k("Error adding story:",t.t1),this._view.showErrorMessage(t.t1.message),E("Error",t.t1.message),t.abrupt("return",!1);case 37:return t.prev=37,this._view.hideLoading(),t.finish(37);case 40:case"end":return t.stop()}}),t,this,[[0,31,37,40],[14,22]])}))),function(t){return n.apply(this,arguments)})},{key:"initMap",value:(r=le(se().mark((function t(){return se().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._view.initMap();case 3:t.next=9;break;case 5:t.prev=5,t.t0=t.catch(0),k("Map initialization error:",t.t0),this._view.handleMapError(t.t0);case 9:case"end":return t.stop()}}),t,this,[[0,5]])}))),function(){return r.apply(this,arguments)})},{key:"updateMarker",value:function(t,e){this._view.updateMarker(t,e)}},{key:"getCurrentLocation",value:function(){this._view.getCurrentLocation()}},{key:"resetMapMarker",value:function(){this._view.resetMapMarker()}}],e&&he(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function de(t){return de="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},de(t)}function ye(){ye=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return s(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=k(u,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function p(){}function d(){}var y={};s(y,i,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(S([])));m&&m!==r&&n.call(m,i)&&(y=m);var g=d.prototype=f.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,h=c.value;return h&&"object"==de(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var o;s(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(de(e)+" is not iterable")}return p.prototype=d,s(g,"constructor",d),s(d,"constructor",p),p.displayName=s(d,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),s(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),s(g,u,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=t,n(s),!0;if(u<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function ve(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function me(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){ve(i,n,o,a,u,"next",t)}function u(t){ve(i,n,o,a,u,"throw",t)}a(void 0)}))}}function ge(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,we(n.key),n)}}function we(t){var e=function(t){if("object"!=de(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=de(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==de(e)?e:e+""}var be=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._storyModel=new J,this._presenter=new pe({view:this,model:this._storyModel}),this._map=null,this._currentMarker=null,this._cameraStream=null,this._imageBlob=null,this._location={lat:null,lon:null},this.handleSubmit=this.handleSubmit.bind(this),this.startCamera=this.startCamera.bind(this),this.capturePhoto=this.capturePhoto.bind(this),this.resetCamera=this.resetCamera.bind(this),this.handleGalleryInput=this.handleGalleryInput.bind(this),this.getCurrentLocation=this.getCurrentLocation.bind(this),this.isSubmitting=!1},e=[{key:"render",value:(s=me(ye().mark((function t(){return ye().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section id="content" class="container" tabindex="-1">\n        <h1 class="page-title"><i class="fas fa-plus-circle"></i> Tambah Cerita Baru</h1>\n        \n        <div class="form-container">\n          <div id="add-story-alert" class="alert" style="display: none;"></div>\n          \n          <form id="add-story-form">\n            <div class="form-group">\n              <label for="description" class="form-label"><i class="fas fa-edit"></i> Deskripsi</label>\n              <textarea \n                id="description" \n                class="form-input" \n                placeholder="Ceritakan pengalamanmu..." \n                required\n                rows="4"\n              ></textarea>\n            </div>\n            \n            <div class="form-group">\n              <label class="form-label"><i class="fas fa-camera"></i> Foto</label>\n              \n              <div class="camera-section">\n                <div class="camera-container">\n                  <video id="camera-preview" autoplay playsinline style="display: none;"></video>\n                  <canvas id="camera-canvas" style="display: none;"></canvas>\n                  <img id="photo-preview" class="photo-preview" src="#" alt="Preview" style="display: none;">\n                </div>\n                \n                <div class="camera-buttons">\n                  <button type="button" id="camera-start-button" class="btn btn-primary">\n                    <i class="fas fa-camera"></i> Kamera\n                  </button>\n                  <button type="button" id="gallery-button" class="btn btn-info">\n                    <i class="far fa-images"></i> Galeri\n                  </button>\n                  <button type="button" id="camera-capture-button" class="btn btn-success" style="display: none;">\n                    <i class="fas fa-camera-retro"></i> Ambil Foto\n                  </button>\n                  <button type="button" id="camera-reset-button" class="btn btn-danger" style="display: none;">\n                    <i class="fas fa-trash-alt"></i> Reset\n                  </button>\n                </div>\n                \n                <input type="file" id="gallery-input" accept="image/*" style="display: none;">\n              </div>\n            </div>\n            \n            <div class="form-group">\n              <label class="form-label"><i class="fas fa-map-marker-alt"></i> Lokasi</label>\n              \n              <div id="map-container" class="map-container" style="height: 300px;"></div>\n              \n              <div class="location-info" style="margin-top: 10px;">\n                <p id="location-text">Klik pada peta untuk memilih lokasi, atau gunakan lokasi saat ini.</p>\n                \n                <button type="button" id="current-location-button" class="btn btn-info">\n                  <i class="fas fa-crosshairs"></i> Gunakan Lokasi Saat Ini\n                </button>\n                \n                <div class="coordinates-display" style="margin-top: 10px; display: none;" id="coordinates-display">\n                  <div class="form-row">\n                    <div class="form-group form-group-half">\n                      <label for="lat" class="form-label">Latitude</label>\n                      <input type="text" id="lat" class="form-input" readonly>\n                    </div>\n                    <div class="form-group form-group-half">\n                      <label for="lon" class="form-label">Longitude</label>\n                      <input type="text" id="lon" class="form-input" readonly>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n            \n            <button type="submit" class="btn btn-primary btn-block" id="submit-button">\n              <i class="fas fa-paper-plane"></i> Tambah Cerita\n            </button>\n          </form>\n        </div>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return s.apply(this,arguments)})},{key:"afterRender",value:(u=me(ye().mark((function t(){var e,r,n,o,i,a,u,s,c=this;return ye().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e=document.getElementById("add-story-form"),document.getElementById("submit-button"),r=document.getElementById("camera-start-button"),n=document.getElementById("camera-capture-button"),o=document.getElementById("camera-reset-button"),document.getElementById("camera-preview"),document.getElementById("camera-canvas"),document.getElementById("photo-preview"),i=document.getElementById("gallery-button"),a=document.getElementById("gallery-input"),u=document.getElementById("current-location-button"),t.next=14,this._presenter.initMap();case 14:(s=document.querySelector(".notification-modal"))&&s.remove(),r&&r.addEventListener("click",this.startCamera),n&&n.addEventListener("click",this.capturePhoto),o&&o.addEventListener("click",this.resetCamera),i&&a&&(i.addEventListener("click",(function(){c.resetCamera(),a.click()})),a.addEventListener("change",this.handleGalleryInput)),u&&u.addEventListener("click",this.getCurrentLocation),e&&e.addEventListener("submit",this.handleSubmit),t.next=27;break;case 24:t.prev=24,t.t0=t.catch(0),this.showPageError(t.t0);case 27:case"end":return t.stop()}}),t,this,[[0,24]])}))),function(){return u.apply(this,arguments)})},{key:"startCamera",value:(a=me(ye().mark((function t(e){var r,n,o,i,a,u;return ye().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=document.getElementById("camera-start-button"),n=document.getElementById("camera-preview"),o=document.getElementById("camera-capture-button"),i=document.getElementById("camera-reset-button"),a=document.getElementById("photo-preview"),r.disabled=!0,n.style.display="block",o.style.display="inline-block",i.style.display="inline-block",a.style.display="none",t.next=13,g(n);case 13:this._cameraStream=t.sent,o.disabled=!1,t.next=22;break;case 17:t.prev=17,t.t0=t.catch(0),E("Error",t.t0.message),(u=document.getElementById("camera-start-button"))&&(u.disabled=!1);case 22:case"end":return t.stop()}}),t,this,[[0,17]])}))),function(t){return a.apply(this,arguments)})},{key:"capturePhoto",value:(i=me(ye().mark((function t(e){var r,n,o,i,a;return ye().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=document.getElementById("camera-preview"),n=document.getElementById("camera-canvas"),o=document.getElementById("photo-preview"),i=document.getElementById("camera-capture-button"),t.next=7,w(r,n);case 7:this._imageBlob=t.sent,a=URL.createObjectURL(this._imageBlob),o.src=a,o.style.display="block",r.style.display="none",this._cameraStream&&(b(this._cameraStream),this._cameraStream=null),i.style.display="none",t.next=19;break;case 16:t.prev=16,t.t0=t.catch(0),E("Error",t.t0.message);case 19:case"end":return t.stop()}}),t,this,[[0,16]])}))),function(t){return i.apply(this,arguments)})},{key:"handleGalleryInput",value:(o=me(ye().mark((function t(e){var r,n,o,i,a,u,s;return ye().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r=document.getElementById("photo-preview"),n=document.getElementById("camera-preview"),o=document.getElementById("camera-capture-button"),i=document.getElementById("camera-reset-button"),a=document.getElementById("camera-start-button"),!e.target.files||!e.target.files[0]){t.next=18;break}return u=e.target.files[0],t.next=10,x(u);case 10:this._imageBlob=t.sent,s=URL.createObjectURL(this._imageBlob),r.src=s,r.style.display="block",n.style.display="none",o.style.display="none",i.style.display="inline-block",a.disabled=!0;case 18:t.next=23;break;case 20:t.prev=20,t.t0=t.catch(0),E("Error",t.t0.message);case 23:case"end":return t.stop()}}),t,this,[[0,20]])}))),function(t){return o.apply(this,arguments)})},{key:"handleSubmit",value:(n=me(ye().mark((function t(e){var r,n,o,i,a,u,s,c;return ye().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.preventDefault(),!this.isSubmitting){t.next=3;break}return t.abrupt("return");case 3:return this.isSubmitting=!0,t.prev=4,r=document.getElementById("description").value,n=this._imageBlob,o=document.getElementById("lat").value,i=document.getElementById("lon").value,a=new FormData,r&&a.append("description",r),n&&(u=new File([n],"photo.jpg",{type:"image/jpeg"}),a.append("photo",u)),o&&i&&(a.append("lat",parseFloat(o)),a.append("lon",parseFloat(i))),k("Mengirim data cerita baru:",{description:r,photoSize:n?n.size:0,hasLocation:!(!o||!i)}),t.next=16,this._presenter.addStory(a);case 16:t.sent&&(s=document.getElementById("add-story-form"),c=document.getElementById("photo-preview"),s&&s.reset(),c&&(c.style.display="none"),this._imageBlob=null,this._presenter.resetMapMarker(),setTimeout((function(){window.location.href="#/"}),1500)),t.next=23;break;case 20:t.prev=20,t.t0=t.catch(4),this.showErrorMessage(t.t0.message||"Gagal menambahkan cerita");case 23:return t.prev=23,this.isSubmitting=!1,t.finish(23);case 26:case"end":return t.stop()}}),t,this,[[4,20,23,26]])}))),function(t){return n.apply(this,arguments)})},{key:"resetCamera",value:function(){this._cameraStream&&(b(this._cameraStream),this._cameraStream=null),this._imageBlob=null;var t=document.getElementById("photo-preview"),e=document.getElementById("camera-preview"),r=document.getElementById("camera-capture-button"),n=document.getElementById("camera-reset-button"),o=document.getElementById("camera-start-button");t&&(t.style.display="none"),e&&(e.style.display="none"),r&&(r.style.display="none"),n&&(n.style.display="none"),o&&(o.disabled=!1)}},{key:"initMap",value:(r=me(ye().mark((function t(){var e,r=this;return ye().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,m();case 3:if(e=t.sent,document.getElementById("map-container")){t.next=7;break}throw new Error("Map container not found");case 7:this._map=e.map("map-container").setView([-2.5489,118.0149],5),e.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(this._map),this._map.on("click",(function(t){r._presenter.updateMarker(t.latlng.lat,t.latlng.lng)})),t.next=15;break;case 12:throw t.prev=12,t.t0=t.catch(0),new Error("Gagal memuat peta: ".concat(t.t0.message));case 15:case"end":return t.stop()}}),t,this,[[0,12]])}))),function(){return r.apply(this,arguments)})},{key:"updateMarker",value:function(t,e){try{var r=parseFloat(t).toFixed(6),n=parseFloat(e).toFixed(6);this._location={lat:r,lon:n},document.getElementById("lat").value=r,document.getElementById("lon").value=n,document.getElementById("coordinates-display").style.display="block",document.getElementById("location-text").textContent="Lokasi dipilih: ".concat(r,", ").concat(n),this._currentMarker&&this._map.removeLayer(this._currentMarker);var o=L.icon({iconUrl:"https://cdn-icons-png.flaticon.com/512/684/684908.png",iconSize:[32,32],iconAnchor:[16,32],popupAnchor:[0,-32]});this._currentMarker=L.marker([t,e],{icon:o}).addTo(this._map).bindPopup("Lokasi cerita").openPopup()}catch(t){E("Error","Gagal memperbarui marker: ".concat(t.message))}}},{key:"resetMapMarker",value:function(){try{this._location={lat:null,lon:null},this._currentMarker&&(this._map.removeLayer(this._currentMarker),this._currentMarker=null),document.getElementById("lat").value="",document.getElementById("lon").value="",document.getElementById("coordinates-display").style.display="none",document.getElementById("location-text").textContent="Klik pada peta untuk memilih lokasi, atau gunakan lokasi saat ini."}catch(t){console.error("Error resetting map marker:",t)}}},{key:"getCurrentLocation",value:function(){var t=this;try{if(!navigator.geolocation)throw new Error("Geolocation tidak didukung oleh browser Anda");var e=document.getElementById("current-location-button"),r=e.textContent;e.textContent="Mendapatkan Lokasi...",e.disabled=!0,navigator.geolocation.getCurrentPosition((function(n){var o=n.coords,i=o.latitude,a=o.longitude;t.updateMarker(i,a),t._map.setView([i,a],15),e.textContent=r,e.disabled=!1}),(function(t){var n="Gagal mendapatkan lokasi: ";switch(t.code){case t.PERMISSION_DENIED:n+="Izin lokasi ditolak.";break;case t.POSITION_UNAVAILABLE:n+="Informasi lokasi tidak tersedia.";break;case t.TIMEOUT:n+="Waktu permintaan lokasi habis.";break;default:n+="Kesalahan tidak diketahui."}E("Error",n),e.textContent=r,e.disabled=!1}),{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})}catch(t){E("Error",t.message)}}},{key:"showLoading",value:function(){var t=document.getElementById("submit-button");t._originalText=t.textContent,t.textContent="Mengirim...",t.disabled=!0;var e=document.getElementById("add-story-alert");e&&(e.className="alert alert-info",e.textContent="Sedang mengirim cerita...",e.style.display="block")}},{key:"hideLoading",value:function(){var t=document.getElementById("submit-button");t&&t._originalText&&(t.textContent=t._originalText,t.disabled=!1)}},{key:"showSuccessMessage",value:function(t){var e=document.getElementById("add-story-alert");e&&(e.className="alert alert-success",e.textContent=t,e.style.display="block"),E("Berhasil",t)}},{key:"showErrorMessage",value:function(t){var e=document.getElementById("add-story-alert");e&&(e.className="alert alert-error",e.textContent=t,e.style.display="block"),E("Error",t)}},{key:"showPageError",value:function(t){var e=document.querySelector(".container");e&&(e.innerHTML='\n        <div class="alert alert-error">\n          <p>Terjadi kesalahan saat memuat halaman tambah cerita.</p>\n          <p>'.concat(t.message||"Kesalahan tidak diketahui",'</p>\n          <p><a href="#/">Kembali ke beranda</a></p>\n        </div>\n      '))}},{key:"handleMapError",value:function(t){E("Error","Gagal memuat peta: ".concat(t.message))}},{key:"cleanup",value:function(){try{var t=document.getElementById("add-story-form");t&&t.removeEventListener("submit",this.handleSubmit);var e=document.getElementById("camera-start-button");e&&e.removeEventListener("click",this.startCamera);var r=document.getElementById("camera-capture-button");r&&r.removeEventListener("click",this.capturePhoto);var n=document.getElementById("camera-reset-button");n&&n.removeEventListener("click",this.resetCamera);var o=document.getElementById("gallery-input");o&&o.removeEventListener("change",this.handleGalleryInput);var i=document.getElementById("current-location-button");i&&i.removeEventListener("click",this.getCurrentLocation),this._cameraStream&&(b(this._cameraStream),this._cameraStream=null),this._map&&(this._map.remove(),this._map=null);var a=document.querySelector(".notification-modal");a&&a.remove(),console.log("AddStoryPage resources cleaned up")}catch(t){console.error("Error during cleanup:",t)}}}],e&&ge(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i,a,u,s}();function ke(t){return ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ke(t)}function Ee(){Ee=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return s(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=k(u,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function p(){}function d(){}var y={};s(y,i,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(S([])));m&&m!==r&&n.call(m,i)&&(y=m);var g=d.prototype=f.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,h=c.value;return h&&"object"==ke(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var o;s(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(ke(e)+" is not iterable")}return p.prototype=d,s(g,"constructor",d),s(d,"constructor",p),p.displayName=s(d,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),s(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),s(g,u,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=t,n(s),!0;if(u<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function xe(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function _e(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){xe(i,n,o,a,u,"next",t)}function u(t){xe(i,n,o,a,u,"throw",t)}a(void 0)}))}}function Se(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,je(n.key),n)}}function je(t){var e=function(t){if("object"!=ke(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ke(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ke(e)?e:e+""}const Ae=function(){return t=function t(e){var r=e.view,n=e.model,o=e.storyId;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._view=r,this._model=n,this._storyId=o,this._story=null},e=[{key:"loadStoryDetail",value:(n=_e(Ee().mark((function t(){var e;return Ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this._view.showLoading(),t.next=4,this._model.getStoryDetail(this._storyId);case 4:if(e=t.sent,this._story=e.story,this._story){t.next=8;break}throw new Error("Cerita tidak ditemukan");case 8:this._view.renderStoryDetail(this._story),this._story.lat&&this._story.lon&&this.initMap(),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(0),console.error("Error loading story detail:",t.t0),this._view.showErrorMessage(t.t0.message);case 16:return t.prev=16,this._view.hideLoading(),t.finish(16);case 19:case"end":return t.stop()}}),t,this,[[0,12,16,19]])}))),function(){return n.apply(this,arguments)})},{key:"initMap",value:(r=_e(Ee().mark((function t(){return Ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._story.lat&&this._story.lon){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,this._view.initMap(this._story.lat,this._story.lon,this._story);case 5:t.next=11;break;case 7:t.prev=7,t.t0=t.catch(2),console.error("Map initialization error:",t.t0),this._view.handleMapError(t.t0);case 11:case"end":return t.stop()}}),t,this,[[2,7]])}))),function(){return r.apply(this,arguments)})}],e&&Se(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function Oe(t){var e=t.split("/");return{resource:e[1]||null,id:e[2]||null}}function Pe(){return location.hash.replace("#","")||"/"}function Te(t){return Te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Te(t)}function Ie(){Ie=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return s(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=k(u,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function p(){}function d(){}var y={};s(y,i,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(S([])));m&&m!==r&&n.call(m,i)&&(y=m);var g=d.prototype=f.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,h=c.value;return h&&"object"==Te(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var o;s(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Te(e)+" is not iterable")}return p.prototype=d,s(g,"constructor",d),s(d,"constructor",p),p.displayName=s(d,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),s(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),s(g,u,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=t,n(s),!0;if(u<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function Le(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function Be(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Le(i,n,o,a,u,"next",t)}function u(t){Le(i,n,o,a,u,"throw",t)}a(void 0)}))}}function Me(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ge(n.key),n)}}function Ge(t){var e=function(t){if("object"!=Te(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Te(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Te(e)?e:e+""}const Fe={"/":dt,"/about":jt,"/login":Ut,"/register":ae,"/add":be,"/story/:id":function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._storyModel=new J;var e=Oe(Pe()).id;this._presenter=new Ae({view:this,model:this._storyModel,storyId:e}),this._map=null,this._mapError=!1,this._story=null},e=[{key:"render",value:(o=Be(Ie().mark((function t(){return Ie().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section id="content" class="container" tabindex="-1">\n        <div id="story-detail-container">\n          <div class="loading">\n            <div class="loading-spinner"></div>\n          </div>\n        </div>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return o.apply(this,arguments)})},{key:"afterRender",value:(n=Be(Ie().mark((function t(){return Ie().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(d()){t.next=3;break}return window.location.hash="#/login",t.abrupt("return");case 3:return t.next=5,this._presenter.loadStoryDetail();case 5:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"showLoading",value:function(){var t=document.getElementById("story-detail-container");t&&(t.innerHTML='\n        <div class="loading">\n          <div class="loading-spinner"></div>\n        </div>\n      ')}},{key:"hideLoading",value:function(){k("Loading hidden")}},{key:"renderStoryDetail",value:function(t){this._story=t;var e=document.getElementById("story-detail-container");if(e)try{e.innerHTML='\n        <div class="story-detail">\n          <img \n            src="'.concat(t.photoUrl,'" \n            alt="Cerita dari ').concat(t.name,'" \n            class="story-detail-image"\n            onerror="this.onerror=null; this.src=\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNk+A8AAQUBAScY42YAAAAASUVORK5CYII=\';"\n          >\n          <div class="story-detail-content">\n            <h1 class="story-detail-title">Cerita dari ').concat(t.name,'</h1>\n            \n            <div class="story-detail-meta">\n              <span class="story-date">\n                <i class="far fa-calendar-alt"></i>\n                ').concat(f(t.createdAt),"\n              </span>\n              \n              ").concat(t.lat&&t.lon?'\n                <span class="story-location">\n                  <i class="fas fa-map-marker-alt"></i>\n                  '.concat(this._mapError?"Lokasi: ".concat(t.lat.toFixed(6),", ").concat(t.lon.toFixed(6)):"Lokasi tersedia","\n                </span>\n              "):"",'\n            </div>\n            \n            <p class="story-detail-description">').concat(t.description||"Tidak ada deskripsi","</p>\n            \n            ").concat(t.lat&&t.lon?'\n              <div id="story-detail-map" class="story-detail-map"></div>\n            ':"",'\n            \n            <div style="margin-top: 20px;">\n              <a href="#/" class="btn btn-primary">\n                <i class="fas fa-arrow-left"></i> Kembali ke Beranda\n              </a>\n            </div>\n          </div>\n        </div>\n      ')}catch(t){k("Error rendering story detail:",t),this.showErrorMessage(t.message)}}},{key:"showErrorMessage",value:function(t){var e=document.getElementById("story-detail-container");e&&(e.innerHTML='\n        <div class="alert alert-error">\n          <p><i class="fas fa-exclamation-triangle"></i> Terjadi kesalahan saat memuat detail cerita.</p>\n          <p>'.concat(t||"Kesalahan tidak diketahui",'</p>\n          <p><a href="#/" class="btn btn-primary"><i class="fas fa-home"></i> Kembali ke beranda</a></p>\n        </div>\n      '))}},{key:"initMap",value:(r=Be(Ie().mark((function t(e,r,n){var o,i,a;return Ie().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,m();case 3:if(a=t.sent,document.getElementById("story-detail-map")){t.next=7;break}throw new Error("Map container not found");case 7:this._map=a.map("story-detail-map").setView([e,r],13),a.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(this._map),a.marker([e,r]).addTo(this._map).bindPopup("\n        <div>\n          <h3>".concat(n.name,"</h3>\n          <p>").concat(null===(o=n.description)||void 0===o?void 0:o.substring(0,50)).concat((null===(i=n.description)||void 0===i?void 0:i.length)>50?"...":"","</p>\n        </div>\n      ")).openPopup(),t.next=17;break;case 13:throw t.prev=13,t.t0=t.catch(0),this.handleMapError(t.t0),t.t0;case 17:case"end":return t.stop()}}),t,this,[[0,13]])}))),function(t,e,n){return r.apply(this,arguments)})},{key:"handleMapError",value:function(t){k("Error initializing map:",t),this._mapError=!0;var e,r,n=document.getElementById("story-detail-map");n&&this._story&&(n.innerHTML='\n        <div class="alert alert-error">\n          <p>Gagal memuat peta. Koordinat lokasi: '.concat(null===(e=this._story.lat)||void 0===e?void 0:e.toFixed(6),", ").concat(null===(r=this._story.lon)||void 0===r?void 0:r.toFixed(6),"</p>\n          <p>Error: ").concat(t.message||"Kesalahan tidak diketahui","</p>\n        </div>\n      "))}}],e&&Me(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o}()};function Ce(t){return Ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ce(t)}function Ne(){Ne=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return s(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=k(u,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function p(){}function d(){}var y={};s(y,i,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(S([])));m&&m!==r&&n.call(m,i)&&(y=m);var g=d.prototype=f.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,h=c.value;return h&&"object"==Ce(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var o;s(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Ce(e)+" is not iterable")}return p.prototype=d,s(g,"constructor",d),s(d,"constructor",p),p.displayName=s(d,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),s(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),s(g,u,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=t,n(s),!0;if(u<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function De(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function Ye(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){De(i,n,o,a,u,"next",t)}function u(t){De(i,n,o,a,u,"throw",t)}a(void 0)}))}}function Ve(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,We(n.key),n)}}function We(t){var e=function(t){if("object"!=Ce(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Ce(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ce(e)?e:e+""}function He(t,e,r){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,r)}function Re(t,e){return t.get(ze(t,e))}function Qe(t,e,r){return t.set(ze(t,e),r),r}function ze(t,e,r){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ue=new WeakMap,Ke=new WeakMap,Xe=new WeakMap,Je=new WeakMap;const qe=function(){return t=function t(e){var r,n,o=e.navigationDrawer,i=e.drawerButton,a=e.content,u=e.authMenu;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),He(this,Ue,null),He(this,Ke,null),He(this,Xe,null),He(this,Je,null),r=this,(n=We(n="currentPage"))in r?Object.defineProperty(r,n,{value:null,enumerable:!0,configurable:!0,writable:!0}):r[n]=null,Qe(Ue,this,a),Qe(Ke,this,i),Qe(Xe,this,o),Qe(Je,this,u),this._checkBrowserCompatibility(),this._setupDrawer(),this._updateAuthMenu(),this._registerServiceWorker(),this._initSkipToContent()},e=[{key:"_checkBrowserCompatibility",value:function(){var t,e,r=(t={camera:!(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia),geolocation:!!navigator.geolocation,localStorage:!!window.localStorage,viewTransition:!!document.startViewTransition},{fullSupport:0===(e=Object.entries(t).filter((function(t){var e=u(t,2);return e[0],!e[1]})).map((function(t){return u(t,1)[0]}))).length,support:t,unsupported:e});if(k("Browser support check:",r),!r.fullSupport&&(console.warn("Browser tidak mendukung fitur:",r.unsupported),r.unsupported.includes("camera")||r.unsupported.includes("localStorage"))){var n,o='\n          <div class="alert alert-warning" style="position: fixed; top: 0; left: 0; right: 0; z-index: 10000; text-align: center; padding: 10px;">\n            Browser Anda tidak mendukung fitur: '.concat(r.unsupported.join(", "),'.\n            Beberapa fitur aplikasi mungkin tidak berfungsi dengan baik.\n            <button id="dismiss-warning" style="margin-left: 10px; padding: 2px 8px;">Tutup</button>\n          </div>\n        '),i=document.createElement("div");i.innerHTML=o,document.body.insertBefore(i,document.body.firstChild),null===(n=document.getElementById("dismiss-warning"))||void 0===n||n.addEventListener("click",(function(){i.remove()}))}}},{key:"_setupDrawer",value:function(){var t=this;try{Re(Ke,this).addEventListener("click",(function(){Re(Xe,t).classList.toggle("open")})),document.body.addEventListener("click",(function(e){Re(Xe,t).contains(e.target)||Re(Ke,t).contains(e.target)||Re(Xe,t).classList.remove("open"),Re(Xe,t).querySelectorAll("a").forEach((function(r){r.contains(e.target)&&Re(Xe,t).classList.remove("open")}))}))}catch(t){k("Error setting up drawer:",t)}}},{key:"_updateAuthMenu",value:function(){try{if(d()){Re(Je,this).innerHTML='\n          <a href="#" id="logout-button">Logout</a>\n        ';var t=document.getElementById("logout-button");t&&t.addEventListener("click",(function(t){t.preventDefault(),alert("Anda berhasil logout"),v(),window.location="#/login",setTimeout((function(){window.location.reload(!0)}),100)}))}else{Re(Je,this).innerHTML='<a href="#/login">Login</a>';var e=window.location.hash.replace("#","");["/","/add","/story"].some((function(t){return e===t||e.startsWith(t+"/")}))&&(window.location="#/login")}}catch(t){console.error("Error updating auth menu:",t),Re(Je,this).innerHTML='<a href="#/login">Login</a>'}}},{key:"_initSkipToContent",value:function(){try{var t=document.querySelector(".skip-link");t&&t.addEventListener("click",(function(t){t.preventDefault();var e=document.querySelector("#content");e&&(e.setAttribute("tabindex","-1"),e.focus(),e.scrollIntoView())}))}catch(t){console.error("Error initializing skip to content:",t)}}},{key:"renderPage",value:(n=Ye(Ne().mark((function t(){var e=this;return Ne().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!document.startViewTransition){t.next=6;break}return t.next=4,document.startViewTransition(Ye(Ne().mark((function t(){return Ne().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._renderContent();case 2:case"end":return t.stop()}}),t)})))).finished;case 4:t.next=8;break;case 6:return t.next=8,this._renderContent();case 8:this._updateAuthMenu(),this._initSkipToContent(),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(0),k("Error during page rendering:",t.t0),Re(Ue,this).innerHTML='\n        <div class="container">\n          <h2 class="page-title">Terjadi Kesalahan</h2>\n          <p>Maaf, terjadi kesalahan saat memuat halaman.</p>\n          <p>'.concat(t.t0.message||"Kesalahan tidak diketahui",'</p>\n          <p><a href="#/">Kembali ke beranda</a></p>\n        </div>\n      ');case 16:case"end":return t.stop()}}),t,this,[[0,12]])}))),function(){return n.apply(this,arguments)})},{key:"_renderContent",value:(r=Ye(Ne().mark((function t(){var e,r;return Ne().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n=Oe(Pe()),o=void 0,o="",n.resource&&(o=o.concat("/".concat(n.resource))),n.id&&(o=o.concat("/:id")),e=Fe[o||"/"]){t.next=6;break}return Re(Ue,this).innerHTML='\n          <div id="content" class="container" tabindex="-1">\n            <h2 class="page-title">Halaman Tidak Ditemukan</h2>\n            <p>Halaman yang Anda cari tidak tersedia.</p>\n            <p><a href="#/">Kembali ke beranda</a></p>\n          </div>\n        ',t.abrupt("return");case 6:if(Re(Ue,this).innerHTML='\n        <div class="container">\n          <div class="loading">\n            <div class="loading-spinner"></div>\n          </div>\n        </div>\n      ',this.currentPage&&"function"==typeof this.currentPage.cleanup)try{this.currentPage.cleanup()}catch(t){console.error("Error cleaning up previous page:",t)}return this.currentPage=new e,t.next=11,this.currentPage.render();case 11:return(r=t.sent).includes('id="content"')?Re(Ue,this).innerHTML=r:Re(Ue,this).innerHTML=r.replace('<section class="container"','<section id="content" class="container" tabindex="-1"'),t.next=15,this.currentPage.afterRender();case 15:t.next=21;break;case 17:throw t.prev=17,t.t0=t.catch(0),k("Error in _renderContent:",t.t0),t.t0;case 21:case"end":return t.stop()}var n,o}),t,this,[[0,17]])}))),function(){return r.apply(this,arguments)})},{key:"_registerServiceWorker",value:function(){"serviceWorker"in navigator?window.addEventListener("load",(function(){navigator.serviceWorker.register("/service-worker.js").then((function(t){console.log("Service Worker berhasil didaftarkan:",t.scope)})).catch((function(t){console.error("Pendaftaran Service Worker gagal:",t)}))})):console.log("Browser tidak mendukung Service Worker")}},{key:"cleanup",value:function(){if(this.currentPage&&"function"==typeof this.currentPage.cleanup)try{this.currentPage.cleanup(),this.currentPage=null}catch(t){console.error("Error during app cleanup:",t)}console.log("App resources cleaned up")}}],e&&Ve(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function Ze(t){return Ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ze(t)}function $e(){$e=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return s(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=k(u,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new _(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function p(){}function d(){}var y={};s(y,i,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(S([])));m&&m!==r&&n.call(m,i)&&(y=m);var g=d.prototype=f.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,h=c.value;return h&&"object"==Ze(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var o;s(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function k(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function E(t){this.tryEntries.push(t)}function x(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Ze(e)+" is not iterable")}return p.prototype=d,s(g,"constructor",d),s(d,"constructor",p),p.displayName=s(d,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),s(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),s(g,u,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=t,n(s),!0;if(u<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),x(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:S(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function tr(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function er(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){tr(i,n,o,a,u,"next",t)}function u(t){tr(i,n,o,a,u,"throw",t)}a(void 0)}))}}var rr=null;function nr(){return or.apply(this,arguments)}function or(){return(or=er($e().mark((function t(){var e,r;return $e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,j();case 3:if(t.sent){t.next=7;break}return console.log("Izin notifikasi ditolak"),t.abrupt("return");case 7:return t.next=9,navigator.serviceWorker.ready;case 9:return e=t.sent,t.next=12,e.pushManager.getSubscription();case 12:if(t.sent){t.next=18;break}if(!(r=p())||!r.token){t.next=18;break}return t.next=18,ir(e);case 18:t.next=23;break;case 20:t.prev=20,t.t0=t.catch(0),console.error("Gagal menginisialisasi push notification:",t.t0);case 23:case"end":return t.stop()}}),t,null,[[0,20]])})))).apply(this,arguments)}function ir(t){return ar.apply(this,arguments)}function ar(){return(ar=er($e().mark((function t(e){var r,n;return $e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,O(e);case 3:return r=t.sent,n={endpoint:r.endpoint,keys:{p256dh:btoa(String.fromCharCode.apply(null,new Uint8Array(r.getKey("p256dh")))),auth:btoa(String.fromCharCode.apply(null,new Uint8Array(r.getKey("auth"))))}},t.next=7,Y(n);case 7:t.sent.error||console.log("Berhasil berlangganan push notification"),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),console.error("Gagal berlangganan push notification:",t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})))).apply(this,arguments)}document.addEventListener("DOMContentLoaded",er($e().mark((function t(){var e;return $e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return document.startViewTransition||console.warn("Browser Anda tidak mendukung View Transitions API. Transisi halaman mungkin kurang smooth."),rr&&(rr.cleanup(),rr=null),(rr=new qe({content:document.querySelector("#main-content"),drawerButton:document.querySelector("#drawer-button"),navigationDrawer:document.querySelector("#navigation-drawer"),authMenu:document.querySelector("#auth-menu")})).cleanup||(rr.cleanup=function(){this.currentPage&&"function"==typeof this.currentPage.cleanup&&this.currentPage.cleanup(),console.log("App instance cleaned up")}),t.next=6,rr.renderPage();case 6:if(window._hashChangeHandler&&window.removeEventListener("hashchange",window._hashChangeHandler),window._hashChangeHandler=er($e().mark((function t(){return $e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!rr._isRendering){t.next=3;break}return console.log("Render sedang berjalan, abaikan hashchange event"),t.abrupt("return");case 3:return rr._isRendering=!0,t.prev=4,t.next=7,rr.renderPage();case 7:t.next=12;break;case 9:t.prev=9,t.t0=t.catch(4),console.error("Error rendering page:",t.t0);case 12:return t.prev=12,rr._isRendering=!1,t.finish(12);case 15:case"end":return t.stop()}}),t,null,[[4,9,12,15]])}))),window.addEventListener("hashchange",window._hashChangeHandler),!("serviceWorker"in navigator)){t.next=24;break}return t.prev=10,t.next=13,navigator.serviceWorker.register("/service-worker.js",{scope:"/",updateViaCache:"none"});case 13:return e=t.sent,console.log("Service worker registered successfully with scope:",e.scope),e.update(),setInterval((function(){e.update(),console.log("Checking for service worker updates...")}),36e5),t.next=19,nr();case 19:t.next=24;break;case 21:t.prev=21,t.t0=t.catch(10),console.error("Service worker registration failed:",t.t0);case 24:window.addEventListener("beforeunload",(function(){rr&&rr.cleanup()}));case 25:case"end":return t.stop()}}),t,null,[[10,21]])}))))})();