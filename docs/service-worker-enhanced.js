importScripts("https://storage.googleapis.com/workbox-cdn/releases/6.6.1/workbox-sw.js"),workbox?(console.log("✅ Workbox loaded successfully"),workbox.core.skipWaiting(),workbox.core.clientsClaim(),workbox.precaching.precacheAndRoute([{url:"/",revision:"1"},{url:"/index.html",revision:"1"},{url:"/app.bundle.js",revision:"1"},{url:"/app.css",revision:"1"},{url:"/manifest.json",revision:"1"},{url:"/favicon.png",revision:"1"},{url:"/favicon-192.png",revision:"1"},{url:"/favicon-512.png",revision:"1"}]),workbox.routing.registerRoute((({url:e})=>"https://story-api.dicoding.dev"===e.origin),new workbox.strategies.NetworkFirst({cacheName:"api-cache",networkTimeoutSeconds:3,plugins:[{cacheKeyWillBeUsed:async({request:e})=>e.url,handlerDidError:async({request:e})=>{const o=new URL(e.url);return o.pathname.match(/\/stories\/[^\/]+$/)?new Response(JSON.stringify({error:!1,message:"success",story:{id:"offline-1",name:"Story Offline",description:"Story ini tersedia saat offline",photoUrl:"/favicon-192.png",createdAt:(new Date).toISOString(),lat:-6.2088,lon:106.8456}}),{status:200,headers:{"Content-Type":"application/json"}}):o.pathname.includes("/stories")?new Response(JSON.stringify({error:!1,message:"success",listStory:[{id:"offline-1",name:"Story Offline",description:"Story offline tersedia",photoUrl:"/favicon-192.png",createdAt:(new Date).toISOString(),lat:-6.2088,lon:106.8456}]}),{status:200,headers:{"Content-Type":"application/json"}}):new Response(JSON.stringify({error:!1,message:"Offline response",offline:!0}),{status:200,headers:{"Content-Type":"application/json"}})}}]})),workbox.routing.registerRoute(/\.(?:png|jpg|jpeg|svg|gif|webp)$/,new workbox.strategies.CacheFirst({cacheName:"images-cache",plugins:[new workbox.expiration.ExpirationPlugin({maxEntries:100,maxAgeSeconds:2592e3})]})),workbox.routing.registerRoute((({request:e})=>"navigate"===e.mode),new workbox.strategies.NetworkFirst({cacheName:"pages-cache",plugins:[{cacheKeyWillBeUsed:async()=>"/index.html",handlerDidError:async()=>caches.match("/index.html")}]})),console.log("✅ Workbox routing configured")):console.error("❌ Workbox failed to load"),self.addEventListener("message",(e=>{if(e.data&&"SHOW_NOTIFICATION"===e.data.type){const{title:o,options:t}=e.data.payload;e.waitUntil(self.registration.showNotification(o,t))}})),self.addEventListener("push",(e=>{const o=e.data?e.data.json():{},t=o.title||"Story berhasil dibuat",i={body:o.options?.body||"Anda telah membuat story baru",icon:"/favicon.png",badge:"/favicon.png",tag:"story-notification",renotify:!0,requireInteraction:!0,data:{url:o.url||"/"}};e.waitUntil(self.registration.showNotification(t,i))})),self.addEventListener("notificationclick",(e=>{e.notification.close();const o=e.notification.data?.url||"/";e.waitUntil(clients.matchAll({type:"window",includeUncontrolled:!0}).then((e=>{for(let t=0;t<e.length;t++){const i=e[t];if(i.url===o&&"focus"in i)return i.focus()}if(clients.openWindow)return clients.openWindow(o)})))}));